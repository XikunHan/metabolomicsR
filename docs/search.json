[{"path":"https://XikunHan.github.io/metabolomicsR/NEWs.html","id":null,"dir":"","previous_headings":"","what":"ggstatsplot 0.0.1","title":"ggstatsplot 0.0.1","text":"First release metabolomicsR package.","code":""},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"data-structure","dir":"Articles","previous_headings":"","what":"Data structure","title":"An introduction to the metabolomicsR","text":"first designed “Metabolite” class based object-oriented programming system S4 R. particular “Metabolite” data, include “assayData” (eg. peak area data batch-normalized data, samples rows metabolites columns), “featureData” (metabolite annotation), “sampleData” (sample annotation), “featureID”, “sampleID”, “logs” (log information data analysis process), “miscData” (ancillary data).","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"import-data","dir":"Articles","previous_headings":"","what":"Import data","title":"An introduction to the metabolomicsR","text":"demonstrate package, obtained data Qatar Metabolomics Study Diabetes, similar data format non-targeted mass spectrometry Metabolon. dataset also available via figshare. “assayData”, first column sample IDs match “sampleData”, columns metabolite IDs match “featureData”.","code":"library(metabolomicsR) library(data.table) library(ggplot2) library(cowplot) library(plotROC)  # Load the dataset  file_path <- system.file(\"extdata\", \"QMDiab_metabolomics_OrigScale.xlsx\", package = \"metabolomicsR\", mustWork = TRUE)  df_plasma <- load_excel(path = file_path,                         data_sheet = 1,                         feature_sheet = 4,                         sample_sheet = 8,                         sampleID = \"QMDiab-ID\",                         featureID = \"BIOCHEMICAL\"                         ) df_plasma ## An object of  Metabolite  ##  ## ***  @assayData (first and last 10 columns [ 356  *  759 ])  *** ##       sampleID 1,11-Undecanedicarboxylic acid 1,2-dipalmitoylglycerol ##   1: QMDiab222                           8578                      NA ##   2: QMDiab113                          15145                      NA ##   3:  QMDiab29                             NA                   96455 ##   4: QMDiab243                          19692                   69444 ##   5: QMDiab270                             NA                      NA ##  ---                                                                  ## 352: QMDiab352                           6689                  116932 ## 353: QMDiab135                           7556                  248824 ## 354: QMDiab229                          20252                   80804 ## 355: QMDiab202                           7378                  108152 ## 356: QMDiab103                           6667                   57851 ##      1,2-propanediol 1,3,7-trimethylurate 1,3-dihydroxyacetone ##   1:          103724                22259               104059 ##   2:              NA                39841                   NA ##   3:          159945                10605               165416 ##   4:          108965                38562               139866 ##   5:          157617                 4490                   NA ##  ---                                                           ## 352:          115737                34791               152711 ## 353:          481008                 4766               164853 ## 354:          138253                13949                85019 ## 355:          112229                21748               175918 ## 356:          146948                 8458                82064 ##      1,3-dipalmitoylglycerol 1,5-anhydroglucitol (1,5-AG) 1,7-dimethylurate ##   1:                    7067                       357499             19986 ##   2:                   36542                       440058             16620 ##   3:                   54209                       355790             12220 ##   4:                   22412                       185273             29537 ##   5:                   21958                       692753             10256 ##  ---                                                                        ## 352:                   59120                       178759             25326 ## 353:                  126065                       103647             12253 ## 354:                   43072                       330579             15124 ## 355:                   78154                       106745             21434 ## 356:                   34234                       534697             12979 ##      1-arachidonoylglycerophosphocholine* X - 19183 X - 19299 X - 19302 ##   1:                              2173598        NA        NA        NA ##   2:                              2464846        NA      9033        NA ##   3:                              2613798        NA     10231        NA ##   4:                              2543266        NA        NA     12291 ##   5:                              2138029        NA      6775        NA ##  ---                                                                    ## 352:                               864647        NA        NA        NA ## 353:                              3018611      4769        NA        NA ## 354:                              1398965        NA        NA        NA ## 355:                              2104899        NA        NA        NA ## 356:                               992388        NA        NA        NA ##      X - 19380 X - 19411 X - 19434 X - 19436 X - 19437 X - 19438 X - 19451 ##   1:    158054     88569      7539        NA     64644     18055        NA ##   2:    125669     87268     12681        NA     52074     12805      2994 ##   3:    194732    106360      7787        NA     31782     18467        NA ##   4:    152853    119643        NA        NA     67713     12356        NA ##   5:    204978    149644        NA        NA    108660     12479        NA ##  ---                                                                       ## 352:    195331    134564        NA        NA     22141     17205        NA ## 353:    136120     75431     10876        NA     61867     28223        NA ## 354:    216380    128925        NA        NA     84299     14936        NA ## 355:    162256    112923        NA        NA     42586     51588        NA ## 356:    137705    112636        NA        NA     89283     23515     10619 ##      X - 19574 ##   1:        NA ##   2:        NA ##   3:        NA ##   4:        NA ##   5:        NA ##  ---           ## 352:        NA ## 353:     16573 ## 354:        NA ## 355:        NA ## 356:        NA ##  ## ***  @featureData (ID:  featureID ) *** ##      PATHWAY_SORTORDER                    BIOCHEMICAL SUPER_PATHWAY ##   1:             800.1 1,11-Undecanedicarboxylic acid         Lipid ##   2:              1070        1,2-dipalmitoylglycerol         Lipid ##   3:               986                1,2-propanediol         Lipid ##   4:              1805           1,3,7-trimethylurate   Xenobiotics ##   5:               600           1,3-dihydroxyacetone  Carbohydrate ##  ---                                                                ## 754:              <NA>                      X - 19436          <NA> ## 755:              <NA>                      X - 19437          <NA> ## 756:              <NA>                      X - 19438          <NA> ## 757:              <NA>                      X - 19451          <NA> ## 758:              <NA>                      X - 19574          <NA> ##                                           SUB_PATHWAY COMP_ID  PLATFORM ##   1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg ##   2:                                   Diacylglycerol   11953     GC/MS ##   3:                                    Ketone bodies   38002     GC/MS ##   4:                              Xanthine metabolism   34404 LC/MS Neg ##   5: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS ##  ---                                                                    ## 754:                                             <NA>   42912 LC/MS Neg ## 755:                                             <NA>   42913 LC/MS Neg ## 756:                                             <NA>   42914 LC/MS Neg ## 757:                                             <NA>   42927 LC/MS Neg ## 758:                                             <NA>   43130 LC/MS Neg ##                      RI               MASS PUBCHEM                 CAS   KEGG ##   1:               3578              243.2   10458           505-52-2;   <NA> ##   2:               2600                145   99931         40290-32-2;   <NA> ##   3:               1041                117    <NA>            57-55-6; C00583 ##   4:               1988              209.1   79437          5415-44-1; C16361 ##   5:               1263                103     670 96-26-4;62147-49-3; C00184 ##  ---                                                                          ## 754:               4747              467.4    <NA>                <NA>   <NA> ## 755: 1150.0999999999999              397.1    <NA>                <NA>   <NA> ## 756:             1222.3              217.1    <NA>                <NA>   <NA> ## 757:             3728.5              239.1    <NA>                <NA>   <NA> ## 758:             4045.7 307.10000000000002    <NA>                <NA>   <NA> ##        HMDb_ID COMP_IDstr                      featureID ##   1: HMDB02327     M43027 1,11-Undecanedicarboxylic acid ##   2: HMDB07098     M11953        1,2-dipalmitoylglycerol ##   3: HMDB01881     M38002                1,2-propanediol ##   4: HMDB02123     M34404           1,3,7-trimethylurate ##   5: HMDB01882     M35963           1,3-dihydroxyacetone ##  ---                                                     ## 754:      <NA>     M42912                      X - 19436 ## 755:      <NA>     M42913                      X - 19437 ## 756:      <NA>     M42914                      X - 19438 ## 757:      <NA>     M42927                      X - 19451 ## 758:      <NA>     M43130                      X - 19574 ##  ## ***  @sampleData (ID:  sampleID ) *** ##       sampleID      AGE GENDER      BMI ETHNICITY T2D ##   1: QMDiab222 34.50513      0 25.01021         2   0 ##   2: QMDiab113 47.06639      1 28.36776         3   0 ##   3:  QMDiab29 55.49076      1 29.70564         1   0 ##   4: QMDiab243 56.33402      1 23.14050         2   0 ##   5: QMDiab270 35.63039      1 30.06229         1   0 ##  ---                                                  ## 352: QMDiab352 41.55510      1 31.22690         3   1 ## 353: QMDiab135 52.55305      0 29.07577         2   1 ## 354: QMDiab229 30.31348      0 22.22656         2   0 ## 355: QMDiab202 49.40999      1 33.72008         1   1 ## 356: QMDiab103 23.85489      0 35.96389         1   0 ##  ## ***  @miscData  *** ## integer(0) ##  ## ***  @logs  *** ## 09/03/22 21:46:20: Import data from: /private/var/folders/mj/lsf2tqcx13d5tgl627mm9fxm0000gn/T/RtmphZ45UH/temp_libpathc1cb175427a5/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . ## 09/03/22 21:46:20: Initiate data: 356 samples and 758 features. # change the feature ID to the column `COMP_IDstr` df_plasma <- update_Metabolite(df_plasma, dataset = \"COMP_IDstr\", action = \"change_featureID\") df_plasma ## An object of  Metabolite  ##  ## ***  @assayData (first and last 10 columns [ 356  *  759 ])  *** ##       sampleID M43027 M11953 M38002 M34404 M35963 M35728 M20675 M34400  M33228 ##   1: QMDiab222   8578     NA 103724  22259 104059   7067 357499  19986 2173598 ##   2: QMDiab113  15145     NA     NA  39841     NA  36542 440058  16620 2464846 ##   3:  QMDiab29     NA  96455 159945  10605 165416  54209 355790  12220 2613798 ##   4: QMDiab243  19692  69444 108965  38562 139866  22412 185273  29537 2543266 ##   5: QMDiab270     NA     NA 157617   4490     NA  21958 692753  10256 2138029 ##  ---                                                                           ## 352: QMDiab352   6689 116932 115737  34791 152711  59120 178759  25326  864647 ## 353: QMDiab135   7556 248824 481008   4766 164853 126065 103647  12253 3018611 ## 354: QMDiab229  20252  80804 138253  13949  85019  43072 330579  15124 1398965 ## 355: QMDiab202   7378 108152 112229  21748 175918  78154 106745  21434 2104899 ## 356: QMDiab103   6667  57851 146948   8458  82064  34234 534697  12979  992388 ##      M42659 M42775 M42778 M42856 M42887 M42910 M42912 M42913 M42914 M42927 ##   1:     NA     NA     NA 158054  88569   7539     NA  64644  18055     NA ##   2:     NA   9033     NA 125669  87268  12681     NA  52074  12805   2994 ##   3:     NA  10231     NA 194732 106360   7787     NA  31782  18467     NA ##   4:     NA     NA  12291 152853 119643     NA     NA  67713  12356     NA ##   5:     NA   6775     NA 204978 149644     NA     NA 108660  12479     NA ##  ---                                                                       ## 352:     NA     NA     NA 195331 134564     NA     NA  22141  17205     NA ## 353:   4769     NA     NA 136120  75431  10876     NA  61867  28223     NA ## 354:     NA     NA     NA 216380 128925     NA     NA  84299  14936     NA ## 355:     NA     NA     NA 162256 112923     NA     NA  42586  51588     NA ## 356:     NA     NA     NA 137705 112636     NA     NA  89283  23515  10619 ##      M43130 ##   1:     NA ##   2:     NA ##   3:     NA ##   4:     NA ##   5:     NA ##  ---        ## 352:     NA ## 353:  16573 ## 354:     NA ## 355:     NA ## 356:     NA ##  ## ***  @featureData (ID:  featureID ) *** ##      PATHWAY_SORTORDER                    BIOCHEMICAL SUPER_PATHWAY ##   1:             800.1 1,11-Undecanedicarboxylic acid         Lipid ##   2:              1070        1,2-dipalmitoylglycerol         Lipid ##   3:               986                1,2-propanediol         Lipid ##   4:              1805           1,3,7-trimethylurate   Xenobiotics ##   5:               600           1,3-dihydroxyacetone  Carbohydrate ##  ---                                                                ## 754:              <NA>                      X - 19436          <NA> ## 755:              <NA>                      X - 19437          <NA> ## 756:              <NA>                      X - 19438          <NA> ## 757:              <NA>                      X - 19451          <NA> ## 758:              <NA>                      X - 19574          <NA> ##                                           SUB_PATHWAY COMP_ID  PLATFORM ##   1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg ##   2:                                   Diacylglycerol   11953     GC/MS ##   3:                                    Ketone bodies   38002     GC/MS ##   4:                              Xanthine metabolism   34404 LC/MS Neg ##   5: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS ##  ---                                                                    ## 754:                                             <NA>   42912 LC/MS Neg ## 755:                                             <NA>   42913 LC/MS Neg ## 756:                                             <NA>   42914 LC/MS Neg ## 757:                                             <NA>   42927 LC/MS Neg ## 758:                                             <NA>   43130 LC/MS Neg ##                      RI               MASS PUBCHEM                 CAS   KEGG ##   1:               3578              243.2   10458           505-52-2;   <NA> ##   2:               2600                145   99931         40290-32-2;   <NA> ##   3:               1041                117    <NA>            57-55-6; C00583 ##   4:               1988              209.1   79437          5415-44-1; C16361 ##   5:               1263                103     670 96-26-4;62147-49-3; C00184 ##  ---                                                                          ## 754:               4747              467.4    <NA>                <NA>   <NA> ## 755: 1150.0999999999999              397.1    <NA>                <NA>   <NA> ## 756:             1222.3              217.1    <NA>                <NA>   <NA> ## 757:             3728.5              239.1    <NA>                <NA>   <NA> ## 758:             4045.7 307.10000000000002    <NA>                <NA>   <NA> ##        HMDb_ID COMP_IDstr featureID ##   1: HMDB02327     M43027    M43027 ##   2: HMDB07098     M11953    M11953 ##   3: HMDB01881     M38002    M38002 ##   4: HMDB02123     M34404    M34404 ##   5: HMDB01882     M35963    M35963 ##  ---                                ## 754:      <NA>     M42912    M42912 ## 755:      <NA>     M42913    M42913 ## 756:      <NA>     M42914    M42914 ## 757:      <NA>     M42927    M42927 ## 758:      <NA>     M43130    M43130 ##  ## ***  @sampleData (ID:  sampleID ) *** ##       sampleID      AGE GENDER      BMI ETHNICITY T2D ##   1: QMDiab222 34.50513      0 25.01021         2   0 ##   2: QMDiab113 47.06639      1 28.36776         3   0 ##   3:  QMDiab29 55.49076      1 29.70564         1   0 ##   4: QMDiab243 56.33402      1 23.14050         2   0 ##   5: QMDiab270 35.63039      1 30.06229         1   0 ##  ---                                                  ## 352: QMDiab352 41.55510      1 31.22690         3   1 ## 353: QMDiab135 52.55305      0 29.07577         2   1 ## 354: QMDiab229 30.31348      0 22.22656         2   0 ## 355: QMDiab202 49.40999      1 33.72008         1   1 ## 356: QMDiab103 23.85489      0 35.96389         1   0 ##  ## ***  @miscData  *** ## integer(0) ##  ## ***  @logs  *** ## 09/03/22 21:46:20: Import data from: /private/var/folders/mj/lsf2tqcx13d5tgl627mm9fxm0000gn/T/RtmphZ45UH/temp_libpathc1cb175427a5/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . ## 09/03/22 21:46:20: Initiate data: 356 samples and 758 features. ## 09/03/22 21:46:20: Update data, action: change_featureID, 356 samples and 758 features. # load urine metabolomic data df_urine <- load_excel(path = file_path,                         data_sheet = 2,                         feature_sheet = 5,                         sample_sheet = 9,                         sampleID = \"QMDiab-ID\",                         featureID = \"BIOCHEMICAL\"                         )  df_urine <- update_Metabolite(df_urine, dataset = \"COMP_IDstr\", action = \"change_featureID\") df_urine ## An object of  Metabolite  ##  ## ***  @assayData (first and last 10 columns [ 359  *  892 ])  *** ##       sampleID   M38002 M34404  M32391 M20675   M21049  M34400 M40506  M34455 ##   1: QMDiab254  1189337 146900  265120  53499 15379982  619745  53261  227263 ##   2: QMDiab290  9944836 716781 2042008  71989 26406420 1988553 123129 1221563 ##   3:  QMDiab54   926350 182438  775726  48752  7551248 1159521  72837  215868 ##   4:  QMDiab55   305459 579097  511122  21423  4655848 1102500 131674      NA ##   5: QMDiab319   574761 295176  175826  91788  2762680  417870  21631  243512 ##  ---                                                                          ## 355:  QMDiab70  1139559 117975  326903     NA 10051449  406266 234997  183234 ## 356: QMDiab118  1517228 234288      NA  24350  2613189  375914  51929      NA ## 357:  QMDiab65  1028291 352068  609710 113673 29650920  621166 130037  549992 ## 358: QMDiab248  1807105 338741  148964  62614   937893  603113  48151  293379 ## 359:   QMDiab4 10103832 203176  245175  50822 28406416  243598  74996  696766 ##        M30460 M42272 M42314 M42335 M42351 M42352 M42553 M42856 M42913 M43112 ##   1:  5502123  96913  31056  33430     NA  35558     NA  23369  21931     NA ##   2: 17475172 124745  66036  39595     NA 732853     NA  28220  27811     NA ##   3:  6423459  44266  23363  39645     NA  62630     NA  13148  25018     NA ##   4:  4246983  77365  40193  46686     NA  92981     NA  22845  23620     NA ##   5:  2780633  24081  16319  25583     NA  31037     NA  29122  41337     NA ##  ---                                                                         ## 355:  1407294  54919  52317  78413     NA  38453     NA  33084 195136     NA ## 356:  1856043  42309  17973  25751     NA  12967     NA  15268  31577     NA ## 357: 10131966 110335  40228  34299     NA 108341     NA  52714  33244     NA ## 358:       NA  36055  29644  22465     NA  19287     NA  27299  36462     NA ## 359: 27087992 185546  45205  60944     NA 149210   9804  35991 186372     NA ##      M43129 M43130 ##   1:     NA     NA ##   2:     NA   7215 ##   3:     NA   8596 ##   4:     NA     NA ##   5:     NA     NA ##  ---               ## 355:     NA   5700 ## 356:     NA  11083 ## 357:     NA   6296 ## 358:     NA     NA ## 359:     NA   7482 ##  ## ***  @featureData (ID:  featureID ) *** ##      PATHWAY_SORTORDER                  BIOCHEMICAL SUPER_PATHWAY ##   1:               986              1,2-propanediol         Lipid ##   2:              1805         1,3,7-trimethylurate   Xenobiotics ##   3:              1802            1,3-dimethylurate   Xenobiotics ##   4:               583 1,5-anhydroglucitol (1,5-AG)  Carbohydrate ##   5:               591           1,6-anhydroglucose  Carbohydrate ##  ---                                                              ## 887:              <NA>                    X - 19380          <NA> ## 888:              <NA>                    X - 19437          <NA> ## 889:              <NA>                    X - 19556          <NA> ## 890:              <NA>                    X - 19573          <NA> ## 891:              <NA>                    X - 19574          <NA> ##                                           SUB_PATHWAY COMP_ID  PLATFORM ##   1:                                    Ketone bodies   38002     GC/MS ##   2:                              Xanthine metabolism   34404 LC/MS Neg ##   3:                              Xanthine metabolism   32391     GC/MS ##   4: Glycolysis, gluconeogenesis, pyruvate metabolism   20675 LC/MS Neg ##   5: Glycolysis, gluconeogenesis, pyruvate metabolism   21049     GC/MS ##  ---                                                                    ## 887:                                             <NA>   42856 LC/MS Neg ## 888:                                             <NA>   42913 LC/MS Neg ## 889:                                             <NA>   43112 LC/MS Pos ## 890:                                             <NA>   43129 LC/MS Neg ## 891:                                             <NA>   43130 LC/MS Neg ##                      RI               MASS  PUBCHEM        CAS   KEGG   HMDb_ID ##   1:               1041                117     <NA>   57-55-6; C00583 HMDB01881 ##   2:               1988              209.1    79437 5415-44-1; C16361 HMDB02123 ##   3:               1937 325.10000000000002    70346 944-73-0 ;   <NA> HMDB01857 ##   4:                808 163.19999999999999     <NA>  154-58-5; C07326 HMDB02712 ##   5:             1679.5              204.1 11412545  498-07-7;   <NA> HMDB00640 ##  ---                                                                            ## 887:               2287              412.4     <NA>       <NA>   <NA>      <NA> ## 888: 1150.0999999999999              397.1     <NA>       <NA>   <NA>      <NA> ## 889: 4249.8999999999996              404.9     <NA>       <NA>   <NA>      <NA> ## 890:             3906.5              403.2     <NA>       <NA>   <NA>      <NA> ## 891:             4045.7 307.10000000000002     <NA>       <NA>   <NA>      <NA> ##      COMP_IDstr featureID ##   1:     M38002    M38002 ##   2:     M34404    M34404 ##   3:     M32391    M32391 ##   4:     M20675    M20675 ##   5:     M21049    M21049 ##  ---                      ## 887:     M42856    M42856 ## 888:     M42913    M42913 ## 889:     M43112    M43112 ## 890:     M43129    M43129 ## 891:     M43130    M43130 ##  ## ***  @sampleData (ID:  sampleID ) *** ##       sampleID      AGE GENDER      BMI ETHNICITY T2D ##   1: QMDiab254 53.10335      0 32.05128         1   0 ##   2: QMDiab290 39.79192      1 30.51426         4   0 ##   3:  QMDiab54 36.82136      0 24.16831         1   0 ##   4:  QMDiab55 34.75975      0 44.44444         1   1 ##   5: QMDiab319 50.17933      1 27.18090         1   1 ##  ---                                                  ## 355:  QMDiab70 35.40315      1 33.83403         1   1 ## 356: QMDiab118 49.06229      1 25.64494         1   0 ## 357:  QMDiab65 47.22245      1 23.38435         1   0 ## 358: QMDiab248 56.39151      0 27.58621         1   1 ## 359:   QMDiab4 24.22450      0 41.66521         1   0 ##  ## ***  @miscData  *** ## integer(0) ##  ## ***  @logs  *** ## 09/03/22 21:46:21: Import data from: /private/var/folders/mj/lsf2tqcx13d5tgl627mm9fxm0000gn/T/RtmphZ45UH/temp_libpathc1cb175427a5/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . ## 09/03/22 21:46:21: Initiate data: 359 samples and 891 features. ## 09/03/22 21:46:21: Update data, action: change_featureID, 359 samples and 891 features. # load saliva metatabolomic data df_saliva <- load_excel(path = file_path,                         data_sheet = 3,                         feature_sheet = 6,                         sample_sheet = 10,                         sampleID = \"QMDiab-ID\",                         featureID = \"BIOCHEMICAL\"                         )  df_saliva <- update_Metabolite(df_saliva, dataset = \"COMP_IDstr\", action = \"change_featureID\") df_saliva ## An object of  Metabolite  ##  ## ***  @assayData (first and last 10 columns [ 321  *  603 ])  *** ##       sampleID M43027  M38002 M01654 M35963 M35690 M20675 M21049 M34400 M35628 ##   1: QMDiab370  11974  720004     NA     NA  91544 211457     NA   2661     NA ##   2: QMDiab245  15485  481889  24313  53097  80819 175312  25921   2250  27847 ##   3:  QMDiab34  13916  979243     NA  44158 104042 271930     NA     NA     NA ##   4: QMDiab287  28023  825577     NA  57600 157057  50692     NA     NA     NA ##   5: QMDiab355  22830 1150408     NA  63460 225965 741408  71523   3739     NA ##  ---                                                                           ## 317: QMDiab202  16493  488210     NA     NA 116683 158562     NA   3496  18241 ## 318:  QMDiab80  15254 3345272  23456  36201 120444 295726 107821     NA  14988 ## 319: QMDiab107  31452  578446     NA  20563 245882 234635     NA     NA     NA ## 320: QMDiab352  18975  280464     NA     NA  20491  77539     NA     NA  19239 ## 321: QMDiab127  16344  881910  64403  44381 206525 912153     NA     NA  12066 ##      M42851 M42877 M42913 M42914 M43042 M43049 M43050 M43110 M43122 M43128 ##   1:   4937     NA   5390     NA  22149   4997   5548     NA     NA  14190 ##   2:   3316     NA  10883   1110  22797   8284     NA     NA     NA  15273 ##   3:   3260     NA     NA     NA  15291     NA     NA     NA     NA  10602 ##   4:   3463     NA   6735     NA  20655   5779     NA     NA     NA  13165 ##   5:   3887     NA   3670     NA  45619   6922     NA  12023     NA  15046 ##  ---                                                                       ## 317:     NA     NA   7243     NA  14632     NA     NA     NA     NA  15163 ## 318:     NA     NA  10592   3708  15018   5433     NA     NA     NA  21337 ## 319:     NA     NA     NA   4409  37399   9265     NA  42065     NA  37183 ## 320:     NA     NA   9140   4056   3362     NA     NA     NA     NA  21376 ## 321:     NA   2645   7590   4894  25546   5422     NA     NA     NA  15142 ##      M43137 ##   1:     NA ##   2:     NA ##   3:     NA ##   4:     NA ##   5:     NA ##  ---        ## 317:     NA ## 318:     NA ## 319:     NA ## 320:     NA ## 321:     NA ##  ## ***  @featureData (ID:  featureID ) *** ##      PATHWAY_SORTORDER                BIOCHEMICAL SUPER_PATHWAY ##   1:             800.1 1,11-undecanedicarboxylate         Lipid ##   2:               986            1,2-propanediol         Lipid ##   3:               273         1,3-diaminopropane    Amino acid ##   4:               600       1,3-dihydroxyacetone  Carbohydrate ##   5:              1494             1,4-butanediol   Xenobiotics ##  ---                                                            ## 598:              <NA>                  X - 19497          <NA> ## 599:              <NA>                  X - 19554          <NA> ## 600:              <NA>                  X - 19566          <NA> ## 601:              <NA>                  X - 19572          <NA> ## 602:              <NA>                  X - 19581          <NA> ##                                           SUB_PATHWAY COMP_ID  PLATFORM ##   1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg ##   2:                                    Ketone bodies   38002     GC/MS ##   3:      Urea cycle; arginine-, proline-, metabolism    1654     GC/MS ##   4: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS ##   5:                                         Chemical   35690     GC/MS ##  ---                                                                    ## 598:                                             <NA>   43050 LC/MS Neg ## 599:                                             <NA>   43110 LC/MS Pos ## 600:                                             <NA>   43122 LC/MS Neg ## 601:                                             <NA>   43128 LC/MS Neg ## 602:                                             <NA>   43137 LC/MS Neg ##                      RI  MASS PUBCHEM                 CAS   KEGG   HMDb_ID ##   1:               3578 243.2   10458           505-52-2;   <NA> HMDB02327 ##   2:               1041   117    <NA>            57-55-6; C00583 HMDB01881 ##   3:             1633.8   174     428           109-76-2; C00986 HMDB00002 ##   4:               1263   103     670 96-26-4;62147-49-3; C00184 HMDB01882 ##   5:               1208 115.8    <NA>           110-63-4;   <NA>      <NA> ##  ---                                                                       ## 598:             3657.6 227.3    <NA>                <NA>   <NA>      <NA> ## 599:             3618.7   471    <NA>                <NA>   <NA>      <NA> ## 600:             2953.2 744.5    <NA>                <NA>   <NA>      <NA> ## 601:             3761.2 431.3    <NA>                <NA>   <NA>      <NA> ## 602: 4949.6000000000004 938.5    <NA>                <NA>   <NA>      <NA> ##      COMP_IDstr featureID ##   1:     M43027    M43027 ##   2:     M38002    M38002 ##   3:     M01654    M01654 ##   4:     M35963    M35963 ##   5:     M35690    M35690 ##  ---                      ## 598:     M43050    M43050 ## 599:     M43110    M43110 ## 600:     M43122    M43122 ## 601:     M43128    M43128 ## 602:     M43137    M43137 ##  ## ***  @sampleData (ID:  sampleID ) *** ##       sampleID      AGE GENDER      BMI ETHNICITY T2D ##   1: QMDiab370 56.49829      1 25.76591         1   1 ##   2: QMDiab245 51.51540      0 23.89943         1   0 ##   3:  QMDiab34 28.00548      0 23.90118         3   0 ##   4: QMDiab287 41.43463      0 31.47107         4   1 ##   5: QMDiab355 28.34771      0 25.16103         1   0 ##  ---                                                  ## 317: QMDiab202 49.40999      1 33.72008         1   1 ## 318:  QMDiab80 25.86995      0 29.89101         1   0 ## 319: QMDiab107 38.50240      1 24.60973         2   0 ## 320: QMDiab352 41.55510      1 31.22690         3   1 ## 321: QMDiab127 34.69952      1 30.47797         1   0 ##  ## ***  @miscData  *** ## integer(0) ##  ## ***  @logs  *** ## 09/03/22 21:46:21: Import data from: /private/var/folders/mj/lsf2tqcx13d5tgl627mm9fxm0000gn/T/RtmphZ45UH/temp_libpathc1cb175427a5/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . ## 09/03/22 21:46:21: Initiate data: 321 samples and 602 features. ## 09/03/22 21:46:21: Update data, action: change_featureID, 321 samples and 602 features."},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"quality-control-pipeline","dir":"Articles","previous_headings":"","what":"Quality control pipeline","title":"An introduction to the metabolomicsR","text":"provided pipeline metabolite sample quality control (QC) procedures series functions. QC pipeline, included following functions: remove metabolites samples beyond particular missing rate threshold (eg. 0.5), detect outliers (eg. +- 5 SD) replace outliers NA winsorize outliers, popular methods impute missing values (eg. half minimum value). steps can customized implement “QC_pipeline” function used individual functions (eg. “filter_column_missing_rate”, “replace_outlier”, “impute”).","code":"df_plasma_QC <- QC_pipeline(df_plasma, replace_outlier_method = \"winsorize\", impute_method = NULL) ##  ## Constant columns n = 37 ##  ##  Number of columns with a missing rate >= 0.5 : n = 176 df_plasma_QC ## An object of  Metabolite  ##  ## ***  @assayData (first and last 10 columns [ 356  *  546 ])  *** ##       sampleID M43027 M11953 M38002 M34404 M35963 M35728 M20675 M34400  M33228 ##   1: QMDiab222   8578     NA 103724  22259 104059   7067 357499  19986 2173598 ##   2: QMDiab113  15145     NA     NA  39841     NA  36542 440058  16620 2464846 ##   3:  QMDiab29     NA  96455 159945  10605 165416  54209 355790  12220 2613798 ##   4: QMDiab243  19692  69444 108965  38562 139866  22412 185273  29537 2543266 ##   5: QMDiab270     NA     NA 157617   4490     NA  21958 692753  10256 2138029 ##  ---                                                                           ## 352: QMDiab352   6689 116932 115737  34791 152711  59120 178759  25326  864647 ## 353: QMDiab135   7556 248824 481008   4766 164853 126065 103647  12253 3018611 ## 354: QMDiab229  20252  80804 138253  13949  85019  43072 330579  15124 1398965 ## 355: QMDiab202   7378 108152 112229  21748 175918  78154 106745  21434 2104899 ## 356: QMDiab103   6667  57851 146948   8458  82064  34234 534697  12979  992388 ##      M42307 M42314 M42544 M42548 M42549 M42552 M42554 M42856 M42887 M42913 ##   1:     NA  30592   3839  13734     NA     NA  37654 158054  88569  64644 ##   2:   6978  81380   4128  15288     NA   4697  28262 125669  87268  52074 ##   3:  17943 104253   6788  18861   6761   5096  30139 194732 106360  31782 ##   4:  11069  73203   8493  12138  10371  11207  21406 152853 119643  67713 ##   5:   7904  28846   7130  12843   3150   4556  14976 204978 149644 108660 ##  ---                                                                       ## 352:  11539  40487   9988   6173   7678   9008  30501 195331 134564  22141 ## 353:   5441  37950     NA  18464     NA     NA  43687 136120  75431  61867 ## 354:     NA  18098   5766   8244   5932     NA  18728 216380 128925  84299 ## 355:   8119  70566   8470  11932     NA   5895  27858 162256 112923  42586 ## 356:   7647  46836   7420   8019     NA   8253  32159 137705 112636  89283 ##      M42914 ##   1:  18055 ##   2:  12805 ##   3:  18467 ##   4:  12356 ##   5:  12479 ##  ---        ## 352:  17205 ## 353:  28223 ## 354:  14936 ## 355:  51588 ## 356:  23515 ##  ## ***  @featureData (ID:  featureID ) *** ##      PATHWAY_SORTORDER                    BIOCHEMICAL SUPER_PATHWAY ##   1:             800.1 1,11-Undecanedicarboxylic acid         Lipid ##   2:              1070        1,2-dipalmitoylglycerol         Lipid ##   3:               986                1,2-propanediol         Lipid ##   4:              1805           1,3,7-trimethylurate   Xenobiotics ##   5:               600           1,3-dihydroxyacetone  Carbohydrate ##  ---                                                                ## 754:              <NA>                      X - 19436          <NA> ## 755:              <NA>                      X - 19437          <NA> ## 756:              <NA>                      X - 19438          <NA> ## 757:              <NA>                      X - 19451          <NA> ## 758:              <NA>                      X - 19574          <NA> ##                                           SUB_PATHWAY COMP_ID  PLATFORM ##   1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg ##   2:                                   Diacylglycerol   11953     GC/MS ##   3:                                    Ketone bodies   38002     GC/MS ##   4:                              Xanthine metabolism   34404 LC/MS Neg ##   5: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS ##  ---                                                                    ## 754:                                             <NA>   42912 LC/MS Neg ## 755:                                             <NA>   42913 LC/MS Neg ## 756:                                             <NA>   42914 LC/MS Neg ## 757:                                             <NA>   42927 LC/MS Neg ## 758:                                             <NA>   43130 LC/MS Neg ##                      RI               MASS PUBCHEM                 CAS   KEGG ##   1:               3578              243.2   10458           505-52-2;   <NA> ##   2:               2600                145   99931         40290-32-2;   <NA> ##   3:               1041                117    <NA>            57-55-6; C00583 ##   4:               1988              209.1   79437          5415-44-1; C16361 ##   5:               1263                103     670 96-26-4;62147-49-3; C00184 ##  ---                                                                          ## 754:               4747              467.4    <NA>                <NA>   <NA> ## 755: 1150.0999999999999              397.1    <NA>                <NA>   <NA> ## 756:             1222.3              217.1    <NA>                <NA>   <NA> ## 757:             3728.5              239.1    <NA>                <NA>   <NA> ## 758:             4045.7 307.10000000000002    <NA>                <NA>   <NA> ##        HMDb_ID COMP_IDstr featureID ##   1: HMDB02327     M43027    M43027 ##   2: HMDB07098     M11953    M11953 ##   3: HMDB01881     M38002    M38002 ##   4: HMDB02123     M34404    M34404 ##   5: HMDB01882     M35963    M35963 ##  ---                                ## 754:      <NA>     M42912    M42912 ## 755:      <NA>     M42913    M42913 ## 756:      <NA>     M42914    M42914 ## 757:      <NA>     M42927    M42927 ## 758:      <NA>     M43130    M43130 ##  ## ***  @sampleData (ID:  sampleID ) *** ##       sampleID      AGE GENDER      BMI ETHNICITY T2D ##   1: QMDiab222 34.50513      0 25.01021         2   0 ##   2: QMDiab113 47.06639      1 28.36776         3   0 ##   3:  QMDiab29 55.49076      1 29.70564         1   0 ##   4: QMDiab243 56.33402      1 23.14050         2   0 ##   5: QMDiab270 35.63039      1 30.06229         1   0 ##  ---                                                  ## 352: QMDiab352 41.55510      1 31.22690         3   1 ## 353: QMDiab135 52.55305      0 29.07577         2   1 ## 354: QMDiab229 30.31348      0 22.22656         2   0 ## 355: QMDiab202 49.40999      1 33.72008         1   1 ## 356: QMDiab103 23.85489      0 35.96389         1   0 ##  ## ***  @miscData  *** ## integer(0) ##  ## ***  @logs  *** ## 09/03/22 21:46:20: Import data from: /private/var/folders/mj/lsf2tqcx13d5tgl627mm9fxm0000gn/T/RtmphZ45UH/temp_libpathc1cb175427a5/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . ## 09/03/22 21:46:20: Initiate data: 356 samples and 758 features. ## 09/03/22 21:46:20: Update data, action: change_featureID, 356 samples and 758 features.  ##  ## 09/03/22 21:46:22: Run QC pipeline. ## 09/03/22 21:46:22: Filter data with a constant column, removed 37 features.  ## 09/03/22 21:46:22: Update data, 356 samples and 758 features.  ## 09/03/22 21:46:22: Filter data with a missing rate >= 0.5, removed 176 features.  ## 09/03/22 21:46:22: Update data, 356 samples and 758 features.  ## 09/03/22 21:46:22: Replace outliers using `winsorize` method 5 SDs. df_urine_QC <- QC_pipeline(df_urine, replace_outlier_method = \"winsorize\", impute_method = NULL) ##  ## Constant columns n = 28 ##  ##  Number of columns with a missing rate >= 0.5 : n = 77 df_urine_QC ## An object of  Metabolite  ##  ## ***  @assayData (first and last 10 columns [ 359  *  787 ])  *** ##       sampleID   M38002 M34404  M32391 M20675   M21049  M34400 M40506  M34455 ##   1: QMDiab254  1189337 146900  265120  53499 15379982  619745  53261  227263 ##   2: QMDiab290  9944836 716781 2042008  71989 26406420 1988553 123129 1221563 ##   3:  QMDiab54   926350 182438  775726  48752  7551248 1159521  72837  215868 ##   4:  QMDiab55   305459 579097  511122  21423  4655848 1102500 131674      NA ##   5: QMDiab319   574761 295176  175826  91788  2762680  417870  21631  243512 ##  ---                                                                          ## 355:  QMDiab70  1139559 117975  326903     NA 10051449  406266 234997  183234 ## 356: QMDiab118  1517228 234288      NA  24350  2613189  375914  51929      NA ## 357:  QMDiab65  1028291 352068  609710 113673 29650920  621166 130037  549992 ## 358: QMDiab248  1807105 338741  148964  62614   937893  603113  48151  293379 ## 359:   QMDiab4 10103832 203176  245175  50822 28406416  243598  74996  696766 ##        M30460 M41595 M41702 M41709 M41768 M41837 M42272 M42314 M42335 M42352 ##   1:  5502123  74988  29007   4223  17008   5636  96913  31056  33430  35558 ##   2: 17475172  66278 101935  34251  14937   9552 124745  66036  39595 652059 ##   3:  6423459  74225  51295  14090  32971   9104  44266  23363  39645  62630 ##   4:  4246983  63809  31054   6151   8054  15148  77365  40193  46686  92981 ##   5:  2780633  40804   8307   3715  31370   5993  24081  16319  25583  31037 ##  ---                                                                         ## 355:  1407294  67664  36157     NA  29194  15652  54919  52317  78413  38453 ## 356:  1856043  34332  29877  30817   5029   4603  42309  17973  25751  12967 ## 357: 10131966  57310  22374     NA  19358   9598 110335  40228  34299 108341 ## 358:       NA  26670   8525   7059  13231   9698  36055  29644  22465  19287 ## 359: 27087992  95140  66285  20229  35845  18570 185546  45205  60944 149210 ##      M42856 M42913 ##   1:  23369  21931 ##   2:  28220  27811 ##   3:  13148  25018 ##   4:  22845  23620 ##   5:  29122  41337 ##  ---               ## 355:  33084 195136 ## 356:  15268  31577 ## 357:  52714  33244 ## 358:  27299  36462 ## 359:  35991 186372 ##  ## ***  @featureData (ID:  featureID ) *** ##      PATHWAY_SORTORDER                  BIOCHEMICAL SUPER_PATHWAY ##   1:               986              1,2-propanediol         Lipid ##   2:              1805         1,3,7-trimethylurate   Xenobiotics ##   3:              1802            1,3-dimethylurate   Xenobiotics ##   4:               583 1,5-anhydroglucitol (1,5-AG)  Carbohydrate ##   5:               591           1,6-anhydroglucose  Carbohydrate ##  ---                                                              ## 887:              <NA>                    X - 19380          <NA> ## 888:              <NA>                    X - 19437          <NA> ## 889:              <NA>                    X - 19556          <NA> ## 890:              <NA>                    X - 19573          <NA> ## 891:              <NA>                    X - 19574          <NA> ##                                           SUB_PATHWAY COMP_ID  PLATFORM ##   1:                                    Ketone bodies   38002     GC/MS ##   2:                              Xanthine metabolism   34404 LC/MS Neg ##   3:                              Xanthine metabolism   32391     GC/MS ##   4: Glycolysis, gluconeogenesis, pyruvate metabolism   20675 LC/MS Neg ##   5: Glycolysis, gluconeogenesis, pyruvate metabolism   21049     GC/MS ##  ---                                                                    ## 887:                                             <NA>   42856 LC/MS Neg ## 888:                                             <NA>   42913 LC/MS Neg ## 889:                                             <NA>   43112 LC/MS Pos ## 890:                                             <NA>   43129 LC/MS Neg ## 891:                                             <NA>   43130 LC/MS Neg ##                      RI               MASS  PUBCHEM        CAS   KEGG   HMDb_ID ##   1:               1041                117     <NA>   57-55-6; C00583 HMDB01881 ##   2:               1988              209.1    79437 5415-44-1; C16361 HMDB02123 ##   3:               1937 325.10000000000002    70346 944-73-0 ;   <NA> HMDB01857 ##   4:                808 163.19999999999999     <NA>  154-58-5; C07326 HMDB02712 ##   5:             1679.5              204.1 11412545  498-07-7;   <NA> HMDB00640 ##  ---                                                                            ## 887:               2287              412.4     <NA>       <NA>   <NA>      <NA> ## 888: 1150.0999999999999              397.1     <NA>       <NA>   <NA>      <NA> ## 889: 4249.8999999999996              404.9     <NA>       <NA>   <NA>      <NA> ## 890:             3906.5              403.2     <NA>       <NA>   <NA>      <NA> ## 891:             4045.7 307.10000000000002     <NA>       <NA>   <NA>      <NA> ##      COMP_IDstr featureID ##   1:     M38002    M38002 ##   2:     M34404    M34404 ##   3:     M32391    M32391 ##   4:     M20675    M20675 ##   5:     M21049    M21049 ##  ---                      ## 887:     M42856    M42856 ## 888:     M42913    M42913 ## 889:     M43112    M43112 ## 890:     M43129    M43129 ## 891:     M43130    M43130 ##  ## ***  @sampleData (ID:  sampleID ) *** ##       sampleID      AGE GENDER      BMI ETHNICITY T2D ##   1: QMDiab254 53.10335      0 32.05128         1   0 ##   2: QMDiab290 39.79192      1 30.51426         4   0 ##   3:  QMDiab54 36.82136      0 24.16831         1   0 ##   4:  QMDiab55 34.75975      0 44.44444         1   1 ##   5: QMDiab319 50.17933      1 27.18090         1   1 ##  ---                                                  ## 355:  QMDiab70 35.40315      1 33.83403         1   1 ## 356: QMDiab118 49.06229      1 25.64494         1   0 ## 357:  QMDiab65 47.22245      1 23.38435         1   0 ## 358: QMDiab248 56.39151      0 27.58621         1   1 ## 359:   QMDiab4 24.22450      0 41.66521         1   0 ##  ## ***  @miscData  *** ## integer(0) ##  ## ***  @logs  *** ## 09/03/22 21:46:21: Import data from: /private/var/folders/mj/lsf2tqcx13d5tgl627mm9fxm0000gn/T/RtmphZ45UH/temp_libpathc1cb175427a5/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . ## 09/03/22 21:46:21: Initiate data: 359 samples and 891 features. ## 09/03/22 21:46:21: Update data, action: change_featureID, 359 samples and 891 features.  ##  ## 09/03/22 21:46:22: Run QC pipeline. ## 09/03/22 21:46:22: Filter data with a constant column, removed 28 features.  ## 09/03/22 21:46:22: Update data, 359 samples and 891 features.  ## 09/03/22 21:46:23: Filter data with a missing rate >= 0.5, removed 77 features.  ## 09/03/22 21:46:23: Update data, 359 samples and 891 features.  ## 09/03/22 21:46:23: Replace outliers using `winsorize` method 5 SDs. df_saliva_QC <- QC_pipeline(df_saliva, replace_outlier_method = \"winsorize\", impute_method = NULL) ##  ## Constant columns n = 35 ##  ##  Number of columns with a missing rate >= 0.5 : n = 203 df_saliva_QC ## An object of  Metabolite  ##  ## ***  @assayData (first and last 10 columns [ 321  *  365 ])  *** ##       sampleID M43027  M38002 M35690 M20675 M35628 M37536 M37752  M35691 M38276 ##   1: QMDiab370  11974  720004  91544 211457     NA     NA 121286  352891 161984 ##   2: QMDiab245  15485  481889  80819 175312  27847  24251  78051  179709 155695 ##   3:  QMDiab34  13916  979243 104042 271930     NA  19333  54685   58106  99814 ##   4: QMDiab287  28023  825577 157057  50692     NA  22527 134397   48854 134122 ##   5: QMDiab355  22830 1150408 225965 741408     NA  67922 113970  989663 232232 ##  ---                                                                            ## 317: QMDiab202  16493  488210 116683 158562  18241  54375 119442  302910 345072 ## 318:  QMDiab80  15254 3345272 120444 295726  14988 112052  98093 1567170 445473 ## 319: QMDiab107  31452  578446 245882 234635     NA     NA  74245  171205 132903 ## 320: QMDiab352  18975  280464  20491  77539  19239  35706  53731   95315  97904 ## 321: QMDiab127  16344  881910 206525 912153  12066  30309 102026  843075 941156 ##      M41491  M41548 M41921 M42238 M42272 M42741 M42851 M42913 M43042 M43049 ##   1: 404368 1007590  10148   6156   2352     NA   4937   5390  22149   4997 ##   2: 360478  641392  11972   5093     NA  13502   3316  10883  22797   8284 ##   3: 368498  741774   4553   4875   9858     NA   3260     NA  15291     NA ##   4: 900064  429374   7717     NA   6371     NA   3463   6735  20655   5779 ##   5: 506638  786827   7807     NA  11181  16551   3887   3670  45619   6922 ##  ---                                                                        ## 317: 368498  264313  12567     NA  11743  12683     NA   7243  14632     NA ## 318: 623000  367782  29507     NA     NA  32002     NA  10592  15018   5433 ## 319: 983332  883025  13123   4657     NA  19707     NA     NA  37399   9265 ## 320:  85130  230107  15529     NA     NA   4080     NA   9140   3362     NA ## 321: 902186      NA  17118   9253   4176  60963     NA   7590  25546   5422 ##      M43128 ##   1:  14190 ##   2:  15273 ##   3:  10602 ##   4:  13165 ##   5:  15046 ##  ---        ## 317:  15163 ## 318:  21337 ## 319:  37183 ## 320:  21376 ## 321:  15142 ##  ## ***  @featureData (ID:  featureID ) *** ##      PATHWAY_SORTORDER                BIOCHEMICAL SUPER_PATHWAY ##   1:             800.1 1,11-undecanedicarboxylate         Lipid ##   2:               986            1,2-propanediol         Lipid ##   3:               273         1,3-diaminopropane    Amino acid ##   4:               600       1,3-dihydroxyacetone  Carbohydrate ##   5:              1494             1,4-butanediol   Xenobiotics ##  ---                                                            ## 598:              <NA>                  X - 19497          <NA> ## 599:              <NA>                  X - 19554          <NA> ## 600:              <NA>                  X - 19566          <NA> ## 601:              <NA>                  X - 19572          <NA> ## 602:              <NA>                  X - 19581          <NA> ##                                           SUB_PATHWAY COMP_ID  PLATFORM ##   1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg ##   2:                                    Ketone bodies   38002     GC/MS ##   3:      Urea cycle; arginine-, proline-, metabolism    1654     GC/MS ##   4: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS ##   5:                                         Chemical   35690     GC/MS ##  ---                                                                    ## 598:                                             <NA>   43050 LC/MS Neg ## 599:                                             <NA>   43110 LC/MS Pos ## 600:                                             <NA>   43122 LC/MS Neg ## 601:                                             <NA>   43128 LC/MS Neg ## 602:                                             <NA>   43137 LC/MS Neg ##                      RI  MASS PUBCHEM                 CAS   KEGG   HMDb_ID ##   1:               3578 243.2   10458           505-52-2;   <NA> HMDB02327 ##   2:               1041   117    <NA>            57-55-6; C00583 HMDB01881 ##   3:             1633.8   174     428           109-76-2; C00986 HMDB00002 ##   4:               1263   103     670 96-26-4;62147-49-3; C00184 HMDB01882 ##   5:               1208 115.8    <NA>           110-63-4;   <NA>      <NA> ##  ---                                                                       ## 598:             3657.6 227.3    <NA>                <NA>   <NA>      <NA> ## 599:             3618.7   471    <NA>                <NA>   <NA>      <NA> ## 600:             2953.2 744.5    <NA>                <NA>   <NA>      <NA> ## 601:             3761.2 431.3    <NA>                <NA>   <NA>      <NA> ## 602: 4949.6000000000004 938.5    <NA>                <NA>   <NA>      <NA> ##      COMP_IDstr featureID ##   1:     M43027    M43027 ##   2:     M38002    M38002 ##   3:     M01654    M01654 ##   4:     M35963    M35963 ##   5:     M35690    M35690 ##  ---                      ## 598:     M43050    M43050 ## 599:     M43110    M43110 ## 600:     M43122    M43122 ## 601:     M43128    M43128 ## 602:     M43137    M43137 ##  ## ***  @sampleData (ID:  sampleID ) *** ##       sampleID      AGE GENDER      BMI ETHNICITY T2D ##   1: QMDiab370 56.49829      1 25.76591         1   1 ##   2: QMDiab245 51.51540      0 23.89943         1   0 ##   3:  QMDiab34 28.00548      0 23.90118         3   0 ##   4: QMDiab287 41.43463      0 31.47107         4   1 ##   5: QMDiab355 28.34771      0 25.16103         1   0 ##  ---                                                  ## 317: QMDiab202 49.40999      1 33.72008         1   1 ## 318:  QMDiab80 25.86995      0 29.89101         1   0 ## 319: QMDiab107 38.50240      1 24.60973         2   0 ## 320: QMDiab352 41.55510      1 31.22690         3   1 ## 321: QMDiab127 34.69952      1 30.47797         1   0 ##  ## ***  @miscData  *** ## integer(0) ##  ## ***  @logs  *** ## 09/03/22 21:46:21: Import data from: /private/var/folders/mj/lsf2tqcx13d5tgl627mm9fxm0000gn/T/RtmphZ45UH/temp_libpathc1cb175427a5/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . ## 09/03/22 21:46:21: Initiate data: 321 samples and 602 features. ## 09/03/22 21:46:21: Update data, action: change_featureID, 321 samples and 602 features.  ##  ## 09/03/22 21:46:23: Run QC pipeline. ## 09/03/22 21:46:23: Filter data with a constant column, removed 35 features.  ## 09/03/22 21:46:23: Update data, 321 samples and 602 features.  ## 09/03/22 21:46:23: Filter data with a missing rate >= 0.5, removed 203 features.  ## 09/03/22 21:46:23: Update data, 321 samples and 602 features.  ## 09/03/22 21:46:23: Replace outliers using `winsorize` method 5 SDs."},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"transformation","dir":"Articles","previous_headings":"","what":"Transformation","title":"An introduction to the metabolomicsR","text":"Transformation metabolites can alter distribution data essential step following statistical analysis. provided following transformation methods: log (natural logarithm), pareto scale, scale, rank-based inverse normal transformation.","code":"df_plasma_QC <- impute(df_plasma_QC, method = \"half-min\") df_plasma_scale <-  transformation(df_plasma_QC, method = \"log\") df_plasma_scale <-  transformation(df_plasma_scale, method = \"scale\") df_plasma_scale ## An object of  Metabolite  ##  ## ***  @assayData (first and last 10 columns [ 356  *  546 ])  *** ##       sampleID      M43027      M11953      M38002     M34404     M35963 ##   1: QMDiab222  0.38328962 -2.06937034 -0.25776988  0.1300954  0.1329676 ##   2: QMDiab113  1.09208975 -2.06937034 -2.09811585  0.7401431 -2.7715161 ##   3:  QMDiab29 -2.07224771  0.37986636  0.19492231 -0.6468556  0.7526296 ##   4: QMDiab243  1.41944199  0.02182271 -0.20624637  0.7059502  0.5283257 ##   5: QMDiab270 -2.07224771 -2.06937034  0.17959695 -1.5475159 -2.7715161 ##  ---                                                                     ## 352: QMDiab352  0.07315101  0.58966058 -0.14322471  0.5981101  0.6457892 ## 353: QMDiab135  0.22511485  1.41258850  1.34579403 -1.4850024  0.7480716 ## 354: QMDiab229  1.45440521  0.18692608  0.04258334 -0.3596389 -0.1371982 ## 355: QMDiab202  0.19539060  0.50460026 -0.17539627  0.1057578  0.8349219 ## 356: QMDiab103  0.06904336 -0.17721998  0.10633646 -0.8839089 -0.1844916 ##           M35728     M20675     M34400     M33228      M42307      M42314 ##   1: -2.15022266  0.4846600  0.1504626  0.7147450 -1.66388170 -0.28947392 ##   2: -0.22011372  0.7246235 -0.1016651  0.9880064  0.23596643  1.43130720 ##   3:  0.24318100  0.4791258 -0.5220933  1.1155149  1.20217335  1.86694301 ##   4: -0.79439802 -0.2744750  0.6844679  1.0560683  0.70798740  1.24506376 ##   5: -0.81843882  1.2486906 -0.7616244  0.6788895  0.36344522 -0.39283289 ##  ---                                                                      ## 352:  0.34505615 -0.3158120  0.4741913 -1.2884859  0.75053010  0.20341269 ## 353:  1.23459353 -0.9453014 -0.5184065  1.4284294 -0.01856785  0.08959909 ## 354: -0.02697569  0.3942445 -0.2306154 -0.2428478 -1.66388170 -1.21272633 ## 355:  0.67293679 -0.9112866  0.2460864  0.6449519  0.39090187  1.18053745 ## 356: -0.29675648  0.9495957 -0.4397136 -0.9890440  0.32962775  0.45961727 ##          M42544      M42548     M42549      M42552      M42554      M42856 ##   1: -0.7965687 -0.10047059 -0.9487939 -1.37729107  0.68352801 -0.11254665 ##   2: -0.6745840  0.07424437 -0.9487939  0.08365871  0.29566066 -0.99002949 ##   3:  0.1613181  0.41656906  0.8587908  0.18047655  0.38258560  0.68610780 ##   4:  0.5379320 -0.30181776  1.2068728  1.11631207 -0.07994001 -0.24059952 ##   5:  0.2439311 -0.20979707  0.2374080  0.04746543 -0.56284248  0.88235205 ##  ---                                                                       ## 352:  0.8104388 -1.40388426  0.9622680  0.85693528  0.39872567  0.69786177 ## 353: -2.8888549  0.38189554 -0.9487939 -1.37729107  0.88442476 -0.68430531 ## 354: -0.1129294 -0.93235314  0.7523676 -1.37729107 -0.26061363  1.08952272 ## 355:  0.5333744 -0.32971701 -0.9487939  0.35343194  0.27619711 -0.01213065 ## 356:  0.3109356 -0.97745562 -0.9487939  0.75298733  0.47028172 -0.64000024 ##          M42887     M42913      M42914 ##   1: -1.0147901  0.0919409 -0.07636980 ##   2: -1.0843123 -0.2871253 -0.80423166 ##   3: -0.1548217 -1.1527328 -0.02857249 ##   4:  0.3980587  0.1732535 -0.87984647 ##   5:  1.4492342  1.0023618 -0.85886254 ##  ---                                   ## 352:  0.9502102 -1.7864144 -0.17852561 ## 353: -1.7691271  0.0149663  0.86995988 ## 354:  0.7490907  0.5573375 -0.47812467 ## 355:  0.1264821 -0.6397389  2.14768955 ## 356:  0.1145265  0.6580360  0.48335069 ##  ## ***  @featureData (ID:  featureID ) *** ##      PATHWAY_SORTORDER                    BIOCHEMICAL SUPER_PATHWAY ##   1:             800.1 1,11-Undecanedicarboxylic acid         Lipid ##   2:              1070        1,2-dipalmitoylglycerol         Lipid ##   3:               986                1,2-propanediol         Lipid ##   4:              1805           1,3,7-trimethylurate   Xenobiotics ##   5:               600           1,3-dihydroxyacetone  Carbohydrate ##  ---                                                                ## 754:              <NA>                      X - 19436          <NA> ## 755:              <NA>                      X - 19437          <NA> ## 756:              <NA>                      X - 19438          <NA> ## 757:              <NA>                      X - 19451          <NA> ## 758:              <NA>                      X - 19574          <NA> ##                                           SUB_PATHWAY COMP_ID  PLATFORM ##   1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg ##   2:                                   Diacylglycerol   11953     GC/MS ##   3:                                    Ketone bodies   38002     GC/MS ##   4:                              Xanthine metabolism   34404 LC/MS Neg ##   5: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS ##  ---                                                                    ## 754:                                             <NA>   42912 LC/MS Neg ## 755:                                             <NA>   42913 LC/MS Neg ## 756:                                             <NA>   42914 LC/MS Neg ## 757:                                             <NA>   42927 LC/MS Neg ## 758:                                             <NA>   43130 LC/MS Neg ##                      RI               MASS PUBCHEM                 CAS   KEGG ##   1:               3578              243.2   10458           505-52-2;   <NA> ##   2:               2600                145   99931         40290-32-2;   <NA> ##   3:               1041                117    <NA>            57-55-6; C00583 ##   4:               1988              209.1   79437          5415-44-1; C16361 ##   5:               1263                103     670 96-26-4;62147-49-3; C00184 ##  ---                                                                          ## 754:               4747              467.4    <NA>                <NA>   <NA> ## 755: 1150.0999999999999              397.1    <NA>                <NA>   <NA> ## 756:             1222.3              217.1    <NA>                <NA>   <NA> ## 757:             3728.5              239.1    <NA>                <NA>   <NA> ## 758:             4045.7 307.10000000000002    <NA>                <NA>   <NA> ##        HMDb_ID COMP_IDstr featureID ##   1: HMDB02327     M43027    M43027 ##   2: HMDB07098     M11953    M11953 ##   3: HMDB01881     M38002    M38002 ##   4: HMDB02123     M34404    M34404 ##   5: HMDB01882     M35963    M35963 ##  ---                                ## 754:      <NA>     M42912    M42912 ## 755:      <NA>     M42913    M42913 ## 756:      <NA>     M42914    M42914 ## 757:      <NA>     M42927    M42927 ## 758:      <NA>     M43130    M43130 ##  ## ***  @sampleData (ID:  sampleID ) *** ##       sampleID      AGE GENDER      BMI ETHNICITY T2D ##   1: QMDiab222 34.50513      0 25.01021         2   0 ##   2: QMDiab113 47.06639      1 28.36776         3   0 ##   3:  QMDiab29 55.49076      1 29.70564         1   0 ##   4: QMDiab243 56.33402      1 23.14050         2   0 ##   5: QMDiab270 35.63039      1 30.06229         1   0 ##  ---                                                  ## 352: QMDiab352 41.55510      1 31.22690         3   1 ## 353: QMDiab135 52.55305      0 29.07577         2   1 ## 354: QMDiab229 30.31348      0 22.22656         2   0 ## 355: QMDiab202 49.40999      1 33.72008         1   1 ## 356: QMDiab103 23.85489      0 35.96389         1   0 ##  ## ***  @miscData  *** ## integer(0) ##  ## ***  @logs  *** ## 09/03/22 21:46:20: Import data from: /private/var/folders/mj/lsf2tqcx13d5tgl627mm9fxm0000gn/T/RtmphZ45UH/temp_libpathc1cb175427a5/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . ## 09/03/22 21:46:20: Initiate data: 356 samples and 758 features. ## 09/03/22 21:46:20: Update data, action: change_featureID, 356 samples and 758 features.  ##  ## 09/03/22 21:46:22: Run QC pipeline. ## 09/03/22 21:46:22: Filter data with a constant column, removed 37 features.  ## 09/03/22 21:46:22: Update data, 356 samples and 758 features.  ## 09/03/22 21:46:22: Filter data with a missing rate >= 0.5, removed 176 features.  ## 09/03/22 21:46:22: Update data, 356 samples and 758 features.  ## 09/03/22 21:46:22: Replace outliers using `winsorize` method 5 SDs.  ## 09/03/22 21:46:23: Impute data using `half-min` method.  ## 09/03/22 21:46:23: Transformation using `log` method.  ## 09/03/22 21:46:24: Transformation using `scale` method."},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"boxplot-before-transformation","dir":"Articles","previous_headings":"Visualization","what":"Boxplot: before transformation","title":"An introduction to the metabolomicsR","text":"","code":"# if no features were selected, randomly show 16 metabolites plot_Metabolite(df_plasma_QC, plot = \"boxplot\", x = \"T2D\", color =\"ETHNICITY\", shape = \"T2D\") # select three metabolites plot_Metabolite(df_plasma_QC, x = \"T2D\", plot = \"boxplot\", feature_name = c(\"M43027\",  \"M11953\", \"M38002\"))"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"visualization-comparisons-between-groups","dir":"Articles","previous_headings":"Visualization","what":"Visualization: comparisons between groups","title":"An introduction to the metabolomicsR","text":"","code":"# comparisons between groups using `ggbetweenstats` plot_Metabolite(df_plasma_QC, x = \"T2D\", plot = \"betweenstats\",  feature_name = c(\"M43027\",  \"M11953\"))"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"boxplot-after-transformation","dir":"Articles","previous_headings":"Visualization","what":"Boxplot after transformation","title":"An introduction to the metabolomicsR","text":"","code":"plot_Metabolite(df_plasma_scale, plot = \"boxplot\", x = \"T2D\", color =\"ETHNICITY\", shape = \"T2D\")"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"visualization-histogram","dir":"Articles","previous_headings":"Visualization","what":"Visualization: histogram","title":"An introduction to the metabolomicsR","text":"","code":"plot_Metabolite(df_plasma_scale, plot = \"histogram\", color = \"T2D\") plot_Metabolite(df_plasma_scale, plot = \"histogram\", color = \"ETHNICITY\")"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"normalization","dir":"Articles","previous_headings":"","what":"Normalization","title":"An introduction to the metabolomicsR","text":"Normalization metabolomic data important step remove systematic variation, facilitate identification real biological metabolites. provided several commonly used normalization method, including batch-based normalization, QC sample-based/nearest QC sample-based normalization, LOESS normalization. latter three methods used measurements internal QC samples available. selected first 16 metabolites show boxplot","code":"# Take the urine data for example, the batch of the samples are missing. To illustrate the usage of the normalization method data, we assume that 120 samples in each batch.  unique(featureData(df_urine_QC)$PLATFORM) ## [1] \"GC/MS\"     \"LC/MS Neg\" \"LC/MS Pos\" # add new columns by reference (column name uppercase) sampleData(df_urine_QC)[, `GC/MS` := rep(1:3, each = 120)[1:359]] sampleData(df_urine_QC)[, `LC/MS NEG` := rep(1:3, each = 120)[1:359]] sampleData(df_urine_QC)[, `LC/MS POS` := rep(1:3, each = 120)[1:359]]  # we also added a injection order column (in the current order) df_urine_QC <- update_Metabolite(df_urine_QC, sampleData(df_urine_QC)[, 1], action = \"injection_order\") ## Creat a new column `ID_injection_order`. # and set one as QC samples for each 10 samples.   sampleData(df_urine_QC)[, QCsample := ifelse(1:359%%10 == 0, 1, 0)] sampleData(df_urine_QC)[, QCsample := factor(QCsample, levels = c(1, 0))]                         sampleData(df_urine_QC)[, sampleID := ifelse(1:359 %% 10 == 0, paste0(\"MTRX-\", sampleID), sampleID)]  table(sampleData(df_urine_QC)$QCsample) ##  ##   1   0  ##  35 324 assayData(df_urine_QC)$sampleID <- sampleData(df_urine_QC)$sampleID # also change the ID in assayData df_urine_QC ## An object of  Metabolite  ##  ## ***  @assayData (first and last 10 columns [ 359  *  787 ])  *** ##       sampleID   M38002 M34404  M32391 M20675   M21049  M34400 M40506  M34455 ##   1: QMDiab254  1189337 146900  265120  53499 15379982  619745  53261  227263 ##   2: QMDiab290  9944836 716781 2042008  71989 26406420 1988553 123129 1221563 ##   3:  QMDiab54   926350 182438  775726  48752  7551248 1159521  72837  215868 ##   4:  QMDiab55   305459 579097  511122  21423  4655848 1102500 131674      NA ##   5: QMDiab319   574761 295176  175826  91788  2762680  417870  21631  243512 ##  ---                                                                          ## 355:  QMDiab70  1139559 117975  326903     NA 10051449  406266 234997  183234 ## 356: QMDiab118  1517228 234288      NA  24350  2613189  375914  51929      NA ## 357:  QMDiab65  1028291 352068  609710 113673 29650920  621166 130037  549992 ## 358: QMDiab248  1807105 338741  148964  62614   937893  603113  48151  293379 ## 359:   QMDiab4 10103832 203176  245175  50822 28406416  243598  74996  696766 ##        M30460 M41595 M41702 M41709 M41768 M41837 M42272 M42314 M42335 M42352 ##   1:  5502123  74988  29007   4223  17008   5636  96913  31056  33430  35558 ##   2: 17475172  66278 101935  34251  14937   9552 124745  66036  39595 652059 ##   3:  6423459  74225  51295  14090  32971   9104  44266  23363  39645  62630 ##   4:  4246983  63809  31054   6151   8054  15148  77365  40193  46686  92981 ##   5:  2780633  40804   8307   3715  31370   5993  24081  16319  25583  31037 ##  ---                                                                         ## 355:  1407294  67664  36157     NA  29194  15652  54919  52317  78413  38453 ## 356:  1856043  34332  29877  30817   5029   4603  42309  17973  25751  12967 ## 357: 10131966  57310  22374     NA  19358   9598 110335  40228  34299 108341 ## 358:       NA  26670   8525   7059  13231   9698  36055  29644  22465  19287 ## 359: 27087992  95140  66285  20229  35845  18570 185546  45205  60944 149210 ##      M42856 M42913 ##   1:  23369  21931 ##   2:  28220  27811 ##   3:  13148  25018 ##   4:  22845  23620 ##   5:  29122  41337 ##  ---               ## 355:  33084 195136 ## 356:  15268  31577 ## 357:  52714  33244 ## 358:  27299  36462 ## 359:  35991 186372 ##  ## ***  @featureData (ID:  featureID ) *** ##      PATHWAY_SORTORDER                  BIOCHEMICAL SUPER_PATHWAY ##   1:               986              1,2-propanediol         Lipid ##   2:              1805         1,3,7-trimethylurate   Xenobiotics ##   3:              1802            1,3-dimethylurate   Xenobiotics ##   4:               583 1,5-anhydroglucitol (1,5-AG)  Carbohydrate ##   5:               591           1,6-anhydroglucose  Carbohydrate ##  ---                                                              ## 887:              <NA>                    X - 19380          <NA> ## 888:              <NA>                    X - 19437          <NA> ## 889:              <NA>                    X - 19556          <NA> ## 890:              <NA>                    X - 19573          <NA> ## 891:              <NA>                    X - 19574          <NA> ##                                           SUB_PATHWAY COMP_ID  PLATFORM ##   1:                                    Ketone bodies   38002     GC/MS ##   2:                              Xanthine metabolism   34404 LC/MS Neg ##   3:                              Xanthine metabolism   32391     GC/MS ##   4: Glycolysis, gluconeogenesis, pyruvate metabolism   20675 LC/MS Neg ##   5: Glycolysis, gluconeogenesis, pyruvate metabolism   21049     GC/MS ##  ---                                                                    ## 887:                                             <NA>   42856 LC/MS Neg ## 888:                                             <NA>   42913 LC/MS Neg ## 889:                                             <NA>   43112 LC/MS Pos ## 890:                                             <NA>   43129 LC/MS Neg ## 891:                                             <NA>   43130 LC/MS Neg ##                      RI               MASS  PUBCHEM        CAS   KEGG   HMDb_ID ##   1:               1041                117     <NA>   57-55-6; C00583 HMDB01881 ##   2:               1988              209.1    79437 5415-44-1; C16361 HMDB02123 ##   3:               1937 325.10000000000002    70346 944-73-0 ;   <NA> HMDB01857 ##   4:                808 163.19999999999999     <NA>  154-58-5; C07326 HMDB02712 ##   5:             1679.5              204.1 11412545  498-07-7;   <NA> HMDB00640 ##  ---                                                                            ## 887:               2287              412.4     <NA>       <NA>   <NA>      <NA> ## 888: 1150.0999999999999              397.1     <NA>       <NA>   <NA>      <NA> ## 889: 4249.8999999999996              404.9     <NA>       <NA>   <NA>      <NA> ## 890:             3906.5              403.2     <NA>       <NA>   <NA>      <NA> ## 891:             4045.7 307.10000000000002     <NA>       <NA>   <NA>      <NA> ##      COMP_IDstr featureID ##   1:     M38002    M38002 ##   2:     M34404    M34404 ##   3:     M32391    M32391 ##   4:     M20675    M20675 ##   5:     M21049    M21049 ##  ---                      ## 887:     M42856    M42856 ## 888:     M42913    M42913 ## 889:     M43112    M43112 ## 890:     M43129    M43129 ## 891:     M43130    M43130 ##  ## ***  @sampleData (ID:  sampleID ) *** ##       sampleID      AGE GENDER      BMI ETHNICITY T2D GC/MS LC/MS NEG LC/MS POS ##   1: QMDiab254 53.10335      0 32.05128         1   0     1         1         1 ##   2: QMDiab290 39.79192      1 30.51426         4   0     1         1         1 ##   3:  QMDiab54 36.82136      0 24.16831         1   0     1         1         1 ##   4:  QMDiab55 34.75975      0 44.44444         1   1     1         1         1 ##   5: QMDiab319 50.17933      1 27.18090         1   1     1         1         1 ##  ---                                                                            ## 355:  QMDiab70 35.40315      1 33.83403         1   1     3         3         3 ## 356: QMDiab118 49.06229      1 25.64494         1   0     3         3         3 ## 357:  QMDiab65 47.22245      1 23.38435         1   0     3         3         3 ## 358: QMDiab248 56.39151      0 27.58621         1   1     3         3         3 ## 359:   QMDiab4 24.22450      0 41.66521         1   0     3         3         3 ##      ID_injection_order QCsample ##   1:                  1        0 ##   2:                  2        0 ##   3:                  3        0 ##   4:                  4        0 ##   5:                  5        0 ##  ---                             ## 355:                355        0 ## 356:                356        0 ## 357:                357        0 ## 358:                358        0 ## 359:                359        0 ##  ## ***  @miscData  *** ## integer(0) ##  ## ***  @logs  *** ## 09/03/22 21:46:21: Import data from: /private/var/folders/mj/lsf2tqcx13d5tgl627mm9fxm0000gn/T/RtmphZ45UH/temp_libpathc1cb175427a5/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . ## 09/03/22 21:46:21: Initiate data: 359 samples and 891 features. ## 09/03/22 21:46:21: Update data, action: change_featureID, 359 samples and 891 features.  ##  ## 09/03/22 21:46:22: Run QC pipeline. ## 09/03/22 21:46:22: Filter data with a constant column, removed 28 features.  ## 09/03/22 21:46:22: Update data, 359 samples and 891 features.  ## 09/03/22 21:46:23: Filter data with a missing rate >= 0.5, removed 77 features.  ## 09/03/22 21:46:23: Update data, 359 samples and 891 features.  ## 09/03/22 21:46:23: Replace outliers using `winsorize` method 5 SDs.  ## 09/03/22 21:46:41: Update data, action: injection_order, 359 samples and 891 features.  ## 09/03/22 21:46:41: Update data, 359 samples and 891 features. v_features <- featureData(df_urine_QC)$featureID[1:16]  plot_injection_order(df_urine_QC, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features)"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"normalization-1-batch-norm","dir":"Articles","previous_headings":"Normalization","what":"Normalization 1: batch-norm","title":"An introduction to the metabolomicsR","text":"Normalization 2: QCmatrix_norm  Normalization 3: nearestQC_norm  Normalization 4: modelling_norm","code":"df_urine_QC_norm <- batch_norm(df_urine_QC) ##  ## Platform information in @featureData: ## platforms ##     GC/MS LC/MS Neg LC/MS Pos  ##       154       417       320  ##  ##  ## Sample size in platform GC/MS ##   1   2   3  ## 120 120 119 p1 <- plot_injection_order(df_urine_QC_norm, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p1 df_urine_QC_norm <- QCmatrix_norm(df_urine_QC) ##  ## Platform information in @featureData: ## platforms ##     GC/MS LC/MS Neg LC/MS Pos  ##       154       417       320  ##  ##  ## Sample size in platform GC/MS ##   1   2   3  ## 120 120 119  ##  ##  ##  Number of QC samples n = 35 p2 <- plot_injection_order(df_urine_QC_norm, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p2 df_urine_QC_norm <- nearestQC_norm(df_urine_QC) ##  ## The top ten sample ID (in injection order): ## QMDiab254, QMDiab290, QMDiab54, QMDiab55, QMDiab319, QMDiab255, QMDiab190, QMDiab247, QMDiab209, MTRX-QMDiab94  ##  ## Platform information in @featureData: ## platforms ##     GC/MS LC/MS Neg LC/MS Pos  ##       154       417       320  ##  ##  ## Sample size in platform GC/MS ##   1   2   3  ## 120 120 119  ##  ##  ##  Number of QC samples n = 35 p3 <- plot_injection_order(df_urine_QC_norm, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p3 df_urine_QC_norm_LOESS <- modelling_norm(df_urine_QC, method = \"LOESS\") ##  ## Platform information in @featureData: ## platforms ##     GC/MS LC/MS Neg LC/MS Pos  ##       154       417       320  ##  ##  ## Sample size in platform GC/MS ##   1   2   3  ## 120 120 119  ##  ##  ##  Number of QC samples n = 35 p4 <- plot_injection_order(df_urine_QC_norm, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p4 # to benchmark the performance df_urine_QC_norm_KNN <- modelling_norm(df_urine_QC, method = \"KNN\", k = 3) ##  ## Platform information in @featureData: ## platforms ##     GC/MS LC/MS Neg LC/MS Pos  ##       154       417       320  ##  ##  ## Sample size in platform GC/MS ##   1   2   3  ## 120 120 119  ##  ##  ##  Number of QC samples n = 35 p5 <- plot_injection_order(df_urine_QC_norm_KNN, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p5"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"dimensional-reduction","dir":"Articles","previous_headings":"","what":"Dimensional reduction","title":"An introduction to the metabolomicsR","text":"Dimensional reduction strategies metabolites data can used detect batch effects, sample outliers, real biological subgroups. included principal components analysis (PCA), manifold approximation projection (UMAP), t-distributed stochastic neighbor embedding (tSNE) methods. Figures displayed ggplot2 style.","code":"df_plasma_PCA <- run_PCA(df_plasma_QC)  plot_PCA(df_plasma_PCA, color =\"ETHNICITY\", shape = \"T2D\") plot_UMAP(df_plasma_QC, color =\"ETHNICITY\", shape = \"T2D\") plot_tsne(df_plasma_QC, color =\"ETHNICITY\", shape = \"T2D\")"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"correlation","dir":"Articles","previous_headings":"","what":"Correlation","title":"An introduction to the metabolomicsR","text":"","code":"# pairwise correlation of metabolites between two different fluids  # plasma vs urine dd <- correlation(df_plasma_QC, df_urine_QC, method = \"spearman\") ## Identify  356  samples in data A, and  359  samples in data B, with  312  overlap samples. ## Identify  545  features in data A, and  786  features in data B, with  248  overlap features. dd <- merge(dd, featureData(df_plasma_QC), by.x = \"term\", by.y = \"featureID\")  p <- ggplot(dd, aes(x = SUPER_PATHWAY, y = r, fill = SUPER_PATHWAY)) +   geom_boxplot() +   geom_jitter( size=0.4, alpha=0.9) +   scale_fill_manual(values = RColorBrewer::brewer.pal(9, \"Set1\")) +   theme(axis.text.x = element_text(angle = 60, hjust = 1))+   labs(title = \"plasma vs urine\")  p # plasma vs saliva dd <- correlation(df_plasma_QC, df_saliva_QC, method = \"spearman\") ## Identify  356  samples in data A, and  321  samples in data B, with  319  overlap samples. ## Identify  545  features in data A, and  364  features in data B, with  137  overlap features. dd <- merge(dd, featureData(df_plasma_QC), by.x = \"term\", by.y = \"featureID\")  p2 <- ggplot(dd, aes(x = SUPER_PATHWAY, y = r, fill = SUPER_PATHWAY)) +   geom_boxplot() +   geom_jitter(size=0.4, alpha=0.9) +   scale_fill_manual(values = RColorBrewer::brewer.pal(9, \"Set1\")) +   theme(axis.text.x = element_text(angle = 60, hjust = 1)) +   labs(title = \"plasma vs saliva\")   # urine vs saliva dd <- correlation(df_urine_QC, df_saliva_QC, method = \"spearman\") ## Identify  359  samples in data A, and  321  samples in data B, with  282  overlap samples. ## Identify  786  features in data A, and  364  features in data B, with  155  overlap features. dd <- merge(dd, featureData(df_urine_QC), by.x = \"term\", by.y = \"featureID\")  p3 <- ggplot(dd, aes(x = SUPER_PATHWAY, y = r, fill = SUPER_PATHWAY)) +   geom_boxplot() +   geom_jitter(size=0.4, alpha=0.9) +    scale_fill_manual(values = RColorBrewer::brewer.pal(9, \"Set1\")) +   theme(axis.text.x = element_text(angle = 60, hjust = 1)) +   labs(title = \"urine vs saliva\")   p <- cowplot::plot_grid(p2, p3, nrow = 1) p"},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"association-analysis-1-linear-regression","dir":"Articles","previous_headings":"Association analysis","what":"Association analysis 1: linear regression","title":"An introduction to the metabolomicsR","text":"Association analysis metabolites interested outcomes implemented “regression” function, supporting general linear regression, logistic regression, poisson regression, proportional hazards regression model, linear mixed-effects model, logistic linear mixed-effects model, without covariates. regression models can run selected metabolites metabolites single job support parallel computing.","code":"fit_lm <- regression(object = df_plasma_scale, phenoData = NULL, model = \"lm\", outcome = \"BMI\",                           covars = c(\"AGE\", \"GENDER\", \"ETHNICITY\"), factors = \"ETHNICITY\") ## Regression for 1 outcome(s).  ##  ## Build formula using covars and outcomes.  ##  ## Run `lm` model for 545 features:  ## BMI ~ AGE + GENDER + ETHNICITY + `feature` head(fit_lm) ##      term     estimate std.error   statistic   p.value   n outcome model ## 1: M43027 -0.287065678 0.2909369 -0.98669400 0.3244762 356     BMI    lm ## 2: M11953  0.285148910 0.2945365  0.96812761 0.3336511 356     BMI    lm ## 3: M38002  0.063510129 0.2960686  0.21451153 0.8302735 356     BMI    lm ## 4: M34404  0.459471416 0.3109698  1.47754337 0.1404319 356     BMI    lm ## 5: M35963 -0.008355339 0.2942752 -0.02839294 0.9773650 356     BMI    lm ## 6: M35728  0.280617622 0.2929012  0.95806251 0.3386944 356     BMI    lm ##    p.value.adj ## 1:           1 ## 2:           1 ## 3:           1 ## 4:           1 ## 5:           1 ## 6:           1 dd <- merge(fit_lm, featureData(df_plasma_scale), by.x = \"term\", by.y = \"featureID\")  dd[, sig := ifelse(p.value.adj < 0.1, 1, 0)] plot_volcano(dd, color = NULL, label = \"BIOCHEMICAL\")"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"association-analysis-2-logistic-regression","dir":"Articles","previous_headings":"Association analysis","what":"Association analysis 2: logistic regression","title":"An introduction to the metabolomicsR","text":"","code":"fit_glm <- regression(object = df_plasma_scale, phenoData = NULL, model = \"logistic\", outcome = \"T2D\",                          covars = c(\"AGE\",\"GENDER\", \"ETHNICITY\"), factors = \"ETHNICITY\") ## Regression for 1 outcome(s).  ##  ## Build formula using covars and outcomes.  ##  ## Run `logistic` model for 545 features:  ## T2D ~ AGE + GENDER + ETHNICITY + `feature` head(fit_glm) ##      term    estimate std.error   statistic    p.value   n outcome    model ## 1: M43027 -0.01513772 0.1249949 -0.12110676 0.90360647 356     T2D logistic ## 2: M11953  0.07313020 0.1258779  0.58096115 0.56126664 356     T2D logistic ## 3: M38002  0.01273692 0.1286644  0.09899333 0.92114357 356     T2D logistic ## 4: M34404  0.02452545 0.1413296  0.17353372 0.86223193 356     T2D logistic ## 5: M35963  0.35664968 0.1338055  2.66543322 0.00768892 356     T2D logistic ## 6: M35728  0.01557804 0.1306566  0.11922888 0.90509402 356     T2D logistic ##    p.value.adj ## 1:           1 ## 2:           1 ## 3:           1 ## 4:           1 ## 5:           1 ## 6:           1 dd <- merge(fit_glm, featureData(df_plasma_scale), by.x = \"term\", by.y = \"featureID\")  dd[, sig := ifelse(p.value.adj < 0.1, 1, 0)]  plot_volcano(dd, label = \"BIOCHEMICAL\")"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"association-analysis-3-multiple-outcomes-using-model-auto","dir":"Articles","previous_headings":"Association analysis","what":"Association analysis 3: multiple outcomes, using model = “auto”","title":"An introduction to the metabolomicsR","text":"","code":"fit2 <- regression(object = df_plasma_scale, phenoData = NULL, model = \"auto\", outcome = c(\"BMI\", \"T2D\"),                          covars = c(\"AGE\",\"GENDER\", \"ETHNICITY\"), factors = \"ETHNICITY\") ## Regression for 2 outcome(s).  ##  ## Build formula using covars and outcomes.  ## model = `auto`, to infer `lm` or `logistic`  ##  ## Run `lm` model for 545 features:  ## BMI ~ AGE + GENDER + ETHNICITY + `feature`  ## Build formula using covars and outcomes.  ## model = `auto`, to infer `lm` or `logistic`  ##  ## Run `logistic` model for 545 features:  ## T2D ~ AGE + GENDER + ETHNICITY + `feature` head(fit2) ##      term     estimate std.error   statistic   p.value   n outcome model ## 1: M43027 -0.287065678 0.2909369 -0.98669400 0.3244762 356     BMI    lm ## 2: M11953  0.285148910 0.2945365  0.96812761 0.3336511 356     BMI    lm ## 3: M38002  0.063510129 0.2960686  0.21451153 0.8302735 356     BMI    lm ## 4: M34404  0.459471416 0.3109698  1.47754337 0.1404319 356     BMI    lm ## 5: M35963 -0.008355339 0.2942752 -0.02839294 0.9773650 356     BMI    lm ## 6: M35728  0.280617622 0.2929012  0.95806251 0.3386944 356     BMI    lm ##    p.value.adj ## 1:           1 ## 2:           1 ## 3:           1 ## 4:           1 ## 5:           1 ## 6:           1 dd2 <- merge(fit2, featureData(df_plasma_scale), by.x = \"term\", by.y = \"featureID\")  dd2[, sig := ifelse(p.value.adj < 0.1, 1, 0)] plot_volcano(dd2, color = \"outcome\", label = \"BIOCHEMICAL\")"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"association-analysis-4-extension-to-other-regression-models","dir":"Articles","previous_headings":"Association analysis","what":"Association analysis 4: extension to other regression models","title":"An introduction to the metabolomicsR","text":"provided various regression models metabolomicsR package. show extend regression function regression models.","code":"# for example, to fit a Negative Binomial Generalized Linear Model, we first define a `fit_glm.nb` function.   library(MASS)  fit_glm.nb <- function(data = NULL, formula = NULL, keep = NULL) {   v_var <- all.vars(formula)   df <- data[, v_var, with = FALSE]   fit <- tryCatch(     do.call(\"glm.nb\", args = list(data = df, formula = formula)),     error = function(e) {       cat(paste0(\"Failed to fit model: \", e), \"\\n\")     })   if(inherits(fit, \"glm\")) {     res  <- as.data.table(broom::tidy(fit))     if(! is.null(keep)) res <- res[res$term %in% keep, ]     res$n <- length(fit$residuals)   } else {     res <- list(estimate = NA)   }   return(res) }  # the outcome 'toy_y' was only created to demonstrate the usage to extend regression models  sampleData(df_plasma_scale)[, toy_y := round(BMI, 0)]  # equivalent to: if(0) {   dd <- sampleData(df_plasma_scale)    dd[, toy_y := round(BMI, 0)]   sampleData(df_plasma_scale)  <- dd }  fit <- regression(object = df_plasma_scale, phenoData = NULL, model = \"glm.nb\", outcome = \"toy_y\",                   covars = c(\"AGE\",\"GENDER\", \"ETHNICITY\"), factors = \"ETHNICITY\",                    feature_name = featureData(df_plasma_scale)$featureID[1:50]) ## Regression for 1 outcome(s).  ##  ## Build formula using covars and outcomes.  ##  ## Run `glm.nb` model for 50 features:  ## toy_y ~ AGE + GENDER + ETHNICITY + `feature` dd <- merge(fit, featureData(df_plasma_scale), by.x = \"term\", by.y = \"featureID\") dd[, sig := ifelse(p.value.adj < 0.1, 1, 0)] plot_volcano(dd, color = NULL, label = \"BIOCHEMICAL\")"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"roc","dir":"Articles","previous_headings":"","what":"ROC","title":"An introduction to the metabolomicsR","text":"","code":"# ROC for one variable, to add a wrapped for many metabolites separately plot_ROC(object = df_plasma_scale, y = \"T2D\", x = \"M00527\") plot_ROC(object = df_plasma_scale, y = \"T2D\", x = c(\"M00527\", \"BMI\"))"},{"path":"https://XikunHan.github.io/metabolomicsR/articles/Introduction.html","id":"roc-compare-two-models","dir":"Articles","previous_headings":"ROC","what":"ROC: compare two models","title":"An introduction to the metabolomicsR","text":"","code":"plot_ROC(object = df_plasma_scale, y = \"T2D\",           model_a = c(\"BMI\", \"AGE\", \"GENDER\"),           model_b = c(\"M00527\", \"BMI\", \"AGE\", \"GENDER\")) sessionInfo() ## R version 4.1.2 (2021-11-01) ## Platform: x86_64-apple-darwin17.0 (64-bit) ## Running under: macOS Big Sur 10.16 ##  ## Matrix products: default ## BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib ## LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib ##  ## locale: ## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] MASS_7.3-55         plotROC_2.2.1       cowplot_1.1.1       ## [4] ggplot2_3.3.5       data.table_1.14.2   metabolomicsR_1.0.0 ## [7] BiocStyle_2.20.2    ##  ## loaded via a namespace (and not attached): ##   [1] Rtsne_0.15             colorspace_2.0-3       ellipsis_0.3.2         ##   [4] rprojroot_2.0.2        corpcor_1.6.10         parameters_0.16.0      ##   [7] fs_1.5.2               mc2d_0.1-21            rstudioapi_0.13        ##  [10] listenv_0.8.0          farver_2.1.0           MatrixModels_0.5-0     ##  [13] ggrepel_0.9.1          RSpectra_0.16-0        fansi_1.0.2            ##  [16] mvtnorm_1.1-3          codetools_0.2-18       doParallel_1.0.17      ##  [19] cachem_1.0.6           knitr_1.37             zeallot_0.1.0          ##  [22] jsonlite_1.8.0         pROC_1.18.0            umap_0.2.7.0           ##  [25] broom_0.7.12           cluster_2.1.2          png_0.1-7              ##  [28] effectsize_0.6.0.1     BiocManager_1.30.16    compiler_4.1.2         ##  [31] backports_1.4.1        assertthat_0.2.1       Matrix_1.4-0           ##  [34] fastmap_1.1.0          cli_3.2.0              htmltools_0.5.2        ##  [37] tools_4.1.2            ggstatsplot_0.9.1      coda_0.19-4            ##  [40] gtable_0.3.0           glue_1.6.2             reshape2_1.4.4         ##  [43] dplyr_1.0.8            Rcpp_1.0.8             cellranger_1.1.0       ##  [46] jquerylib_0.1.4        pkgdown_2.0.2          vctrs_0.3.8            ##  [49] progressr_0.10.0       iterators_1.0.14       insight_0.16.0         ##  [52] xfun_0.30              stringr_1.4.0          globals_0.14.0         ##  [55] lifecycle_1.0.1        gtools_3.9.2           future_1.24.0          ##  [58] scales_1.1.1           BayesFactor_0.9.12-4.3 ragg_1.2.2             ##  [61] doSNOW_1.0.20          M3C_1.14.0             parallel_4.1.2         ##  [64] rematch2_2.1.2         RColorBrewer_1.1-2     prismatic_1.1.0        ##  [67] yaml_2.3.5             memoise_2.0.1          reticulate_1.24        ##  [70] pbapply_1.5-0          sass_0.4.0             reshape_0.8.8          ##  [73] stringi_1.7.6          paletteer_1.4.0        highr_0.9              ##  [76] bayestestR_0.11.5      desc_1.4.1             foreach_1.5.2          ##  [79] boot_1.3-28            rlang_1.0.2            pkgconfig_2.0.3        ##  [82] systemfonts_1.0.4      evaluate_0.15          lattice_0.20-45        ##  [85] purrr_0.3.4            patchwork_1.1.1        labeling_0.4.2         ##  [88] tidyselect_1.1.2       parallelly_1.30.0      plyr_1.8.6             ##  [91] magrittr_2.0.2         bookdown_0.24          R6_2.5.1               ##  [94] snow_0.4-4             generics_0.1.2         DBI_1.1.2              ##  [97] pillar_1.7.0           withr_2.5.0            datawizard_0.3.0       ## [100] tibble_3.1.6           performance_0.8.0      crayon_1.5.0           ## [103] WRS2_1.1-3             utf8_1.2.2             correlation_0.8.0      ## [106] rmarkdown_2.12         grid_4.1.2             readxl_1.3.1           ## [109] FNN_1.1.3              matrixcalc_1.0-5       digest_0.6.29          ## [112] tidyr_1.2.0            textshaping_0.3.6      statsExpressions_1.3.0 ## [115] openssl_2.0.0          munsell_0.5.0          bslib_0.3.1            ## [118] askpass_1.1"},{"path":"https://XikunHan.github.io/metabolomicsR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Xikun Han. Maintainer, author, copyright holder.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Han X (2022). metabolomicsR: Tools metabolomic data. R package version 1.0.0, https://github.com/XikunHan/metabolomicsR.","code":"@Manual{,   title = {metabolomicsR: Tools for metabolomic data},   author = {Xikun Han},   year = {2022},   note = {R package version 1.0.0},   url = {https://github.com/XikunHan/metabolomicsR}, }"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"metabolomicsr-tools-to-process-analyze-and-visualize-metabolomic-data","dir":"","previous_headings":"","what":"{metabolomicsR} Tools to process, analyze, and visualize metabolomic data.","title":"Tools for metabolomic data","text":"metabolomicsR streamlined R package preprocess, analyze, visualize metabolomics data. included broad utility functions sample metabolite quality control, outlier detection, missing value imputation, dimensional reduction, normalization, data integration, regression, metabolite annotation, enrichment analysis, visualization data results. metabolomicsR designed comprehensive R package can easily used researchers basic R programming skills. framework designed versatile extensible various methods. , demonstrate step--step use main functions package.","code":""},{"path":[]},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"data-structure","dir":"","previous_headings":"","what":"Data structure","title":"Tools for metabolomic data","text":"first designed “Metabolite” class based object-oriented programming system S4 R. particular “Metabolite” data, include “assayData” (eg. peak area data batch-normalized data, samples rows metabolites columns), “featureData” (metabolite annotation), “sampleData” (sample annotation), “featureID”, “sampleID”, “logs” (log information data analysis process), “miscData” (ancillary data).","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"import-data","dir":"","previous_headings":"","what":"Import data","title":"Tools for metabolomic data","text":"demonstrate package, obtained data Qatar Metabolomics Study Diabetes, similar data format non-targeted mass spectrometry Metabolon. dataset also available via figshare. “assayData”, first column sample IDs match “sampleData”, columns metabolite IDs match “featureData”.","code":"library(metabolomicsR) library(data.table) library(ggplot2) library(cowplot) library(plotROC)  # Load the dataset  file_path <- system.file(\"extdata\", \"QMDiab_metabolomics_OrigScale.xlsx\", package = \"metabolomicsR\", mustWork = TRUE)  df_plasma <- load_excel(path = file_path,                         data_sheet = 1,                         feature_sheet = 4,                         sample_sheet = 8,                         sampleID = \"QMDiab-ID\",                         featureID = \"BIOCHEMICAL\"                         ) df_plasma #>  An object of  Metabolite  #>   #>  ***  @assayData (first and last 10 columns [ 356  *  759 ])  *** #>        sampleID 1,11-Undecanedicarboxylic acid 1,2-dipalmitoylglycerol #>    1: QMDiab222                           8578                      NA #>    2: QMDiab113                          15145                      NA #>    3:  QMDiab29                             NA                   96455 #>    4: QMDiab243                          19692                   69444 #>    5: QMDiab270                             NA                      NA #>   ---                                                                  #>  352: QMDiab352                           6689                  116932 #>  353: QMDiab135                           7556                  248824 #>  354: QMDiab229                          20252                   80804 #>  355: QMDiab202                           7378                  108152 #>  356: QMDiab103                           6667                   57851 #>       1,2-propanediol 1,3,7-trimethylurate 1,3-dihydroxyacetone #>    1:          103724                22259               104059 #>    2:              NA                39841                   NA #>    3:          159945                10605               165416 #>    4:          108965                38562               139866 #>    5:          157617                 4490                   NA #>   ---                                                           #>  352:          115737                34791               152711 #>  353:          481008                 4766               164853 #>  354:          138253                13949                85019 #>  355:          112229                21748               175918 #>  356:          146948                 8458                82064 #>       1,3-dipalmitoylglycerol 1,5-anhydroglucitol (1,5-AG) 1,7-dimethylurate #>    1:                    7067                       357499             19986 #>    2:                   36542                       440058             16620 #>    3:                   54209                       355790             12220 #>    4:                   22412                       185273             29537 #>    5:                   21958                       692753             10256 #>   ---                                                                        #>  352:                   59120                       178759             25326 #>  353:                  126065                       103647             12253 #>  354:                   43072                       330579             15124 #>  355:                   78154                       106745             21434 #>  356:                   34234                       534697             12979 #>       1-arachidonoylglycerophosphocholine* X - 19183 X - 19299 X - 19302 #>    1:                              2173598        NA        NA        NA #>    2:                              2464846        NA      9033        NA #>    3:                              2613798        NA     10231        NA #>    4:                              2543266        NA        NA     12291 #>    5:                              2138029        NA      6775        NA #>   ---                                                                    #>  352:                               864647        NA        NA        NA #>  353:                              3018611      4769        NA        NA #>  354:                              1398965        NA        NA        NA #>  355:                              2104899        NA        NA        NA #>  356:                               992388        NA        NA        NA #>       X - 19380 X - 19411 X - 19434 X - 19436 X - 19437 X - 19438 X - 19451 #>    1:    158054     88569      7539        NA     64644     18055        NA #>    2:    125669     87268     12681        NA     52074     12805      2994 #>    3:    194732    106360      7787        NA     31782     18467        NA #>    4:    152853    119643        NA        NA     67713     12356        NA #>    5:    204978    149644        NA        NA    108660     12479        NA #>   ---                                                                       #>  352:    195331    134564        NA        NA     22141     17205        NA #>  353:    136120     75431     10876        NA     61867     28223        NA #>  354:    216380    128925        NA        NA     84299     14936        NA #>  355:    162256    112923        NA        NA     42586     51588        NA #>  356:    137705    112636        NA        NA     89283     23515     10619 #>       X - 19574 #>    1:        NA #>    2:        NA #>    3:        NA #>    4:        NA #>    5:        NA #>   ---           #>  352:        NA #>  353:     16573 #>  354:        NA #>  355:        NA #>  356:        NA #>   #>  ***  @featureData (ID:  featureID ) *** #>       PATHWAY_SORTORDER                    BIOCHEMICAL SUPER_PATHWAY #>    1:             800.1 1,11-Undecanedicarboxylic acid         Lipid #>    2:              1070        1,2-dipalmitoylglycerol         Lipid #>    3:               986                1,2-propanediol         Lipid #>    4:              1805           1,3,7-trimethylurate   Xenobiotics #>    5:               600           1,3-dihydroxyacetone  Carbohydrate #>   ---                                                                #>  754:              <NA>                      X - 19436          <NA> #>  755:              <NA>                      X - 19437          <NA> #>  756:              <NA>                      X - 19438          <NA> #>  757:              <NA>                      X - 19451          <NA> #>  758:              <NA>                      X - 19574          <NA> #>                                            SUB_PATHWAY COMP_ID  PLATFORM #>    1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg #>    2:                                   Diacylglycerol   11953     GC/MS #>    3:                                    Ketone bodies   38002     GC/MS #>    4:                              Xanthine metabolism   34404 LC/MS Neg #>    5: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS #>   ---                                                                    #>  754:                                             <NA>   42912 LC/MS Neg #>  755:                                             <NA>   42913 LC/MS Neg #>  756:                                             <NA>   42914 LC/MS Neg #>  757:                                             <NA>   42927 LC/MS Neg #>  758:                                             <NA>   43130 LC/MS Neg #>                       RI               MASS PUBCHEM                 CAS   KEGG #>    1:               3578              243.2   10458           505-52-2;   <NA> #>    2:               2600                145   99931         40290-32-2;   <NA> #>    3:               1041                117    <NA>            57-55-6; C00583 #>    4:               1988              209.1   79437          5415-44-1; C16361 #>    5:               1263                103     670 96-26-4;62147-49-3; C00184 #>   ---                                                                          #>  754:               4747              467.4    <NA>                <NA>   <NA> #>  755: 1150.0999999999999              397.1    <NA>                <NA>   <NA> #>  756:             1222.3              217.1    <NA>                <NA>   <NA> #>  757:             3728.5              239.1    <NA>                <NA>   <NA> #>  758:             4045.7 307.10000000000002    <NA>                <NA>   <NA> #>         HMDb_ID COMP_IDstr                      featureID #>    1: HMDB02327     M43027 1,11-Undecanedicarboxylic acid #>    2: HMDB07098     M11953        1,2-dipalmitoylglycerol #>    3: HMDB01881     M38002                1,2-propanediol #>    4: HMDB02123     M34404           1,3,7-trimethylurate #>    5: HMDB01882     M35963           1,3-dihydroxyacetone #>   ---                                                     #>  754:      <NA>     M42912                      X - 19436 #>  755:      <NA>     M42913                      X - 19437 #>  756:      <NA>     M42914                      X - 19438 #>  757:      <NA>     M42927                      X - 19451 #>  758:      <NA>     M43130                      X - 19574 #>   #>  ***  @sampleData (ID:  sampleID ) *** #>        sampleID      AGE GENDER      BMI ETHNICITY T2D #>    1: QMDiab222 34.50513      0 25.01021         2   0 #>    2: QMDiab113 47.06639      1 28.36776         3   0 #>    3:  QMDiab29 55.49076      1 29.70564         1   0 #>    4: QMDiab243 56.33402      1 23.14050         2   0 #>    5: QMDiab270 35.63039      1 30.06229         1   0 #>   ---                                                  #>  352: QMDiab352 41.55510      1 31.22690         3   1 #>  353: QMDiab135 52.55305      0 29.07577         2   1 #>  354: QMDiab229 30.31348      0 22.22656         2   0 #>  355: QMDiab202 49.40999      1 33.72008         1   1 #>  356: QMDiab103 23.85489      0 35.96389         1   0 #>   #>  ***  @miscData  *** #>  integer(0) #>   #>  ***  @logs  *** #>  09/03/22 21:41:31: Import data from: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . #>  09/03/22 21:41:31: Initiate data: 356 samples and 758 features. # change the feature ID to the column `COMP_IDstr` df_plasma <- update_Metabolite(df_plasma, dataset = \"COMP_IDstr\", action = \"change_featureID\") df_plasma #>  An object of  Metabolite  #>   #>  ***  @assayData (first and last 10 columns [ 356  *  759 ])  *** #>        sampleID M43027 M11953 M38002 M34404 M35963 M35728 M20675 M34400  M33228 #>    1: QMDiab222   8578     NA 103724  22259 104059   7067 357499  19986 2173598 #>    2: QMDiab113  15145     NA     NA  39841     NA  36542 440058  16620 2464846 #>    3:  QMDiab29     NA  96455 159945  10605 165416  54209 355790  12220 2613798 #>    4: QMDiab243  19692  69444 108965  38562 139866  22412 185273  29537 2543266 #>    5: QMDiab270     NA     NA 157617   4490     NA  21958 692753  10256 2138029 #>   ---                                                                           #>  352: QMDiab352   6689 116932 115737  34791 152711  59120 178759  25326  864647 #>  353: QMDiab135   7556 248824 481008   4766 164853 126065 103647  12253 3018611 #>  354: QMDiab229  20252  80804 138253  13949  85019  43072 330579  15124 1398965 #>  355: QMDiab202   7378 108152 112229  21748 175918  78154 106745  21434 2104899 #>  356: QMDiab103   6667  57851 146948   8458  82064  34234 534697  12979  992388 #>       M42659 M42775 M42778 M42856 M42887 M42910 M42912 M42913 M42914 M42927 #>    1:     NA     NA     NA 158054  88569   7539     NA  64644  18055     NA #>    2:     NA   9033     NA 125669  87268  12681     NA  52074  12805   2994 #>    3:     NA  10231     NA 194732 106360   7787     NA  31782  18467     NA #>    4:     NA     NA  12291 152853 119643     NA     NA  67713  12356     NA #>    5:     NA   6775     NA 204978 149644     NA     NA 108660  12479     NA #>   ---                                                                       #>  352:     NA     NA     NA 195331 134564     NA     NA  22141  17205     NA #>  353:   4769     NA     NA 136120  75431  10876     NA  61867  28223     NA #>  354:     NA     NA     NA 216380 128925     NA     NA  84299  14936     NA #>  355:     NA     NA     NA 162256 112923     NA     NA  42586  51588     NA #>  356:     NA     NA     NA 137705 112636     NA     NA  89283  23515  10619 #>       M43130 #>    1:     NA #>    2:     NA #>    3:     NA #>    4:     NA #>    5:     NA #>   ---        #>  352:     NA #>  353:  16573 #>  354:     NA #>  355:     NA #>  356:     NA #>   #>  ***  @featureData (ID:  featureID ) *** #>       PATHWAY_SORTORDER                    BIOCHEMICAL SUPER_PATHWAY #>    1:             800.1 1,11-Undecanedicarboxylic acid         Lipid #>    2:              1070        1,2-dipalmitoylglycerol         Lipid #>    3:               986                1,2-propanediol         Lipid #>    4:              1805           1,3,7-trimethylurate   Xenobiotics #>    5:               600           1,3-dihydroxyacetone  Carbohydrate #>   ---                                                                #>  754:              <NA>                      X - 19436          <NA> #>  755:              <NA>                      X - 19437          <NA> #>  756:              <NA>                      X - 19438          <NA> #>  757:              <NA>                      X - 19451          <NA> #>  758:              <NA>                      X - 19574          <NA> #>                                            SUB_PATHWAY COMP_ID  PLATFORM #>    1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg #>    2:                                   Diacylglycerol   11953     GC/MS #>    3:                                    Ketone bodies   38002     GC/MS #>    4:                              Xanthine metabolism   34404 LC/MS Neg #>    5: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS #>   ---                                                                    #>  754:                                             <NA>   42912 LC/MS Neg #>  755:                                             <NA>   42913 LC/MS Neg #>  756:                                             <NA>   42914 LC/MS Neg #>  757:                                             <NA>   42927 LC/MS Neg #>  758:                                             <NA>   43130 LC/MS Neg #>                       RI               MASS PUBCHEM                 CAS   KEGG #>    1:               3578              243.2   10458           505-52-2;   <NA> #>    2:               2600                145   99931         40290-32-2;   <NA> #>    3:               1041                117    <NA>            57-55-6; C00583 #>    4:               1988              209.1   79437          5415-44-1; C16361 #>    5:               1263                103     670 96-26-4;62147-49-3; C00184 #>   ---                                                                          #>  754:               4747              467.4    <NA>                <NA>   <NA> #>  755: 1150.0999999999999              397.1    <NA>                <NA>   <NA> #>  756:             1222.3              217.1    <NA>                <NA>   <NA> #>  757:             3728.5              239.1    <NA>                <NA>   <NA> #>  758:             4045.7 307.10000000000002    <NA>                <NA>   <NA> #>         HMDb_ID COMP_IDstr featureID #>    1: HMDB02327     M43027    M43027 #>    2: HMDB07098     M11953    M11953 #>    3: HMDB01881     M38002    M38002 #>    4: HMDB02123     M34404    M34404 #>    5: HMDB01882     M35963    M35963 #>   ---                                #>  754:      <NA>     M42912    M42912 #>  755:      <NA>     M42913    M42913 #>  756:      <NA>     M42914    M42914 #>  757:      <NA>     M42927    M42927 #>  758:      <NA>     M43130    M43130 #>   #>  ***  @sampleData (ID:  sampleID ) *** #>        sampleID      AGE GENDER      BMI ETHNICITY T2D #>    1: QMDiab222 34.50513      0 25.01021         2   0 #>    2: QMDiab113 47.06639      1 28.36776         3   0 #>    3:  QMDiab29 55.49076      1 29.70564         1   0 #>    4: QMDiab243 56.33402      1 23.14050         2   0 #>    5: QMDiab270 35.63039      1 30.06229         1   0 #>   ---                                                  #>  352: QMDiab352 41.55510      1 31.22690         3   1 #>  353: QMDiab135 52.55305      0 29.07577         2   1 #>  354: QMDiab229 30.31348      0 22.22656         2   0 #>  355: QMDiab202 49.40999      1 33.72008         1   1 #>  356: QMDiab103 23.85489      0 35.96389         1   0 #>   #>  ***  @miscData  *** #>  integer(0) #>   #>  ***  @logs  *** #>  09/03/22 21:41:31: Import data from: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . #>  09/03/22 21:41:31: Initiate data: 356 samples and 758 features. #>  09/03/22 21:41:31: Update data, action: change_featureID, 356 samples and 758 features. # load urine metabolomic data df_urine <- load_excel(path = file_path,                         data_sheet = 2,                         feature_sheet = 5,                         sample_sheet = 9,                         sampleID = \"QMDiab-ID\",                         featureID = \"BIOCHEMICAL\"                         )  df_urine <- update_Metabolite(df_urine, dataset = \"COMP_IDstr\", action = \"change_featureID\") df_urine #>  An object of  Metabolite  #>   #>  ***  @assayData (first and last 10 columns [ 359  *  892 ])  *** #>        sampleID   M38002 M34404  M32391 M20675   M21049  M34400 M40506  M34455 #>    1: QMDiab254  1189337 146900  265120  53499 15379982  619745  53261  227263 #>    2: QMDiab290  9944836 716781 2042008  71989 26406420 1988553 123129 1221563 #>    3:  QMDiab54   926350 182438  775726  48752  7551248 1159521  72837  215868 #>    4:  QMDiab55   305459 579097  511122  21423  4655848 1102500 131674      NA #>    5: QMDiab319   574761 295176  175826  91788  2762680  417870  21631  243512 #>   ---                                                                          #>  355:  QMDiab70  1139559 117975  326903     NA 10051449  406266 234997  183234 #>  356: QMDiab118  1517228 234288      NA  24350  2613189  375914  51929      NA #>  357:  QMDiab65  1028291 352068  609710 113673 29650920  621166 130037  549992 #>  358: QMDiab248  1807105 338741  148964  62614   937893  603113  48151  293379 #>  359:   QMDiab4 10103832 203176  245175  50822 28406416  243598  74996  696766 #>         M30460 M42272 M42314 M42335 M42351 M42352 M42553 M42856 M42913 M43112 #>    1:  5502123  96913  31056  33430     NA  35558     NA  23369  21931     NA #>    2: 17475172 124745  66036  39595     NA 732853     NA  28220  27811     NA #>    3:  6423459  44266  23363  39645     NA  62630     NA  13148  25018     NA #>    4:  4246983  77365  40193  46686     NA  92981     NA  22845  23620     NA #>    5:  2780633  24081  16319  25583     NA  31037     NA  29122  41337     NA #>   ---                                                                         #>  355:  1407294  54919  52317  78413     NA  38453     NA  33084 195136     NA #>  356:  1856043  42309  17973  25751     NA  12967     NA  15268  31577     NA #>  357: 10131966 110335  40228  34299     NA 108341     NA  52714  33244     NA #>  358:       NA  36055  29644  22465     NA  19287     NA  27299  36462     NA #>  359: 27087992 185546  45205  60944     NA 149210   9804  35991 186372     NA #>       M43129 M43130 #>    1:     NA     NA #>    2:     NA   7215 #>    3:     NA   8596 #>    4:     NA     NA #>    5:     NA     NA #>   ---               #>  355:     NA   5700 #>  356:     NA  11083 #>  357:     NA   6296 #>  358:     NA     NA #>  359:     NA   7482 #>   #>  ***  @featureData (ID:  featureID ) *** #>       PATHWAY_SORTORDER                  BIOCHEMICAL SUPER_PATHWAY #>    1:               986              1,2-propanediol         Lipid #>    2:              1805         1,3,7-trimethylurate   Xenobiotics #>    3:              1802            1,3-dimethylurate   Xenobiotics #>    4:               583 1,5-anhydroglucitol (1,5-AG)  Carbohydrate #>    5:               591           1,6-anhydroglucose  Carbohydrate #>   ---                                                              #>  887:              <NA>                    X - 19380          <NA> #>  888:              <NA>                    X - 19437          <NA> #>  889:              <NA>                    X - 19556          <NA> #>  890:              <NA>                    X - 19573          <NA> #>  891:              <NA>                    X - 19574          <NA> #>                                            SUB_PATHWAY COMP_ID  PLATFORM #>    1:                                    Ketone bodies   38002     GC/MS #>    2:                              Xanthine metabolism   34404 LC/MS Neg #>    3:                              Xanthine metabolism   32391     GC/MS #>    4: Glycolysis, gluconeogenesis, pyruvate metabolism   20675 LC/MS Neg #>    5: Glycolysis, gluconeogenesis, pyruvate metabolism   21049     GC/MS #>   ---                                                                    #>  887:                                             <NA>   42856 LC/MS Neg #>  888:                                             <NA>   42913 LC/MS Neg #>  889:                                             <NA>   43112 LC/MS Pos #>  890:                                             <NA>   43129 LC/MS Neg #>  891:                                             <NA>   43130 LC/MS Neg #>                       RI               MASS  PUBCHEM        CAS   KEGG   HMDb_ID #>    1:               1041                117     <NA>   57-55-6; C00583 HMDB01881 #>    2:               1988              209.1    79437 5415-44-1; C16361 HMDB02123 #>    3:               1937 325.10000000000002    70346 944-73-0 ;   <NA> HMDB01857 #>    4:                808 163.19999999999999     <NA>  154-58-5; C07326 HMDB02712 #>    5:             1679.5              204.1 11412545  498-07-7;   <NA> HMDB00640 #>   ---                                                                            #>  887:               2287              412.4     <NA>       <NA>   <NA>      <NA> #>  888: 1150.0999999999999              397.1     <NA>       <NA>   <NA>      <NA> #>  889: 4249.8999999999996              404.9     <NA>       <NA>   <NA>      <NA> #>  890:             3906.5              403.2     <NA>       <NA>   <NA>      <NA> #>  891:             4045.7 307.10000000000002     <NA>       <NA>   <NA>      <NA> #>       COMP_IDstr featureID #>    1:     M38002    M38002 #>    2:     M34404    M34404 #>    3:     M32391    M32391 #>    4:     M20675    M20675 #>    5:     M21049    M21049 #>   ---                      #>  887:     M42856    M42856 #>  888:     M42913    M42913 #>  889:     M43112    M43112 #>  890:     M43129    M43129 #>  891:     M43130    M43130 #>   #>  ***  @sampleData (ID:  sampleID ) *** #>        sampleID      AGE GENDER      BMI ETHNICITY T2D #>    1: QMDiab254 53.10335      0 32.05128         1   0 #>    2: QMDiab290 39.79192      1 30.51426         4   0 #>    3:  QMDiab54 36.82136      0 24.16831         1   0 #>    4:  QMDiab55 34.75975      0 44.44444         1   1 #>    5: QMDiab319 50.17933      1 27.18090         1   1 #>   ---                                                  #>  355:  QMDiab70 35.40315      1 33.83403         1   1 #>  356: QMDiab118 49.06229      1 25.64494         1   0 #>  357:  QMDiab65 47.22245      1 23.38435         1   0 #>  358: QMDiab248 56.39151      0 27.58621         1   1 #>  359:   QMDiab4 24.22450      0 41.66521         1   0 #>   #>  ***  @miscData  *** #>  integer(0) #>   #>  ***  @logs  *** #>  09/03/22 21:41:31: Import data from: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . #>  09/03/22 21:41:31: Initiate data: 359 samples and 891 features. #>  09/03/22 21:41:31: Update data, action: change_featureID, 359 samples and 891 features. # load saliva metatabolomic data df_saliva <- load_excel(path = file_path,                         data_sheet = 3,                         feature_sheet = 6,                         sample_sheet = 10,                         sampleID = \"QMDiab-ID\",                         featureID = \"BIOCHEMICAL\"                         )  df_saliva <- update_Metabolite(df_saliva, dataset = \"COMP_IDstr\", action = \"change_featureID\") df_saliva #>  An object of  Metabolite  #>   #>  ***  @assayData (first and last 10 columns [ 321  *  603 ])  *** #>        sampleID M43027  M38002 M01654 M35963 M35690 M20675 M21049 M34400 M35628 #>    1: QMDiab370  11974  720004     NA     NA  91544 211457     NA   2661     NA #>    2: QMDiab245  15485  481889  24313  53097  80819 175312  25921   2250  27847 #>    3:  QMDiab34  13916  979243     NA  44158 104042 271930     NA     NA     NA #>    4: QMDiab287  28023  825577     NA  57600 157057  50692     NA     NA     NA #>    5: QMDiab355  22830 1150408     NA  63460 225965 741408  71523   3739     NA #>   ---                                                                           #>  317: QMDiab202  16493  488210     NA     NA 116683 158562     NA   3496  18241 #>  318:  QMDiab80  15254 3345272  23456  36201 120444 295726 107821     NA  14988 #>  319: QMDiab107  31452  578446     NA  20563 245882 234635     NA     NA     NA #>  320: QMDiab352  18975  280464     NA     NA  20491  77539     NA     NA  19239 #>  321: QMDiab127  16344  881910  64403  44381 206525 912153     NA     NA  12066 #>       M42851 M42877 M42913 M42914 M43042 M43049 M43050 M43110 M43122 M43128 #>    1:   4937     NA   5390     NA  22149   4997   5548     NA     NA  14190 #>    2:   3316     NA  10883   1110  22797   8284     NA     NA     NA  15273 #>    3:   3260     NA     NA     NA  15291     NA     NA     NA     NA  10602 #>    4:   3463     NA   6735     NA  20655   5779     NA     NA     NA  13165 #>    5:   3887     NA   3670     NA  45619   6922     NA  12023     NA  15046 #>   ---                                                                       #>  317:     NA     NA   7243     NA  14632     NA     NA     NA     NA  15163 #>  318:     NA     NA  10592   3708  15018   5433     NA     NA     NA  21337 #>  319:     NA     NA     NA   4409  37399   9265     NA  42065     NA  37183 #>  320:     NA     NA   9140   4056   3362     NA     NA     NA     NA  21376 #>  321:     NA   2645   7590   4894  25546   5422     NA     NA     NA  15142 #>       M43137 #>    1:     NA #>    2:     NA #>    3:     NA #>    4:     NA #>    5:     NA #>   ---        #>  317:     NA #>  318:     NA #>  319:     NA #>  320:     NA #>  321:     NA #>   #>  ***  @featureData (ID:  featureID ) *** #>       PATHWAY_SORTORDER                BIOCHEMICAL SUPER_PATHWAY #>    1:             800.1 1,11-undecanedicarboxylate         Lipid #>    2:               986            1,2-propanediol         Lipid #>    3:               273         1,3-diaminopropane    Amino acid #>    4:               600       1,3-dihydroxyacetone  Carbohydrate #>    5:              1494             1,4-butanediol   Xenobiotics #>   ---                                                            #>  598:              <NA>                  X - 19497          <NA> #>  599:              <NA>                  X - 19554          <NA> #>  600:              <NA>                  X - 19566          <NA> #>  601:              <NA>                  X - 19572          <NA> #>  602:              <NA>                  X - 19581          <NA> #>                                            SUB_PATHWAY COMP_ID  PLATFORM #>    1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg #>    2:                                    Ketone bodies   38002     GC/MS #>    3:      Urea cycle; arginine-, proline-, metabolism    1654     GC/MS #>    4: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS #>    5:                                         Chemical   35690     GC/MS #>   ---                                                                    #>  598:                                             <NA>   43050 LC/MS Neg #>  599:                                             <NA>   43110 LC/MS Pos #>  600:                                             <NA>   43122 LC/MS Neg #>  601:                                             <NA>   43128 LC/MS Neg #>  602:                                             <NA>   43137 LC/MS Neg #>                       RI  MASS PUBCHEM                 CAS   KEGG   HMDb_ID #>    1:               3578 243.2   10458           505-52-2;   <NA> HMDB02327 #>    2:               1041   117    <NA>            57-55-6; C00583 HMDB01881 #>    3:             1633.8   174     428           109-76-2; C00986 HMDB00002 #>    4:               1263   103     670 96-26-4;62147-49-3; C00184 HMDB01882 #>    5:               1208 115.8    <NA>           110-63-4;   <NA>      <NA> #>   ---                                                                       #>  598:             3657.6 227.3    <NA>                <NA>   <NA>      <NA> #>  599:             3618.7   471    <NA>                <NA>   <NA>      <NA> #>  600:             2953.2 744.5    <NA>                <NA>   <NA>      <NA> #>  601:             3761.2 431.3    <NA>                <NA>   <NA>      <NA> #>  602: 4949.6000000000004 938.5    <NA>                <NA>   <NA>      <NA> #>       COMP_IDstr featureID #>    1:     M43027    M43027 #>    2:     M38002    M38002 #>    3:     M01654    M01654 #>    4:     M35963    M35963 #>    5:     M35690    M35690 #>   ---                      #>  598:     M43050    M43050 #>  599:     M43110    M43110 #>  600:     M43122    M43122 #>  601:     M43128    M43128 #>  602:     M43137    M43137 #>   #>  ***  @sampleData (ID:  sampleID ) *** #>        sampleID      AGE GENDER      BMI ETHNICITY T2D #>    1: QMDiab370 56.49829      1 25.76591         1   1 #>    2: QMDiab245 51.51540      0 23.89943         1   0 #>    3:  QMDiab34 28.00548      0 23.90118         3   0 #>    4: QMDiab287 41.43463      0 31.47107         4   1 #>    5: QMDiab355 28.34771      0 25.16103         1   0 #>   ---                                                  #>  317: QMDiab202 49.40999      1 33.72008         1   1 #>  318:  QMDiab80 25.86995      0 29.89101         1   0 #>  319: QMDiab107 38.50240      1 24.60973         2   0 #>  320: QMDiab352 41.55510      1 31.22690         3   1 #>  321: QMDiab127 34.69952      1 30.47797         1   0 #>   #>  ***  @miscData  *** #>  integer(0) #>   #>  ***  @logs  *** #>  09/03/22 21:41:32: Import data from: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . #>  09/03/22 21:41:32: Initiate data: 321 samples and 602 features. #>  09/03/22 21:41:32: Update data, action: change_featureID, 321 samples and 602 features."},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"quality-control-pipeline","dir":"","previous_headings":"","what":"Tools for metabolomic data","title":"Tools for metabolomic data","text":"provided pipeline metabolite sample quality control (QC) procedures series functions. QC pipeline, included following functions: remove metabolites samples beyond particular missing rate threshold (eg. 0.5), detect outliers (eg. +- 5 SD) replace outliers NA winsorize outliers, popular methods impute missing values (eg. half minimum value). steps can customized implement “QC_pipeline” function used individual functions (eg. “filter_column_missing_rate”, “replace_outlier”, “impute”).","code":"df_plasma_QC <- QC_pipeline(df_plasma, replace_outlier_method = \"winsorize\", impute_method = NULL) #>   #>  Constant columns n = 37 #>   #>   Number of columns with a missing rate >= 0.5 : n = 176 df_plasma_QC #>  An object of  Metabolite  #>   #>  ***  @assayData (first and last 10 columns [ 356  *  546 ])  *** #>        sampleID M43027 M11953 M38002 M34404 M35963 M35728 M20675 M34400  M33228 #>    1: QMDiab222   8578     NA 103724  22259 104059   7067 357499  19986 2173598 #>    2: QMDiab113  15145     NA     NA  39841     NA  36542 440058  16620 2464846 #>    3:  QMDiab29     NA  96455 159945  10605 165416  54209 355790  12220 2613798 #>    4: QMDiab243  19692  69444 108965  38562 139866  22412 185273  29537 2543266 #>    5: QMDiab270     NA     NA 157617   4490     NA  21958 692753  10256 2138029 #>   ---                                                                           #>  352: QMDiab352   6689 116932 115737  34791 152711  59120 178759  25326  864647 #>  353: QMDiab135   7556 248824 481008   4766 164853 126065 103647  12253 3018611 #>  354: QMDiab229  20252  80804 138253  13949  85019  43072 330579  15124 1398965 #>  355: QMDiab202   7378 108152 112229  21748 175918  78154 106745  21434 2104899 #>  356: QMDiab103   6667  57851 146948   8458  82064  34234 534697  12979  992388 #>       M42307 M42314 M42544 M42548 M42549 M42552 M42554 M42856 M42887 M42913 #>    1:     NA  30592   3839  13734     NA     NA  37654 158054  88569  64644 #>    2:   6978  81380   4128  15288     NA   4697  28262 125669  87268  52074 #>    3:  17943 104253   6788  18861   6761   5096  30139 194732 106360  31782 #>    4:  11069  73203   8493  12138  10371  11207  21406 152853 119643  67713 #>    5:   7904  28846   7130  12843   3150   4556  14976 204978 149644 108660 #>   ---                                                                       #>  352:  11539  40487   9988   6173   7678   9008  30501 195331 134564  22141 #>  353:   5441  37950     NA  18464     NA     NA  43687 136120  75431  61867 #>  354:     NA  18098   5766   8244   5932     NA  18728 216380 128925  84299 #>  355:   8119  70566   8470  11932     NA   5895  27858 162256 112923  42586 #>  356:   7647  46836   7420   8019     NA   8253  32159 137705 112636  89283 #>       M42914 #>    1:  18055 #>    2:  12805 #>    3:  18467 #>    4:  12356 #>    5:  12479 #>   ---        #>  352:  17205 #>  353:  28223 #>  354:  14936 #>  355:  51588 #>  356:  23515 #>   #>  ***  @featureData (ID:  featureID ) *** #>       PATHWAY_SORTORDER                    BIOCHEMICAL SUPER_PATHWAY #>    1:             800.1 1,11-Undecanedicarboxylic acid         Lipid #>    2:              1070        1,2-dipalmitoylglycerol         Lipid #>    3:               986                1,2-propanediol         Lipid #>    4:              1805           1,3,7-trimethylurate   Xenobiotics #>    5:               600           1,3-dihydroxyacetone  Carbohydrate #>   ---                                                                #>  754:              <NA>                      X - 19436          <NA> #>  755:              <NA>                      X - 19437          <NA> #>  756:              <NA>                      X - 19438          <NA> #>  757:              <NA>                      X - 19451          <NA> #>  758:              <NA>                      X - 19574          <NA> #>                                            SUB_PATHWAY COMP_ID  PLATFORM #>    1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg #>    2:                                   Diacylglycerol   11953     GC/MS #>    3:                                    Ketone bodies   38002     GC/MS #>    4:                              Xanthine metabolism   34404 LC/MS Neg #>    5: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS #>   ---                                                                    #>  754:                                             <NA>   42912 LC/MS Neg #>  755:                                             <NA>   42913 LC/MS Neg #>  756:                                             <NA>   42914 LC/MS Neg #>  757:                                             <NA>   42927 LC/MS Neg #>  758:                                             <NA>   43130 LC/MS Neg #>                       RI               MASS PUBCHEM                 CAS   KEGG #>    1:               3578              243.2   10458           505-52-2;   <NA> #>    2:               2600                145   99931         40290-32-2;   <NA> #>    3:               1041                117    <NA>            57-55-6; C00583 #>    4:               1988              209.1   79437          5415-44-1; C16361 #>    5:               1263                103     670 96-26-4;62147-49-3; C00184 #>   ---                                                                          #>  754:               4747              467.4    <NA>                <NA>   <NA> #>  755: 1150.0999999999999              397.1    <NA>                <NA>   <NA> #>  756:             1222.3              217.1    <NA>                <NA>   <NA> #>  757:             3728.5              239.1    <NA>                <NA>   <NA> #>  758:             4045.7 307.10000000000002    <NA>                <NA>   <NA> #>         HMDb_ID COMP_IDstr featureID #>    1: HMDB02327     M43027    M43027 #>    2: HMDB07098     M11953    M11953 #>    3: HMDB01881     M38002    M38002 #>    4: HMDB02123     M34404    M34404 #>    5: HMDB01882     M35963    M35963 #>   ---                                #>  754:      <NA>     M42912    M42912 #>  755:      <NA>     M42913    M42913 #>  756:      <NA>     M42914    M42914 #>  757:      <NA>     M42927    M42927 #>  758:      <NA>     M43130    M43130 #>   #>  ***  @sampleData (ID:  sampleID ) *** #>        sampleID      AGE GENDER      BMI ETHNICITY T2D #>    1: QMDiab222 34.50513      0 25.01021         2   0 #>    2: QMDiab113 47.06639      1 28.36776         3   0 #>    3:  QMDiab29 55.49076      1 29.70564         1   0 #>    4: QMDiab243 56.33402      1 23.14050         2   0 #>    5: QMDiab270 35.63039      1 30.06229         1   0 #>   ---                                                  #>  352: QMDiab352 41.55510      1 31.22690         3   1 #>  353: QMDiab135 52.55305      0 29.07577         2   1 #>  354: QMDiab229 30.31348      0 22.22656         2   0 #>  355: QMDiab202 49.40999      1 33.72008         1   1 #>  356: QMDiab103 23.85489      0 35.96389         1   0 #>   #>  ***  @miscData  *** #>  integer(0) #>   #>  ***  @logs  *** #>  09/03/22 21:41:31: Import data from: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . #>  09/03/22 21:41:31: Initiate data: 356 samples and 758 features. #>  09/03/22 21:41:31: Update data, action: change_featureID, 356 samples and 758 features.  #>   #>  09/03/22 21:41:32: Run QC pipeline. #>  09/03/22 21:41:32: Filter data with a constant column, removed 37 features.  #>  09/03/22 21:41:32: Update data, 356 samples and 758 features.  #>  09/03/22 21:41:32: Filter data with a missing rate >= 0.5, removed 176 features.  #>  09/03/22 21:41:32: Update data, 356 samples and 758 features.  #>  09/03/22 21:41:32: Replace outliers using `winsorize` method 5 SDs. df_urine_QC <- QC_pipeline(df_urine, replace_outlier_method = \"winsorize\", impute_method = NULL) #>   #>  Constant columns n = 28 #>   #>   Number of columns with a missing rate >= 0.5 : n = 77 df_urine_QC #>  An object of  Metabolite  #>   #>  ***  @assayData (first and last 10 columns [ 359  *  787 ])  *** #>        sampleID   M38002 M34404  M32391 M20675   M21049  M34400 M40506  M34455 #>    1: QMDiab254  1189337 146900  265120  53499 15379982  619745  53261  227263 #>    2: QMDiab290  9944836 716781 2042008  71989 26406420 1988553 123129 1221563 #>    3:  QMDiab54   926350 182438  775726  48752  7551248 1159521  72837  215868 #>    4:  QMDiab55   305459 579097  511122  21423  4655848 1102500 131674      NA #>    5: QMDiab319   574761 295176  175826  91788  2762680  417870  21631  243512 #>   ---                                                                          #>  355:  QMDiab70  1139559 117975  326903     NA 10051449  406266 234997  183234 #>  356: QMDiab118  1517228 234288      NA  24350  2613189  375914  51929      NA #>  357:  QMDiab65  1028291 352068  609710 113673 29650920  621166 130037  549992 #>  358: QMDiab248  1807105 338741  148964  62614   937893  603113  48151  293379 #>  359:   QMDiab4 10103832 203176  245175  50822 28406416  243598  74996  696766 #>         M30460 M41595 M41702 M41709 M41768 M41837 M42272 M42314 M42335 M42352 #>    1:  5502123  74988  29007   4223  17008   5636  96913  31056  33430  35558 #>    2: 17475172  66278 101935  34251  14937   9552 124745  66036  39595 652059 #>    3:  6423459  74225  51295  14090  32971   9104  44266  23363  39645  62630 #>    4:  4246983  63809  31054   6151   8054  15148  77365  40193  46686  92981 #>    5:  2780633  40804   8307   3715  31370   5993  24081  16319  25583  31037 #>   ---                                                                         #>  355:  1407294  67664  36157     NA  29194  15652  54919  52317  78413  38453 #>  356:  1856043  34332  29877  30817   5029   4603  42309  17973  25751  12967 #>  357: 10131966  57310  22374     NA  19358   9598 110335  40228  34299 108341 #>  358:       NA  26670   8525   7059  13231   9698  36055  29644  22465  19287 #>  359: 27087992  95140  66285  20229  35845  18570 185546  45205  60944 149210 #>       M42856 M42913 #>    1:  23369  21931 #>    2:  28220  27811 #>    3:  13148  25018 #>    4:  22845  23620 #>    5:  29122  41337 #>   ---               #>  355:  33084 195136 #>  356:  15268  31577 #>  357:  52714  33244 #>  358:  27299  36462 #>  359:  35991 186372 #>   #>  ***  @featureData (ID:  featureID ) *** #>       PATHWAY_SORTORDER                  BIOCHEMICAL SUPER_PATHWAY #>    1:               986              1,2-propanediol         Lipid #>    2:              1805         1,3,7-trimethylurate   Xenobiotics #>    3:              1802            1,3-dimethylurate   Xenobiotics #>    4:               583 1,5-anhydroglucitol (1,5-AG)  Carbohydrate #>    5:               591           1,6-anhydroglucose  Carbohydrate #>   ---                                                              #>  887:              <NA>                    X - 19380          <NA> #>  888:              <NA>                    X - 19437          <NA> #>  889:              <NA>                    X - 19556          <NA> #>  890:              <NA>                    X - 19573          <NA> #>  891:              <NA>                    X - 19574          <NA> #>                                            SUB_PATHWAY COMP_ID  PLATFORM #>    1:                                    Ketone bodies   38002     GC/MS #>    2:                              Xanthine metabolism   34404 LC/MS Neg #>    3:                              Xanthine metabolism   32391     GC/MS #>    4: Glycolysis, gluconeogenesis, pyruvate metabolism   20675 LC/MS Neg #>    5: Glycolysis, gluconeogenesis, pyruvate metabolism   21049     GC/MS #>   ---                                                                    #>  887:                                             <NA>   42856 LC/MS Neg #>  888:                                             <NA>   42913 LC/MS Neg #>  889:                                             <NA>   43112 LC/MS Pos #>  890:                                             <NA>   43129 LC/MS Neg #>  891:                                             <NA>   43130 LC/MS Neg #>                       RI               MASS  PUBCHEM        CAS   KEGG   HMDb_ID #>    1:               1041                117     <NA>   57-55-6; C00583 HMDB01881 #>    2:               1988              209.1    79437 5415-44-1; C16361 HMDB02123 #>    3:               1937 325.10000000000002    70346 944-73-0 ;   <NA> HMDB01857 #>    4:                808 163.19999999999999     <NA>  154-58-5; C07326 HMDB02712 #>    5:             1679.5              204.1 11412545  498-07-7;   <NA> HMDB00640 #>   ---                                                                            #>  887:               2287              412.4     <NA>       <NA>   <NA>      <NA> #>  888: 1150.0999999999999              397.1     <NA>       <NA>   <NA>      <NA> #>  889: 4249.8999999999996              404.9     <NA>       <NA>   <NA>      <NA> #>  890:             3906.5              403.2     <NA>       <NA>   <NA>      <NA> #>  891:             4045.7 307.10000000000002     <NA>       <NA>   <NA>      <NA> #>       COMP_IDstr featureID #>    1:     M38002    M38002 #>    2:     M34404    M34404 #>    3:     M32391    M32391 #>    4:     M20675    M20675 #>    5:     M21049    M21049 #>   ---                      #>  887:     M42856    M42856 #>  888:     M42913    M42913 #>  889:     M43112    M43112 #>  890:     M43129    M43129 #>  891:     M43130    M43130 #>   #>  ***  @sampleData (ID:  sampleID ) *** #>        sampleID      AGE GENDER      BMI ETHNICITY T2D #>    1: QMDiab254 53.10335      0 32.05128         1   0 #>    2: QMDiab290 39.79192      1 30.51426         4   0 #>    3:  QMDiab54 36.82136      0 24.16831         1   0 #>    4:  QMDiab55 34.75975      0 44.44444         1   1 #>    5: QMDiab319 50.17933      1 27.18090         1   1 #>   ---                                                  #>  355:  QMDiab70 35.40315      1 33.83403         1   1 #>  356: QMDiab118 49.06229      1 25.64494         1   0 #>  357:  QMDiab65 47.22245      1 23.38435         1   0 #>  358: QMDiab248 56.39151      0 27.58621         1   1 #>  359:   QMDiab4 24.22450      0 41.66521         1   0 #>   #>  ***  @miscData  *** #>  integer(0) #>   #>  ***  @logs  *** #>  09/03/22 21:41:31: Import data from: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . #>  09/03/22 21:41:31: Initiate data: 359 samples and 891 features. #>  09/03/22 21:41:31: Update data, action: change_featureID, 359 samples and 891 features.  #>   #>  09/03/22 21:41:32: Run QC pipeline. #>  09/03/22 21:41:32: Filter data with a constant column, removed 28 features.  #>  09/03/22 21:41:32: Update data, 359 samples and 891 features.  #>  09/03/22 21:41:33: Filter data with a missing rate >= 0.5, removed 77 features.  #>  09/03/22 21:41:33: Update data, 359 samples and 891 features.  #>  09/03/22 21:41:33: Replace outliers using `winsorize` method 5 SDs. df_saliva_QC <- QC_pipeline(df_saliva, replace_outlier_method = \"winsorize\", impute_method = NULL) #>   #>  Constant columns n = 35 #>   #>   Number of columns with a missing rate >= 0.5 : n = 203 df_saliva_QC #>  An object of  Metabolite  #>   #>  ***  @assayData (first and last 10 columns [ 321  *  365 ])  *** #>        sampleID M43027  M38002 M35690 M20675 M35628 M37536 M37752  M35691 M38276 #>    1: QMDiab370  11974  720004  91544 211457     NA     NA 121286  352891 161984 #>    2: QMDiab245  15485  481889  80819 175312  27847  24251  78051  179709 155695 #>    3:  QMDiab34  13916  979243 104042 271930     NA  19333  54685   58106  99814 #>    4: QMDiab287  28023  825577 157057  50692     NA  22527 134397   48854 134122 #>    5: QMDiab355  22830 1150408 225965 741408     NA  67922 113970  989663 232232 #>   ---                                                                            #>  317: QMDiab202  16493  488210 116683 158562  18241  54375 119442  302910 345072 #>  318:  QMDiab80  15254 3345272 120444 295726  14988 112052  98093 1567170 445473 #>  319: QMDiab107  31452  578446 245882 234635     NA     NA  74245  171205 132903 #>  320: QMDiab352  18975  280464  20491  77539  19239  35706  53731   95315  97904 #>  321: QMDiab127  16344  881910 206525 912153  12066  30309 102026  843075 941156 #>       M41491  M41548 M41921 M42238 M42272 M42741 M42851 M42913 M43042 M43049 #>    1: 404368 1007590  10148   6156   2352     NA   4937   5390  22149   4997 #>    2: 360478  641392  11972   5093     NA  13502   3316  10883  22797   8284 #>    3: 368498  741774   4553   4875   9858     NA   3260     NA  15291     NA #>    4: 900064  429374   7717     NA   6371     NA   3463   6735  20655   5779 #>    5: 506638  786827   7807     NA  11181  16551   3887   3670  45619   6922 #>   ---                                                                        #>  317: 368498  264313  12567     NA  11743  12683     NA   7243  14632     NA #>  318: 623000  367782  29507     NA     NA  32002     NA  10592  15018   5433 #>  319: 983332  883025  13123   4657     NA  19707     NA     NA  37399   9265 #>  320:  85130  230107  15529     NA     NA   4080     NA   9140   3362     NA #>  321: 902186      NA  17118   9253   4176  60963     NA   7590  25546   5422 #>       M43128 #>    1:  14190 #>    2:  15273 #>    3:  10602 #>    4:  13165 #>    5:  15046 #>   ---        #>  317:  15163 #>  318:  21337 #>  319:  37183 #>  320:  21376 #>  321:  15142 #>   #>  ***  @featureData (ID:  featureID ) *** #>       PATHWAY_SORTORDER                BIOCHEMICAL SUPER_PATHWAY #>    1:             800.1 1,11-undecanedicarboxylate         Lipid #>    2:               986            1,2-propanediol         Lipid #>    3:               273         1,3-diaminopropane    Amino acid #>    4:               600       1,3-dihydroxyacetone  Carbohydrate #>    5:              1494             1,4-butanediol   Xenobiotics #>   ---                                                            #>  598:              <NA>                  X - 19497          <NA> #>  599:              <NA>                  X - 19554          <NA> #>  600:              <NA>                  X - 19566          <NA> #>  601:              <NA>                  X - 19572          <NA> #>  602:              <NA>                  X - 19581          <NA> #>                                            SUB_PATHWAY COMP_ID  PLATFORM #>    1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg #>    2:                                    Ketone bodies   38002     GC/MS #>    3:      Urea cycle; arginine-, proline-, metabolism    1654     GC/MS #>    4: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS #>    5:                                         Chemical   35690     GC/MS #>   ---                                                                    #>  598:                                             <NA>   43050 LC/MS Neg #>  599:                                             <NA>   43110 LC/MS Pos #>  600:                                             <NA>   43122 LC/MS Neg #>  601:                                             <NA>   43128 LC/MS Neg #>  602:                                             <NA>   43137 LC/MS Neg #>                       RI  MASS PUBCHEM                 CAS   KEGG   HMDb_ID #>    1:               3578 243.2   10458           505-52-2;   <NA> HMDB02327 #>    2:               1041   117    <NA>            57-55-6; C00583 HMDB01881 #>    3:             1633.8   174     428           109-76-2; C00986 HMDB00002 #>    4:               1263   103     670 96-26-4;62147-49-3; C00184 HMDB01882 #>    5:               1208 115.8    <NA>           110-63-4;   <NA>      <NA> #>   ---                                                                       #>  598:             3657.6 227.3    <NA>                <NA>   <NA>      <NA> #>  599:             3618.7   471    <NA>                <NA>   <NA>      <NA> #>  600:             2953.2 744.5    <NA>                <NA>   <NA>      <NA> #>  601:             3761.2 431.3    <NA>                <NA>   <NA>      <NA> #>  602: 4949.6000000000004 938.5    <NA>                <NA>   <NA>      <NA> #>       COMP_IDstr featureID #>    1:     M43027    M43027 #>    2:     M38002    M38002 #>    3:     M01654    M01654 #>    4:     M35963    M35963 #>    5:     M35690    M35690 #>   ---                      #>  598:     M43050    M43050 #>  599:     M43110    M43110 #>  600:     M43122    M43122 #>  601:     M43128    M43128 #>  602:     M43137    M43137 #>   #>  ***  @sampleData (ID:  sampleID ) *** #>        sampleID      AGE GENDER      BMI ETHNICITY T2D #>    1: QMDiab370 56.49829      1 25.76591         1   1 #>    2: QMDiab245 51.51540      0 23.89943         1   0 #>    3:  QMDiab34 28.00548      0 23.90118         3   0 #>    4: QMDiab287 41.43463      0 31.47107         4   1 #>    5: QMDiab355 28.34771      0 25.16103         1   0 #>   ---                                                  #>  317: QMDiab202 49.40999      1 33.72008         1   1 #>  318:  QMDiab80 25.86995      0 29.89101         1   0 #>  319: QMDiab107 38.50240      1 24.60973         2   0 #>  320: QMDiab352 41.55510      1 31.22690         3   1 #>  321: QMDiab127 34.69952      1 30.47797         1   0 #>   #>  ***  @miscData  *** #>  integer(0) #>   #>  ***  @logs  *** #>  09/03/22 21:41:32: Import data from: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . #>  09/03/22 21:41:32: Initiate data: 321 samples and 602 features. #>  09/03/22 21:41:32: Update data, action: change_featureID, 321 samples and 602 features.  #>   #>  09/03/22 21:41:33: Run QC pipeline. #>  09/03/22 21:41:33: Filter data with a constant column, removed 35 features.  #>  09/03/22 21:41:33: Update data, 321 samples and 602 features.  #>  09/03/22 21:41:33: Filter data with a missing rate >= 0.5, removed 203 features.  #>  09/03/22 21:41:33: Update data, 321 samples and 602 features.  #>  09/03/22 21:41:33: Replace outliers using `winsorize` method 5 SDs."},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"transformation","dir":"","previous_headings":"","what":"Transformation","title":"Tools for metabolomic data","text":"Transformation metabolites can alter distribution data essential step following statistical analysis. provided following transformation methods: log (natural logarithm), pareto scale, scale, rank-based inverse normal transformation.","code":"df_plasma_QC <- impute(df_plasma_QC, method = \"half-min\") df_plasma_scale <-  transformation(df_plasma_QC, method = \"log\") df_plasma_scale <-  transformation(df_plasma_scale, method = \"scale\") df_plasma_scale #>  An object of  Metabolite  #>   #>  ***  @assayData (first and last 10 columns [ 356  *  546 ])  *** #>        sampleID      M43027      M11953      M38002     M34404     M35963 #>    1: QMDiab222  0.38328962 -2.06937034 -0.25776988  0.1300954  0.1329676 #>    2: QMDiab113  1.09208975 -2.06937034 -2.09811585  0.7401431 -2.7715161 #>    3:  QMDiab29 -2.07224771  0.37986636  0.19492231 -0.6468556  0.7526296 #>    4: QMDiab243  1.41944199  0.02182271 -0.20624637  0.7059502  0.5283257 #>    5: QMDiab270 -2.07224771 -2.06937034  0.17959695 -1.5475159 -2.7715161 #>   ---                                                                     #>  352: QMDiab352  0.07315101  0.58966058 -0.14322471  0.5981101  0.6457892 #>  353: QMDiab135  0.22511485  1.41258850  1.34579403 -1.4850024  0.7480716 #>  354: QMDiab229  1.45440521  0.18692608  0.04258334 -0.3596389 -0.1371982 #>  355: QMDiab202  0.19539060  0.50460026 -0.17539627  0.1057578  0.8349219 #>  356: QMDiab103  0.06904336 -0.17721998  0.10633646 -0.8839089 -0.1844916 #>            M35728     M20675     M34400     M33228      M42307      M42314 #>    1: -2.15022266  0.4846600  0.1504626  0.7147450 -1.66388170 -0.28947392 #>    2: -0.22011372  0.7246235 -0.1016651  0.9880064  0.23596643  1.43130720 #>    3:  0.24318100  0.4791258 -0.5220933  1.1155149  1.20217335  1.86694301 #>    4: -0.79439802 -0.2744750  0.6844679  1.0560683  0.70798740  1.24506376 #>    5: -0.81843882  1.2486906 -0.7616244  0.6788895  0.36344522 -0.39283289 #>   ---                                                                      #>  352:  0.34505615 -0.3158120  0.4741913 -1.2884859  0.75053010  0.20341269 #>  353:  1.23459353 -0.9453014 -0.5184065  1.4284294 -0.01856785  0.08959909 #>  354: -0.02697569  0.3942445 -0.2306154 -0.2428478 -1.66388170 -1.21272633 #>  355:  0.67293679 -0.9112866  0.2460864  0.6449519  0.39090187  1.18053745 #>  356: -0.29675648  0.9495957 -0.4397136 -0.9890440  0.32962775  0.45961727 #>           M42544      M42548     M42549      M42552      M42554      M42856 #>    1: -0.7965687 -0.10047059 -0.9487939 -1.37729107  0.68352801 -0.11254665 #>    2: -0.6745840  0.07424437 -0.9487939  0.08365871  0.29566066 -0.99002949 #>    3:  0.1613181  0.41656906  0.8587908  0.18047655  0.38258560  0.68610780 #>    4:  0.5379320 -0.30181776  1.2068728  1.11631207 -0.07994001 -0.24059952 #>    5:  0.2439311 -0.20979707  0.2374080  0.04746543 -0.56284248  0.88235205 #>   ---                                                                       #>  352:  0.8104388 -1.40388426  0.9622680  0.85693528  0.39872567  0.69786177 #>  353: -2.8888549  0.38189554 -0.9487939 -1.37729107  0.88442476 -0.68430531 #>  354: -0.1129294 -0.93235314  0.7523676 -1.37729107 -0.26061363  1.08952272 #>  355:  0.5333744 -0.32971701 -0.9487939  0.35343194  0.27619711 -0.01213065 #>  356:  0.3109356 -0.97745562 -0.9487939  0.75298733  0.47028172 -0.64000024 #>           M42887     M42913      M42914 #>    1: -1.0147901  0.0919409 -0.07636980 #>    2: -1.0843123 -0.2871253 -0.80423166 #>    3: -0.1548217 -1.1527328 -0.02857249 #>    4:  0.3980587  0.1732535 -0.87984647 #>    5:  1.4492342  1.0023618 -0.85886254 #>   ---                                   #>  352:  0.9502102 -1.7864144 -0.17852561 #>  353: -1.7691271  0.0149663  0.86995988 #>  354:  0.7490907  0.5573375 -0.47812467 #>  355:  0.1264821 -0.6397389  2.14768955 #>  356:  0.1145265  0.6580360  0.48335069 #>   #>  ***  @featureData (ID:  featureID ) *** #>       PATHWAY_SORTORDER                    BIOCHEMICAL SUPER_PATHWAY #>    1:             800.1 1,11-Undecanedicarboxylic acid         Lipid #>    2:              1070        1,2-dipalmitoylglycerol         Lipid #>    3:               986                1,2-propanediol         Lipid #>    4:              1805           1,3,7-trimethylurate   Xenobiotics #>    5:               600           1,3-dihydroxyacetone  Carbohydrate #>   ---                                                                #>  754:              <NA>                      X - 19436          <NA> #>  755:              <NA>                      X - 19437          <NA> #>  756:              <NA>                      X - 19438          <NA> #>  757:              <NA>                      X - 19451          <NA> #>  758:              <NA>                      X - 19574          <NA> #>                                            SUB_PATHWAY COMP_ID  PLATFORM #>    1:                        Fatty acid, dicarboxylate   43027 LC/MS Neg #>    2:                                   Diacylglycerol   11953     GC/MS #>    3:                                    Ketone bodies   38002     GC/MS #>    4:                              Xanthine metabolism   34404 LC/MS Neg #>    5: Glycolysis, gluconeogenesis, pyruvate metabolism   35963     GC/MS #>   ---                                                                    #>  754:                                             <NA>   42912 LC/MS Neg #>  755:                                             <NA>   42913 LC/MS Neg #>  756:                                             <NA>   42914 LC/MS Neg #>  757:                                             <NA>   42927 LC/MS Neg #>  758:                                             <NA>   43130 LC/MS Neg #>                       RI               MASS PUBCHEM                 CAS   KEGG #>    1:               3578              243.2   10458           505-52-2;   <NA> #>    2:               2600                145   99931         40290-32-2;   <NA> #>    3:               1041                117    <NA>            57-55-6; C00583 #>    4:               1988              209.1   79437          5415-44-1; C16361 #>    5:               1263                103     670 96-26-4;62147-49-3; C00184 #>   ---                                                                          #>  754:               4747              467.4    <NA>                <NA>   <NA> #>  755: 1150.0999999999999              397.1    <NA>                <NA>   <NA> #>  756:             1222.3              217.1    <NA>                <NA>   <NA> #>  757:             3728.5              239.1    <NA>                <NA>   <NA> #>  758:             4045.7 307.10000000000002    <NA>                <NA>   <NA> #>         HMDb_ID COMP_IDstr featureID #>    1: HMDB02327     M43027    M43027 #>    2: HMDB07098     M11953    M11953 #>    3: HMDB01881     M38002    M38002 #>    4: HMDB02123     M34404    M34404 #>    5: HMDB01882     M35963    M35963 #>   ---                                #>  754:      <NA>     M42912    M42912 #>  755:      <NA>     M42913    M42913 #>  756:      <NA>     M42914    M42914 #>  757:      <NA>     M42927    M42927 #>  758:      <NA>     M43130    M43130 #>   #>  ***  @sampleData (ID:  sampleID ) *** #>        sampleID      AGE GENDER      BMI ETHNICITY T2D #>    1: QMDiab222 34.50513      0 25.01021         2   0 #>    2: QMDiab113 47.06639      1 28.36776         3   0 #>    3:  QMDiab29 55.49076      1 29.70564         1   0 #>    4: QMDiab243 56.33402      1 23.14050         2   0 #>    5: QMDiab270 35.63039      1 30.06229         1   0 #>   ---                                                  #>  352: QMDiab352 41.55510      1 31.22690         3   1 #>  353: QMDiab135 52.55305      0 29.07577         2   1 #>  354: QMDiab229 30.31348      0 22.22656         2   0 #>  355: QMDiab202 49.40999      1 33.72008         1   1 #>  356: QMDiab103 23.85489      0 35.96389         1   0 #>   #>  ***  @miscData  *** #>  integer(0) #>   #>  ***  @logs  *** #>  09/03/22 21:41:31: Import data from: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . #>  09/03/22 21:41:31: Initiate data: 356 samples and 758 features. #>  09/03/22 21:41:31: Update data, action: change_featureID, 356 samples and 758 features.  #>   #>  09/03/22 21:41:32: Run QC pipeline. #>  09/03/22 21:41:32: Filter data with a constant column, removed 37 features.  #>  09/03/22 21:41:32: Update data, 356 samples and 758 features.  #>  09/03/22 21:41:32: Filter data with a missing rate >= 0.5, removed 176 features.  #>  09/03/22 21:41:32: Update data, 356 samples and 758 features.  #>  09/03/22 21:41:32: Replace outliers using `winsorize` method 5 SDs.  #>  09/03/22 21:41:33: Impute data using `half-min` method.  #>  09/03/22 21:41:33: Transformation using `log` method.  #>  09/03/22 21:41:34: Transformation using `scale` method."},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"boxplot-before-transformation","dir":"","previous_headings":"","what":"Boxplot: before transformation","title":"Tools for metabolomic data","text":"","code":"# if no features were selected, randomly show 16 metabolites plot_Metabolite(df_plasma_QC, plot = \"boxplot\", x = \"T2D\", color =\"ETHNICITY\", shape = \"T2D\") # select three metabolites plot_Metabolite(df_plasma_QC, x = \"T2D\", plot = \"boxplot\", feature_name = c(\"M43027\",  \"M11953\", \"M38002\"))"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"visualization-comparisons-between-groups","dir":"","previous_headings":"","what":"Visualization: comparisons between groups","title":"Tools for metabolomic data","text":"","code":"# comparisons between groups using `ggbetweenstats` plot_Metabolite(df_plasma_QC, x = \"T2D\", plot = \"betweenstats\",  feature_name = c(\"M43027\",  \"M11953\"))"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"boxplot-after-transformation","dir":"","previous_headings":"","what":"Boxplot after transformation","title":"Tools for metabolomic data","text":"","code":"plot_Metabolite(df_plasma_scale, plot = \"boxplot\", x = \"T2D\", color =\"ETHNICITY\", shape = \"T2D\")"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"visualization-histogram","dir":"","previous_headings":"","what":"Visualization: histogram","title":"Tools for metabolomic data","text":"","code":"plot_Metabolite(df_plasma_scale, plot = \"histogram\", color = \"T2D\") plot_Metabolite(df_plasma_scale, plot = \"histogram\", color = \"ETHNICITY\")"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"normalization","dir":"","previous_headings":"","what":"Normalization","title":"Tools for metabolomic data","text":"Normalization metabolomic data important step remove systematic variation, facilitate identification real biological metabolites. provided several commonly used normalization method, including batch-based normalization, QC sample-based/nearest QC sample-based normalization, LOESS normalization. latter three methods used measurements internal QC samples available. selected first 16 metabolites show boxplot","code":"# Take the urine data for example, the batch of the samples are missing. To illustrate the usage of the normalization method data, we assume that 120 samples in each batch.  unique(featureData(df_urine_QC)$PLATFORM) #>  [1] \"GC/MS\"     \"LC/MS Neg\" \"LC/MS Pos\"  # add new columns by reference (column name uppercase) sampleData(df_urine_QC)[, `GC/MS` := rep(1:3, each = 120)[1:359]] sampleData(df_urine_QC)[, `LC/MS NEG` := rep(1:3, each = 120)[1:359]] sampleData(df_urine_QC)[, `LC/MS POS` := rep(1:3, each = 120)[1:359]]  # we also added a injection order column (in the current order) df_urine_QC <- update_Metabolite(df_urine_QC, sampleData(df_urine_QC)[, 1], action = \"injection_order\") #>  Creat a new column `ID_injection_order`.  # and set one as QC samples for each 10 samples.   sampleData(df_urine_QC)[, QCsample := ifelse(1:359%%10 == 0, 1, 0)] sampleData(df_urine_QC)[, QCsample := factor(QCsample, levels = c(1, 0))]                         sampleData(df_urine_QC)[, sampleID := ifelse(1:359 %% 10 == 0, paste0(\"MTRX-\", sampleID), sampleID)]  table(sampleData(df_urine_QC)$QCsample) #>   #>    1   0  #>   35 324  assayData(df_urine_QC)$sampleID <- sampleData(df_urine_QC)$sampleID # also change the ID in assayData df_urine_QC #>  An object of  Metabolite  #>   #>  ***  @assayData (first and last 10 columns [ 359  *  787 ])  *** #>        sampleID   M38002 M34404  M32391 M20675   M21049  M34400 M40506  M34455 #>    1: QMDiab254  1189337 146900  265120  53499 15379982  619745  53261  227263 #>    2: QMDiab290  9944836 716781 2042008  71989 26406420 1988553 123129 1221563 #>    3:  QMDiab54   926350 182438  775726  48752  7551248 1159521  72837  215868 #>    4:  QMDiab55   305459 579097  511122  21423  4655848 1102500 131674      NA #>    5: QMDiab319   574761 295176  175826  91788  2762680  417870  21631  243512 #>   ---                                                                          #>  355:  QMDiab70  1139559 117975  326903     NA 10051449  406266 234997  183234 #>  356: QMDiab118  1517228 234288      NA  24350  2613189  375914  51929      NA #>  357:  QMDiab65  1028291 352068  609710 113673 29650920  621166 130037  549992 #>  358: QMDiab248  1807105 338741  148964  62614   937893  603113  48151  293379 #>  359:   QMDiab4 10103832 203176  245175  50822 28406416  243598  74996  696766 #>         M30460 M41595 M41702 M41709 M41768 M41837 M42272 M42314 M42335 M42352 #>    1:  5502123  74988  29007   4223  17008   5636  96913  31056  33430  35558 #>    2: 17475172  66278 101935  34251  14937   9552 124745  66036  39595 652059 #>    3:  6423459  74225  51295  14090  32971   9104  44266  23363  39645  62630 #>    4:  4246983  63809  31054   6151   8054  15148  77365  40193  46686  92981 #>    5:  2780633  40804   8307   3715  31370   5993  24081  16319  25583  31037 #>   ---                                                                         #>  355:  1407294  67664  36157     NA  29194  15652  54919  52317  78413  38453 #>  356:  1856043  34332  29877  30817   5029   4603  42309  17973  25751  12967 #>  357: 10131966  57310  22374     NA  19358   9598 110335  40228  34299 108341 #>  358:       NA  26670   8525   7059  13231   9698  36055  29644  22465  19287 #>  359: 27087992  95140  66285  20229  35845  18570 185546  45205  60944 149210 #>       M42856 M42913 #>    1:  23369  21931 #>    2:  28220  27811 #>    3:  13148  25018 #>    4:  22845  23620 #>    5:  29122  41337 #>   ---               #>  355:  33084 195136 #>  356:  15268  31577 #>  357:  52714  33244 #>  358:  27299  36462 #>  359:  35991 186372 #>   #>  ***  @featureData (ID:  featureID ) *** #>       PATHWAY_SORTORDER                  BIOCHEMICAL SUPER_PATHWAY #>    1:               986              1,2-propanediol         Lipid #>    2:              1805         1,3,7-trimethylurate   Xenobiotics #>    3:              1802            1,3-dimethylurate   Xenobiotics #>    4:               583 1,5-anhydroglucitol (1,5-AG)  Carbohydrate #>    5:               591           1,6-anhydroglucose  Carbohydrate #>   ---                                                              #>  887:              <NA>                    X - 19380          <NA> #>  888:              <NA>                    X - 19437          <NA> #>  889:              <NA>                    X - 19556          <NA> #>  890:              <NA>                    X - 19573          <NA> #>  891:              <NA>                    X - 19574          <NA> #>                                            SUB_PATHWAY COMP_ID  PLATFORM #>    1:                                    Ketone bodies   38002     GC/MS #>    2:                              Xanthine metabolism   34404 LC/MS Neg #>    3:                              Xanthine metabolism   32391     GC/MS #>    4: Glycolysis, gluconeogenesis, pyruvate metabolism   20675 LC/MS Neg #>    5: Glycolysis, gluconeogenesis, pyruvate metabolism   21049     GC/MS #>   ---                                                                    #>  887:                                             <NA>   42856 LC/MS Neg #>  888:                                             <NA>   42913 LC/MS Neg #>  889:                                             <NA>   43112 LC/MS Pos #>  890:                                             <NA>   43129 LC/MS Neg #>  891:                                             <NA>   43130 LC/MS Neg #>                       RI               MASS  PUBCHEM        CAS   KEGG   HMDb_ID #>    1:               1041                117     <NA>   57-55-6; C00583 HMDB01881 #>    2:               1988              209.1    79437 5415-44-1; C16361 HMDB02123 #>    3:               1937 325.10000000000002    70346 944-73-0 ;   <NA> HMDB01857 #>    4:                808 163.19999999999999     <NA>  154-58-5; C07326 HMDB02712 #>    5:             1679.5              204.1 11412545  498-07-7;   <NA> HMDB00640 #>   ---                                                                            #>  887:               2287              412.4     <NA>       <NA>   <NA>      <NA> #>  888: 1150.0999999999999              397.1     <NA>       <NA>   <NA>      <NA> #>  889: 4249.8999999999996              404.9     <NA>       <NA>   <NA>      <NA> #>  890:             3906.5              403.2     <NA>       <NA>   <NA>      <NA> #>  891:             4045.7 307.10000000000002     <NA>       <NA>   <NA>      <NA> #>       COMP_IDstr featureID #>    1:     M38002    M38002 #>    2:     M34404    M34404 #>    3:     M32391    M32391 #>    4:     M20675    M20675 #>    5:     M21049    M21049 #>   ---                      #>  887:     M42856    M42856 #>  888:     M42913    M42913 #>  889:     M43112    M43112 #>  890:     M43129    M43129 #>  891:     M43130    M43130 #>   #>  ***  @sampleData (ID:  sampleID ) *** #>        sampleID      AGE GENDER      BMI ETHNICITY T2D GC/MS LC/MS NEG LC/MS POS #>    1: QMDiab254 53.10335      0 32.05128         1   0     1         1         1 #>    2: QMDiab290 39.79192      1 30.51426         4   0     1         1         1 #>    3:  QMDiab54 36.82136      0 24.16831         1   0     1         1         1 #>    4:  QMDiab55 34.75975      0 44.44444         1   1     1         1         1 #>    5: QMDiab319 50.17933      1 27.18090         1   1     1         1         1 #>   ---                                                                            #>  355:  QMDiab70 35.40315      1 33.83403         1   1     3         3         3 #>  356: QMDiab118 49.06229      1 25.64494         1   0     3         3         3 #>  357:  QMDiab65 47.22245      1 23.38435         1   0     3         3         3 #>  358: QMDiab248 56.39151      0 27.58621         1   1     3         3         3 #>  359:   QMDiab4 24.22450      0 41.66521         1   0     3         3         3 #>       ID_injection_order QCsample #>    1:                  1        0 #>    2:                  2        0 #>    3:                  3        0 #>    4:                  4        0 #>    5:                  5        0 #>   ---                             #>  355:                355        0 #>  356:                356        0 #>  357:                357        0 #>  358:                358        0 #>  359:                359        0 #>   #>  ***  @miscData  *** #>  integer(0) #>   #>  ***  @logs  *** #>  09/03/22 21:41:31: Import data from: /Library/Frameworks/R.framework/Versions/4.1/Resources/library/metabolomicsR/extdata/QMDiab_metabolomics_OrigScale.xlsx . #>  09/03/22 21:41:31: Initiate data: 359 samples and 891 features. #>  09/03/22 21:41:31: Update data, action: change_featureID, 359 samples and 891 features.  #>   #>  09/03/22 21:41:32: Run QC pipeline. #>  09/03/22 21:41:32: Filter data with a constant column, removed 28 features.  #>  09/03/22 21:41:32: Update data, 359 samples and 891 features.  #>  09/03/22 21:41:33: Filter data with a missing rate >= 0.5, removed 77 features.  #>  09/03/22 21:41:33: Update data, 359 samples and 891 features.  #>  09/03/22 21:41:33: Replace outliers using `winsorize` method 5 SDs.  #>  09/03/22 21:41:57: Update data, action: injection_order, 359 samples and 891 features.  #>  09/03/22 21:41:57: Update data, 359 samples and 891 features. v_features <- featureData(df_urine_QC)$featureID[1:16]  plot_injection_order(df_urine_QC, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features)"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"normalization-1-batch-norm","dir":"","previous_headings":"","what":"Normalization 1: batch-norm","title":"Tools for metabolomic data","text":"Normalization 2: QCmatrix_norm  Normalization 3: nearestQC_norm  Normalization 4: modelling_norm","code":"df_urine_QC_norm <- batch_norm(df_urine_QC) #>   #>  Platform information in @featureData: #>  platforms #>      GC/MS LC/MS Neg LC/MS Pos  #>        154       417       320  #>   #>   #>  Sample size in platform GC/MS #>    1   2   3  #>  120 120 119 p1 <- plot_injection_order(df_urine_QC_norm, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p1 df_urine_QC_norm <- QCmatrix_norm(df_urine_QC) #>   #>  Platform information in @featureData: #>  platforms #>      GC/MS LC/MS Neg LC/MS Pos  #>        154       417       320  #>   #>   #>  Sample size in platform GC/MS #>    1   2   3  #>  120 120 119  #>   #>   #>   Number of QC samples n = 35 p2 <- plot_injection_order(df_urine_QC_norm, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p2 df_urine_QC_norm <- nearestQC_norm(df_urine_QC) #>   #>  The top ten sample ID (in injection order): #>  QMDiab254, QMDiab290, QMDiab54, QMDiab55, QMDiab319, QMDiab255, QMDiab190, QMDiab247, QMDiab209, MTRX-QMDiab94  #>   #>  Platform information in @featureData: #>  platforms #>      GC/MS LC/MS Neg LC/MS Pos  #>        154       417       320  #>   #>   #>  Sample size in platform GC/MS #>    1   2   3  #>  120 120 119  #>   #>   #>   Number of QC samples n = 35 p3 <- plot_injection_order(df_urine_QC_norm, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p3 df_urine_QC_norm_LOESS <- modelling_norm(df_urine_QC, method = \"LOESS\") #>   #>  Platform information in @featureData: #>  platforms #>      GC/MS LC/MS Neg LC/MS Pos  #>        154       417       320  #>   #>   #>  Sample size in platform GC/MS #>    1   2   3  #>  120 120 119  #>   #>   #>   Number of QC samples n = 35 p4 <- plot_injection_order(df_urine_QC_norm, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p4 # to benchmark the performance df_urine_QC_norm_KNN <- modelling_norm(df_urine_QC, method = \"KNN\", k = 3)  #>   #>  Platform information in @featureData: #>  platforms #>      GC/MS LC/MS Neg LC/MS Pos  #>        154       417       320  #>   #>   #>  Sample size in platform GC/MS #>    1   2   3  #>  120 120 119  #>   #>   #>   Number of QC samples n = 35 p5 <- plot_injection_order(df_urine_QC_norm_KNN, color = \"QCsample\", shape = \"GC/MS\", feature_name = v_features) p5"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"dimensional-reduction","dir":"","previous_headings":"","what":"Dimensional reduction","title":"Tools for metabolomic data","text":"Dimensional reduction strategies metabolites data can used detect batch effects, sample outliers, real biological subgroups. included principal components analysis (PCA), manifold approximation projection (UMAP), t-distributed stochastic neighbor embedding (tSNE) methods. Figures displayed ggplot2 style.","code":"df_plasma_PCA <- run_PCA(df_plasma_QC)  plot_PCA(df_plasma_PCA, color =\"ETHNICITY\", shape = \"T2D\") plot_UMAP(df_plasma_QC, color =\"ETHNICITY\", shape = \"T2D\") plot_tsne(df_plasma_QC, color =\"ETHNICITY\", shape = \"T2D\")"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"correlation","dir":"","previous_headings":"","what":"Correlation","title":"Tools for metabolomic data","text":"","code":"# pairwise correlation of metabolites between two different fluids  # plasma vs urine dd <- correlation(df_plasma_QC, df_urine_QC, method = \"spearman\") #>  Identify  356  samples in data A, and  359  samples in data B, with  312  overlap samples. #>  Identify  545  features in data A, and  786  features in data B, with  248  overlap features. dd <- merge(dd, featureData(df_plasma_QC), by.x = \"term\", by.y = \"featureID\")  p <- ggplot(dd, aes(x = SUPER_PATHWAY, y = r, fill = SUPER_PATHWAY)) +   geom_boxplot() +   geom_jitter( size=0.4, alpha=0.9) +   scale_fill_manual(values = RColorBrewer::brewer.pal(9, \"Set1\")) +   theme(axis.text.x = element_text(angle = 60, hjust = 1))+   labs(title = \"plasma vs urine\")  p # plasma vs saliva dd <- correlation(df_plasma_QC, df_saliva_QC, method = \"spearman\") #>  Identify  356  samples in data A, and  321  samples in data B, with  319  overlap samples. #>  Identify  545  features in data A, and  364  features in data B, with  137  overlap features. dd <- merge(dd, featureData(df_plasma_QC), by.x = \"term\", by.y = \"featureID\")  p2 <- ggplot(dd, aes(x = SUPER_PATHWAY, y = r, fill = SUPER_PATHWAY)) +   geom_boxplot() +   geom_jitter(size=0.4, alpha=0.9) +   scale_fill_manual(values = RColorBrewer::brewer.pal(9, \"Set1\")) +   theme(axis.text.x = element_text(angle = 60, hjust = 1)) +   labs(title = \"plasma vs saliva\")   # urine vs saliva dd <- correlation(df_urine_QC, df_saliva_QC, method = \"spearman\") #>  Identify  359  samples in data A, and  321  samples in data B, with  282  overlap samples. #>  Identify  786  features in data A, and  364  features in data B, with  155  overlap features. dd <- merge(dd, featureData(df_urine_QC), by.x = \"term\", by.y = \"featureID\")  p3 <- ggplot(dd, aes(x = SUPER_PATHWAY, y = r, fill = SUPER_PATHWAY)) +   geom_boxplot() +   geom_jitter(size=0.4, alpha=0.9) +    scale_fill_manual(values = RColorBrewer::brewer.pal(9, \"Set1\")) +   theme(axis.text.x = element_text(angle = 60, hjust = 1)) +   labs(title = \"urine vs saliva\")   p <- cowplot::plot_grid(p2, p3, nrow = 1) p"},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"association-analysis-1-linear-regression","dir":"","previous_headings":"","what":"Association analysis 1: linear regression","title":"Tools for metabolomic data","text":"Association analysis metabolites interested outcomes implemented “regression” function, supporting general linear regression, logistic regression, poisson regression, proportional hazards regression model, linear mixed-effects model, logistic linear mixed-effects model, without covariates. regression models can run selected metabolites metabolites single job support parallel computing.","code":"fit_lm <- regression(object = df_plasma_scale, phenoData = NULL, model = \"lm\", outcome = \"BMI\",                           covars = c(\"AGE\", \"GENDER\", \"ETHNICITY\"), factors = \"ETHNICITY\") #>  Regression for 1 outcome(s).  #>   #>  Build formula using covars and outcomes.  #>   #>  Run `lm` model for 545 features:  #>  BMI ~ AGE + GENDER + ETHNICITY + `feature`  head(fit_lm) #>       term     estimate std.error   statistic   p.value   n outcome model #>  1: M43027 -0.287065678 0.2909369 -0.98669400 0.3244762 356     BMI    lm #>  2: M11953  0.285148910 0.2945365  0.96812761 0.3336511 356     BMI    lm #>  3: M38002  0.063510129 0.2960686  0.21451153 0.8302735 356     BMI    lm #>  4: M34404  0.459471416 0.3109698  1.47754337 0.1404319 356     BMI    lm #>  5: M35963 -0.008355339 0.2942752 -0.02839294 0.9773650 356     BMI    lm #>  6: M35728  0.280617622 0.2929012  0.95806251 0.3386944 356     BMI    lm #>     p.value.adj #>  1:           1 #>  2:           1 #>  3:           1 #>  4:           1 #>  5:           1 #>  6:           1 dd <- merge(fit_lm, featureData(df_plasma_scale), by.x = \"term\", by.y = \"featureID\")  dd[, sig := ifelse(p.value.adj < 0.1, 1, 0)] plot_volcano(dd, color = NULL, label = \"BIOCHEMICAL\")"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"association-analysis-2-logistic-regression","dir":"","previous_headings":"","what":"Association analysis 2: logistic regression","title":"Tools for metabolomic data","text":"","code":"fit_glm <- regression(object = df_plasma_scale, phenoData = NULL, model = \"logistic\", outcome = \"T2D\",                          covars = c(\"AGE\",\"GENDER\", \"ETHNICITY\"), factors = \"ETHNICITY\") #>  Regression for 1 outcome(s).  #>   #>  Build formula using covars and outcomes.  #>   #>  Run `logistic` model for 545 features:  #>  T2D ~ AGE + GENDER + ETHNICITY + `feature`  head(fit_glm) #>       term    estimate std.error   statistic    p.value   n outcome    model #>  1: M43027 -0.01513772 0.1249949 -0.12110676 0.90360647 356     T2D logistic #>  2: M11953  0.07313020 0.1258779  0.58096115 0.56126664 356     T2D logistic #>  3: M38002  0.01273692 0.1286644  0.09899333 0.92114357 356     T2D logistic #>  4: M34404  0.02452545 0.1413296  0.17353372 0.86223193 356     T2D logistic #>  5: M35963  0.35664968 0.1338055  2.66543322 0.00768892 356     T2D logistic #>  6: M35728  0.01557804 0.1306566  0.11922888 0.90509402 356     T2D logistic #>     p.value.adj #>  1:           1 #>  2:           1 #>  3:           1 #>  4:           1 #>  5:           1 #>  6:           1 dd <- merge(fit_glm, featureData(df_plasma_scale), by.x = \"term\", by.y = \"featureID\")  dd[, sig := ifelse(p.value.adj < 0.1, 1, 0)]  plot_volcano(dd, label = \"BIOCHEMICAL\")"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"association-analysis-3-multiple-outcomes-using-model--auto","dir":"","previous_headings":"","what":"Association analysis 3: multiple outcomes, using model = “auto”","title":"Tools for metabolomic data","text":"","code":"fit2 <- regression(object = df_plasma_scale, phenoData = NULL, model = \"auto\", outcome = c(\"BMI\", \"T2D\"),                          covars = c(\"AGE\",\"GENDER\", \"ETHNICITY\"), factors = \"ETHNICITY\") #>  Regression for 2 outcome(s).  #>   #>  Build formula using covars and outcomes.  #>  model = `auto`, to infer `lm` or `logistic`  #>   #>  Run `lm` model for 545 features:  #>  BMI ~ AGE + GENDER + ETHNICITY + `feature`  #>  Build formula using covars and outcomes.  #>  model = `auto`, to infer `lm` or `logistic`  #>   #>  Run `logistic` model for 545 features:  #>  T2D ~ AGE + GENDER + ETHNICITY + `feature`  head(fit2) #>       term     estimate std.error   statistic   p.value   n outcome model #>  1: M43027 -0.287065678 0.2909369 -0.98669400 0.3244762 356     BMI    lm #>  2: M11953  0.285148910 0.2945365  0.96812761 0.3336511 356     BMI    lm #>  3: M38002  0.063510129 0.2960686  0.21451153 0.8302735 356     BMI    lm #>  4: M34404  0.459471416 0.3109698  1.47754337 0.1404319 356     BMI    lm #>  5: M35963 -0.008355339 0.2942752 -0.02839294 0.9773650 356     BMI    lm #>  6: M35728  0.280617622 0.2929012  0.95806251 0.3386944 356     BMI    lm #>     p.value.adj #>  1:           1 #>  2:           1 #>  3:           1 #>  4:           1 #>  5:           1 #>  6:           1 dd2 <- merge(fit2, featureData(df_plasma_scale), by.x = \"term\", by.y = \"featureID\")  dd2[, sig := ifelse(p.value.adj < 0.1, 1, 0)] plot_volcano(dd2, color = \"outcome\", label = \"BIOCHEMICAL\")"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"association-analysis-4-extension-to-other-regression-models","dir":"","previous_headings":"","what":"Association analysis 4: extension to other regression models","title":"Tools for metabolomic data","text":"provided various regression models metabolomicsR package. show extend regression function regression models.","code":"# for example, to fit a Negative Binomial Generalized Linear Model, we first define a `fit_glm.nb` function.   library(MASS)  fit_glm.nb <- function(data = NULL, formula = NULL, keep = NULL) {   v_var <- all.vars(formula)   df <- data[, v_var, with = FALSE]   fit <- tryCatch(     do.call(\"glm.nb\", args = list(data = df, formula = formula)),     error = function(e) {       cat(paste0(\"Failed to fit model: \", e), \"\\n\")     })   if(inherits(fit, \"glm\")) {     res  <- as.data.table(broom::tidy(fit))     if(! is.null(keep)) res <- res[res$term %in% keep, ]     res$n <- length(fit$residuals)   } else {     res <- list(estimate = NA)   }   return(res) }  # the outcome 'toy_y' was only created to demonstrate the usage to extend regression models  sampleData(df_plasma_scale)[, toy_y := round(BMI, 0)]  # equivalent to: if(0) {   dd <- sampleData(df_plasma_scale)    dd[, toy_y := round(BMI, 0)]   sampleData(df_plasma_scale)  <- dd }  fit <- regression(object = df_plasma_scale, phenoData = NULL, model = \"glm.nb\", outcome = \"toy_y\",                   covars = c(\"AGE\",\"GENDER\", \"ETHNICITY\"), factors = \"ETHNICITY\",                    feature_name = featureData(df_plasma_scale)$featureID[1:50]) #>  Regression for 1 outcome(s).  #>   #>  Build formula using covars and outcomes.  #>   #>  Run `glm.nb` model for 50 features:  #>  toy_y ~ AGE + GENDER + ETHNICITY + `feature` dd <- merge(fit, featureData(df_plasma_scale), by.x = \"term\", by.y = \"featureID\") dd[, sig := ifelse(p.value.adj < 0.1, 1, 0)] plot_volcano(dd, color = NULL, label = \"BIOCHEMICAL\")"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"roc","dir":"","previous_headings":"","what":"ROC","title":"Tools for metabolomic data","text":"","code":"# ROC for one variable, to add a wrapped for many metabolites separately plot_ROC(object = df_plasma_scale, y = \"T2D\", x = \"M00527\") plot_ROC(object = df_plasma_scale, y = \"T2D\", x = c(\"M00527\", \"BMI\"))"},{"path":"https://XikunHan.github.io/metabolomicsR/index.html","id":"roc-compare-two-models","dir":"","previous_headings":"","what":"ROC: compare two models","title":"Tools for metabolomic data","text":"","code":"p <- plot_ROC(object = df_plasma_scale, y = \"T2D\",           model_a = c(\"BMI\", \"AGE\", \"GENDER\"),           model_b = c(\"M00527\", \"BMI\", \"AGE\", \"GENDER\"))  print(p) sessionInfo() #>  R version 4.1.2 (2021-11-01) #>  Platform: x86_64-apple-darwin17.0 (64-bit) #>  Running under: macOS Big Sur 10.16 #>   #>  Matrix products: default #>  BLAS:   /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRblas.0.dylib #>  LAPACK: /Library/Frameworks/R.framework/Versions/4.1/Resources/lib/libRlapack.dylib #>   #>  locale: #>  [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8 #>   #>  attached base packages: #>  [1] stats     graphics  grDevices utils     datasets  methods   base      #>   #>  other attached packages: #>  [1] MASS_7.3-55         plotROC_2.2.1       cowplot_1.1.1       #>  [4] ggplot2_3.3.5       data.table_1.14.2   metabolomicsR_1.0.0 #>   #>  loaded via a namespace (and not attached): #>    [1] insight_0.16.0         doParallel_1.0.17      RColorBrewer_1.1-2     #>    [4] backports_1.4.1        tools_4.1.2            utf8_1.2.2             #>    [7] R6_2.5.1               statsExpressions_1.3.0 DBI_1.1.2              #>   [10] colorspace_2.0-3       withr_2.5.0            tidyselect_1.1.2       #>   [13] compiler_4.1.2         progressr_0.10.0       performance_0.8.0      #>   [16] cli_3.2.0              prismatic_1.1.0        labeling_0.4.2         #>   [19] bayestestR_0.11.5      scales_1.1.1           mvtnorm_1.1-3          #>   [22] mc2d_0.1-21            pbapply_1.5-0          askpass_1.1            #>   [25] stringr_1.4.0          digest_0.6.29          rmarkdown_2.12         #>   [28] M3C_1.14.0             WRS2_1.1-3             pkgconfig_2.0.3        #>   [31] htmltools_0.5.2        parallelly_1.30.0      umap_0.2.7.0           #>   [34] fastmap_1.1.0          highr_0.9              rlang_1.0.2            #>   [37] readxl_1.3.1           rstudioapi_0.13        FNN_1.1.3              #>   [40] farver_2.1.0           generics_0.1.2         jsonlite_1.8.0         #>   [43] gtools_3.9.2           dplyr_1.0.8            magrittr_2.0.2         #>   [46] parameters_0.16.0      patchwork_1.1.1        Matrix_1.4-0           #>   [49] Rcpp_1.0.8             munsell_0.5.0          fansi_1.0.2            #>   [52] reticulate_1.24        lifecycle_1.0.1        pROC_1.18.0            #>   [55] stringi_1.7.6          yaml_2.3.5             Rtsne_0.15             #>   [58] plyr_1.8.6             matrixcalc_1.0-5       grid_4.1.2             #>   [61] paletteer_1.4.0        listenv_0.8.0          parallel_4.1.2         #>   [64] ggrepel_0.9.1          crayon_1.5.0           doSNOW_1.0.20          #>   [67] lattice_0.20-45        zeallot_0.1.0          knitr_1.37             #>   [70] pillar_1.7.0           boot_1.3-28            corpcor_1.6.10         #>   [73] effectsize_0.6.0.1     reshape2_1.4.4         codetools_0.2-18       #>   [76] glue_1.6.2             evaluate_0.15          png_0.1-7              #>   [79] vctrs_0.3.8            foreach_1.5.2          MatrixModels_0.5-0     #>   [82] cellranger_1.1.0       gtable_0.3.0           openssl_2.0.0          #>   [85] purrr_0.3.4            BayesFactor_0.9.12-4.3 tidyr_1.2.0            #>   [88] future_1.24.0          rematch2_2.1.2         reshape_0.8.8          #>   [91] assertthat_0.2.1       datawizard_0.3.0       xfun_0.30              #>   [94] broom_0.7.12           correlation_0.8.0      RSpectra_0.16-0        #>   [97] coda_0.19-4            tibble_3.1.6           snow_0.4-4             #>  [100] iterators_1.0.14       ggstatsplot_0.9.1      cluster_2.1.2          #>  [103] globals_0.14.0         ellipsis_0.3.2"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/Metabolite-class.html","id":null,"dir":"Reference","previous_headings":"","what":"The Metabolite class — Metabolite-class","title":"The Metabolite class — Metabolite-class","text":"Metabolite object representation metabolomic data, metabolomic annotation, sample annotation.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/Metabolite-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"The Metabolite class — Metabolite-class","text":"assayData data.frame data.table metabolite measurements (peak area data normalized data, sample [row] * feature [column]). featureData data.frame data.table metabolite annotation (chemical annotation) sampleData data.frame data.table sample annotation (sample meta data). featureID character metabolite ID column (feature file column names data), default: CHEM_ID (provided Metabolon file). sampleID character sample ID column (sample first column data), default: PARENT_SAMPLE_NAME (provided Metabolon file). logs Log information data analysis process. miscData Ancillary data.","code":""},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/reference/QC_pipeline.html","id":null,"dir":"Reference","previous_headings":"","what":"quality control pipeline — QC_pipeline","title":"quality control pipeline — QC_pipeline","text":"function run QC steps Metabolite object","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/QC_pipeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"quality control pipeline — QC_pipeline","text":"","code":"QC_pipeline(   object,   filter_column_constant = TRUE,   filter_column_missing_rate_threshold = 0.5,   filter_row_missing_rate_threshold = NULL,   replace_outlier_method = NULL,   nSD = 5,   impute_method = \"half-min\",   verbose = TRUE )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/QC_pipeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"quality control pipeline — QC_pipeline","text":"object object, data.frame, data.table Metabolite. filter_column_constant logical value, whether filter columns (features) constant value. filter_column_missing_rate_threshold numeric threshold filter columns (features) missing rate, default: 0.5. values: 0.2, 0.8. NULL, skip step. filter_row_missing_rate_threshold numeric threshold filter rows (samples) missing rate. Default: NULL, skip step. values: 0.5, 0.2, 0.8. replace_outlier_method Method replace outlier value, see replace_outlier. nSD Define N times SD outliers. impute_method Imputation method, default method half minimum value (`half-min`) metabolite. Currently support 'half-min', \"median\", \"mean\", \"zero\". verbose print log information.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/QCmatrix_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"QCmatrix normalization — QCmatrix_norm","title":"QCmatrix normalization — QCmatrix_norm","text":"Normalization data median value QC samples batch. metabolite, values (eg. raw peak area data) divided median value QC samples batch. QC samples metabolite batches specified (see parameters ).","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/QCmatrix_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"QCmatrix normalization — QCmatrix_norm","text":"","code":"QCmatrix_norm(   object,   feature_platform = \"PLATFORM\",   QC_ID_pattern = \"MTRX\",   test = FALSE,   verbose = TRUE )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/QCmatrix_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"QCmatrix normalization — QCmatrix_norm","text":"object Metabolite object. feature annotation slot `feature`, platform column provided metabolite measurement platform (eg. `PLATFORM`). values `PLATFORM` column (eg. `Neg`, `Polar`, `Pos Early`, `Pos Late`) column names sample annotation `sample` determine batches samples. feature_platform column name feature platform metabolite measurements (eg. `PLATFORM`). QC_ID_pattern character pattern determine QC samples. Default value: \"MTRX\". test test function first 20 columns. verbose print log information.","code":""},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/reference/QCmatrix_norm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"QCmatrix normalization — QCmatrix_norm","text":"","code":"if (FALSE) { d <- QCmatrix_norm(object = df) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/RSD.html","id":null,"dir":"Reference","previous_headings":"","what":"RSD — RSD","title":"RSD — RSD","text":"calculate RDS (","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/RSD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"RSD — RSD","text":"","code":"RSD(x)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/RSD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"RSD — RSD","text":"x vector","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/RSD.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"RSD — RSD","text":"","code":"if (FALSE) { v <- RSD(x) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/assayData.html","id":null,"dir":"Reference","previous_headings":"","what":"get assayData — assayData","title":"get assayData — assayData","text":"Accessors Metabolite object. Get assayData Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/assayData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get assayData — assayData","text":"","code":"assayData(object)  # S4 method for Metabolite assayData(object)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/assayData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get assayData — assayData","text":"object Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/assayData_set.html","id":null,"dir":"Reference","previous_headings":"","what":"set assayData — assayData<-","title":"set assayData — assayData<-","text":"Accessors Metabolite object. `assayData<-` update assayData Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/assayData_set.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"set assayData — assayData<-","text":"","code":"assayData(object) <- value  # S4 method for Metabolite assayData(object) <- value"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/assayData_set.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"set assayData — assayData<-","text":"object Metabolite object. value new assayData.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/assayData_set.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"set assayData — assayData<-","text":"assayData","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/batch_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"batch normalization — batch_norm","title":"batch normalization — batch_norm","text":"Normalization data median value batch","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/batch_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"batch normalization — batch_norm","text":"","code":"batch_norm(   object,   feature_platform = \"PLATFORM\",   QC_ID_pattern = \"MTRX\",   test = FALSE,   verbose = TRUE )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/batch_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"batch normalization — batch_norm","text":"object Metabolite object. feature annotation slot `feature`, platform column provided metabolite measurement platform (eg. `PLATFORM`). values `PLATFORM` column (eg. `Neg`, `Polar`, `Pos Early`, `Pos Late`) column names sample annotation `sample` determine batches samples. feature_platform column name feature platform metabolite measurements (eg. `PLATFORM`). QC_ID_pattern character pattern determine QC samples. Default value: \"MTRX\". test test function first 20 columns. verbose print log information.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/batch_norm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"batch normalization — batch_norm","text":"Metabolite object normalization.","code":""},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/reference/bridge.html","id":null,"dir":"Reference","previous_headings":"","what":"bridge different data sets based on conversion factors — bridge","title":"bridge different data sets based on conversion factors — bridge","text":"Bridge metabolite data based conversion factor file","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/bridge.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"bridge different data sets based on conversion factors — bridge","text":"","code":"bridge(   object,   conversion_factor_data = NULL,   QC_ID_pattern = \"MTRX\",   verbose = TRUE )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/bridge.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"bridge different data sets based on conversion factors — bridge","text":"object Metabolite object. `featureData`, `conversion_factor_ID` column created match conversion_factor_data. conversion_factor_data data set columns `conversion_factor_ID` `conversion_factor_value`. QC_ID_pattern character pattern determine QC samples. Default value: \"MTRX\". Skip QC samples rescale (median value already 1). verbose print log information.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/bridge.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"bridge different data sets based on conversion factors — bridge","text":"Metabolite object multiplying conversion factor.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/column_missing_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"column missing rate — column_missing_rate","title":"column missing rate — column_missing_rate","text":"Calculate column missing rate -- metabolite missingness.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/column_missing_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"column missing rate — column_missing_rate","text":"","code":"column_missing_rate(object)  # S3 method for default column_missing_rate(object)  # S3 method for Metabolite column_missing_rate(object)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/column_missing_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"column missing rate — column_missing_rate","text":"object object, data.frame, data.table Metabolite.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/column_missing_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"column missing rate — column_missing_rate","text":"Returns vector missing rate column","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/column_missing_rate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"column missing rate — column_missing_rate","text":"","code":"if (FALSE) { # for a data.frame or data.table v <- column_missing_rate(object = df)  # to skip the first column (eg. ID) v <- column_missing_rate(object = df[, -1]) }  if (FALSE) {  # for a Metabolite object v <- column_missing_rate(object)  }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/correlation.html","id":null,"dir":"Reference","previous_headings":"","what":"correlation of features between two Metabolite objects — correlation","title":"correlation of features between two Metabolite objects — correlation","text":"Calculate correlation features two Metabolite objects","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/correlation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"correlation of features between two Metabolite objects — correlation","text":"","code":"correlation(   object_X = NULL,   object_Y = NULL,   method = \"pearson\",   verbose = TRUE )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/correlation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"correlation of features between two Metabolite objects — correlation","text":"object_X first Metabolite object. object_Y second Metabolite object. method character string calculate correlation coefficient. One \"pearson\" (default), \"kendall\", \"spearman\". verbose print log information.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/correlation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"correlation of features between two Metabolite objects — correlation","text":"data.table correlation coefficients.","code":""},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/reference/create_Metabolite.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a Metabolite object — create_Metabolite","title":"Create a Metabolite object — create_Metabolite","text":"Create Metabolite object three input data sets: 1) metabolite measurements (eg. peak area data normalized data), 2) metabolite annotation (eg. chemical annotation) 3) sample annotation (eg. sample meta data)","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/create_Metabolite.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a Metabolite object — create_Metabolite","text":"","code":"create_Metabolite(   assayData,   featureData,   sampleData,   featureID,   sampleID,   logs )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/create_Metabolite.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a Metabolite object — create_Metabolite","text":"assayData data.frame data.table metabolite measurements (peak area data normalized data, sample [row] * feature [column]). featureData data.frame data.table metabolite annotation (chemical annotation) sampleData data.frame data.table sample annotation (sample meta data). featureID character metabolite ID column (feature file column names data), default: CHEM_ID (provided Metabolon file). sampleID character sample ID column (sample first column data), default: PARENT_SAMPLE_NAME (provided Metabolon file). logs Log information.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/create_Metabolite.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a Metabolite object — create_Metabolite","text":"Metabolite object slots: assayData, featureData, sampleData.","code":""},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/reference/create_Metabolite.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a Metabolite object — create_Metabolite","text":"","code":"if (FALSE) {  df <- create_Metabolite(assayData = df_data, featureData = df_feature, sampleData =  df_sample)  }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/df_plasma.html","id":null,"dir":"Reference","previous_headings":"","what":"Example data. — df_plasma","title":"Example data. — df_plasma","text":"dataset containing 356 samples 758 features.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/df_plasma.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example data. — df_plasma","text":"","code":"data(df_plasma)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/df_plasma.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example data. — df_plasma","text":"object class Metabolite length 1.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/featureData.html","id":null,"dir":"Reference","previous_headings":"","what":"get featureData — featureData","title":"get featureData — featureData","text":"Accessors Metabolite object. Get featureData Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/featureData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get featureData — featureData","text":"","code":"featureData(object)  # S4 method for Metabolite featureData(object)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/featureData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get featureData — featureData","text":"object Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/featureData_set.html","id":null,"dir":"Reference","previous_headings":"","what":"set featureData — featureData<-","title":"set featureData — featureData<-","text":"Accessors Metabolite object. `featureData<-` update featureData Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/featureData_set.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"set featureData — featureData<-","text":"","code":"featureData(object) <- value  # S4 method for Metabolite featureData(object) <- value"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/featureData_set.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"set featureData — featureData<-","text":"object Metabolite object. value new featureData.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_column_constant.html","id":null,"dir":"Reference","previous_headings":"","what":"filter columns if values are constant — filter_column_constant","title":"filter columns if values are constant — filter_column_constant","text":"Remove columns values constant","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_column_constant.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filter columns if values are constant — filter_column_constant","text":"","code":"filter_column_constant(object, verbose)  # S3 method for default filter_column_constant(object, verbose = TRUE)  # S3 method for Metabolite filter_column_constant(object, verbose = TRUE)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_column_constant.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filter columns if values are constant — filter_column_constant","text":"object object, data.frame, data.table Metabolite. verbose print log information.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_column_constant.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"filter columns if values are constant — filter_column_constant","text":"","code":"if (FALSE) {  # for a data.frame or data.table v <- filter_column_missing_rate(object = df)  # if skip the first column (eg. ID) v <- filter_column_missing_rate(object = df[, -1])  }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_column_missing_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"filter columns using missing rate — filter_column_missing_rate","title":"filter columns using missing rate — filter_column_missing_rate","text":"Remove columns specific missing rate threshold.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_column_missing_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filter columns using missing rate — filter_column_missing_rate","text":"","code":"filter_column_missing_rate(object, threshold, verbose)  # S3 method for default filter_column_missing_rate(object, threshold = 0.5, verbose = TRUE)  # S3 method for Metabolite filter_column_missing_rate(object, threshold = 0.5, verbose = TRUE)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_column_missing_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filter columns using missing rate — filter_column_missing_rate","text":"object object, data.frame, data.table Metabolite. threshold missing rate threshold, default 0.5. values: 0.2, 0.8. verbose print log information.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_column_missing_rate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"filter columns using missing rate — filter_column_missing_rate","text":"","code":"if (FALSE) {  d <- filter_column_missing_rate(object)  }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_row_missing_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"filter rows using missing rate — filter_row_missing_rate","title":"filter rows using missing rate — filter_row_missing_rate","text":"Remove samples specific missing rate threshold.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_row_missing_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"filter rows using missing rate — filter_row_missing_rate","text":"","code":"filter_row_missing_rate(object, threshold, verbose)  # S3 method for default filter_row_missing_rate(object, threshold = 0.5, verbose = TRUE)  # S3 method for Metabolite filter_row_missing_rate(object, threshold = 0.5, verbose = TRUE)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_row_missing_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"filter rows using missing rate — filter_row_missing_rate","text":"object object, data.frame, data.table Metabolite. threshold missing rate threshold, default 0.5. values: 0.2, 0.8. verbose print log information.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/filter_row_missing_rate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"filter rows using missing rate — filter_row_missing_rate","text":"","code":"if (FALSE) {  d <- filter_row_missing_rate(object)  }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/fit_lm.html","id":null,"dir":"Reference","previous_headings":"","what":"available regression methods — fit_lm","title":"available regression methods — fit_lm","text":"`fit_lm`: linear regression model lm. `fit_logistic`: logistic regression model glm. `fit_poisson`: poisson regression model glm. `fit_cox`: proportional hazards regression model coxph. `fit_lme`: linear mixed-effects model lme. `fit_glmer`: logistic linear mixed-effects model glmer. `fit_lmer`: linear mixed-effects model lmer.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/fit_lm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"available regression methods — fit_lm","text":"","code":"fit_lm(data = NULL, formula = NULL, keep = NULL)  fit_logistic(data = NULL, formula = NULL, keep = NULL)  fit_poisson(data = NULL, formula = NULL, keep = NULL)  fit_cox(data = NULL, formula = NULL, keep = NULL)  fit_lme(data = NULL, formula = NULL, keep = NULL, ...)  fit_glmer(data = NULL, formula = NULL, keep = NULL, ...)  fit_lmer(data = NULL, formula = NULL, keep = NULL, ...)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/fit_lm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"available regression methods — fit_lm","text":"data data.table variables fitted. formula \"formula\" object fitted. keep Variables keep regression results. ... arguments passed regression model.","code":""},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/reference/genuMet_makefeature.html","id":null,"dir":"Reference","previous_headings":"","what":"distinguish genuine untargeted metabolic features without QC samples — genuMet_makefeature","title":"distinguish genuine untargeted metabolic features without QC samples — genuMet_makefeature","text":"makefeature function genuMet uses Metabolite object input. genuMet R package used  distinguish genuine untargeted metabolic features without quality control samples.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/genuMet_makefeature.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"distinguish genuine untargeted metabolic features without QC samples — genuMet_makefeature","text":"","code":"genuMet_makefeature(object, wsize = 100, ssize = 0.5, defswitch = 0.2)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/genuMet_makefeature.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"distinguish genuine untargeted metabolic features without QC samples — genuMet_makefeature","text":"object Metabolite object. wsize Window size. ssize Slide size. defswitch Definition switch.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/genuMet_makefeature.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"distinguish genuine untargeted metabolic features without QC samples — genuMet_makefeature","text":"<https://github.com/liucaomics/genuMet>","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/genuMet_makefeature.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"distinguish genuine untargeted metabolic features without QC samples — genuMet_makefeature","text":"","code":"if (FALSE) { v <- genuMet_makefeature(df) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/impute.html","id":null,"dir":"Reference","previous_headings":"","what":"impute missing values — impute","title":"impute missing values — impute","text":"impute missing values","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/impute.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"impute missing values — impute","text":"","code":"impute(object, method)  # S3 method for Metabolite impute(object, method = c(\"half-min\", \"median\", \"mean\", \"zero\", \"kNN\"))  # S3 method for default impute(object, method = \"half-min\")  impute_kNN(object)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/impute.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"impute missing values — impute","text":"object object, vector, data.frame, data.table Metabolite. method Imputation method, default method half minimum value (`half-min`) metabolite. Currently support 'half-min', \"median\", \"mean\", \"zero\", \"kNN\".","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/impute.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"impute missing values — impute","text":"default method used vector `impute_kNN`: Imputation using nearest neighbor averaging (kNN) method, input Metabolite object, assayData first transposed row metabolties column samples.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/impute.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"impute missing values — impute","text":"Wei, R., Wang, J., Su, M. et al. Missing Value Imputation Approach Mass Spectrometry-based Metabolomics Data. Sci Rep 8, 663 (2018). https://doi.org/10.1038/s41598-017-19120-0","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/impute.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"impute missing values — impute","text":"","code":"if (FALSE) { d <- impute(object) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/inverse_rank_transform.html","id":null,"dir":"Reference","previous_headings":"","what":"rank-based inverse normal transformation — inverse_rank_transform","title":"rank-based inverse normal transformation — inverse_rank_transform","text":"rank-based inverse normal transformation metabolite.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/inverse_rank_transform.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rank-based inverse normal transformation — inverse_rank_transform","text":"","code":"inverse_rank_transform(x)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/inverse_rank_transform.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rank-based inverse normal transformation — inverse_rank_transform","text":"x vector","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/inverse_rank_transform.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"rank-based inverse normal transformation — inverse_rank_transform","text":"","code":"if (FALSE) { v <- inverse_rank_transform(x) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/is_outlier.html","id":null,"dir":"Reference","previous_headings":"","what":"is outlier — is_outlier","title":"is outlier — is_outlier","text":"outlier","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/is_outlier.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"is outlier — is_outlier","text":"","code":"is_outlier(object, nSD = 5)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/is_outlier.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"is outlier — is_outlier","text":"object object, vector. nSD N times SD outliers. Return TRUE FALSE vector.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/is_outlier.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"is outlier — is_outlier","text":"","code":"if (FALSE) { v <- is_outlier(x) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/load_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Load metabolite data from three separate files — load_data","title":"Load metabolite data from three separate files — load_data","text":"Load metabolite data three separate files (import files using `fread` data.table).","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/load_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load metabolite data from three separate files — load_data","text":"","code":"load_data(   data_path = NULL,   feature_path = NULL,   sample_path = NULL,   featureID = \"CHEM_ID\",   sampleID = \"PARENT_SAMPLE_NAME\" )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/load_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load metabolite data from three separate files — load_data","text":"data_path Path metabolite measurements (peak area data normalized data,  sample [row] * feature [column]) feature_path Path metabolite annotation (chemical annotation) sample_path Path sample annotation (sample meta data) featureID character metabolite ID column (feature file column names data file),  default: CHEM_ID (provided Metabolon file) sampleID character sample ID column (sample file first column data file),  default: PARENT_SAMPLE_NAME (provided Metabolon file).","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/load_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load metabolite data from three separate files — load_data","text":"Metabolite object slots: assayData, featureData, sampleData.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/load_excel.html","id":null,"dir":"Reference","previous_headings":"","what":"Load metabolite data from an excel file — load_excel","title":"Load metabolite data from an excel file — load_excel","text":"Load metabolite data excel file","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/load_excel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load metabolite data from an excel file — load_excel","text":"","code":"load_excel(   path,   data_sheet = NULL,   feature_sheet = NULL,   sample_sheet = NULL,   featureID = \"CHEM_ID\",   sampleID = \"PARENT_SAMPLE_NAME\" )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/load_excel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load metabolite data from an excel file — load_excel","text":"path Path xls/xlsx file. data_sheet integer xlsx sheet number metabolite measurements  (peak area data normalized data, sample [row] * feature [column]) feature_sheet integer xlsx sheet number metabolite annotation (chemical annotation) sample_sheet integer xlsx sheet number sample annotation (sample meta data) featureID character metabolite ID column (feature file column names data file),  default: CHEM_ID (provided Metabolon file) sampleID character sample ID column (sample file first column data file),  default: PARENT_SAMPLE_NAME (provided Metabolon file)","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/load_excel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load metabolite data from an excel file — load_excel","text":"Metabolite object slots: assayData, featureData, sampleData.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/load_excel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load metabolite data from an excel file — load_excel","text":"","code":"file_path <- system.file(\"extdata\", \"QMDiab_metabolomics_OrigScale.xlsx\",  package = \"metabolomicsR\", mustWork = TRUE)  df_plasma <- load_excel(path = file_path, data_sheet = 1, feature_sheet = 4, sample_sheet = 8,  sampleID = \"QMDiab-ID\", featureID = \"BIOCHEMICAL\") #> Warning: NAs introduced by coercion #> Warning: 5 extra features in @assayData: AGE GENDER BMI ETHNICITY T2D ... #> Warning: 2 extra samples in @assayData: QMDiab95 QMDiab237"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/merge_data.html","id":null,"dir":"Reference","previous_headings":"","what":"merge two Metabolite objects — merge_data","title":"merge two Metabolite objects — merge_data","text":"Merge two Metabolite objects.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/merge_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"merge two Metabolite objects — merge_data","text":"","code":"merge_data(object_X = NULL, object_Y = NULL, all = TRUE, verbose = TRUE)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/merge_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"merge two Metabolite objects — merge_data","text":"object_X first Metabolite object. object_Y second Metabolite object. logical; = TRUE: keep metabolites; = FALSE,  keep common metabolites present datasets. verbose print log information.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/merge_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"merge two Metabolite objects — merge_data","text":"Metabolite object merging slots: assayData, featureData, sampleData.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/merge_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"merge two Metabolite objects — merge_data","text":"","code":"# to merge two Metabolite objects # df <- merge_data(df_plasma, df_plasma)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/modelling_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"LOESS normalization — modelling_norm","title":"LOESS normalization — modelling_norm","text":"Normalization data machine learning modelling, eg. locally estimated scatterplot smoothing (LOESS) QC samples batch. metabolite, values (eg. raw peak area data) divided median value QC samples batch. QC samples metabolite batches specified (see parameters ).","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/modelling_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"LOESS normalization — modelling_norm","text":"","code":"modelling_norm(   object,   method = c(\"LOESS\", \"KNN\"),   feature_platform = \"PLATFORM\",   QC_ID_pattern = \"MTRX\",   span = 0.75,   degree = 2,   k = 3,   test = FALSE,   verbose = TRUE )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/modelling_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"LOESS normalization — modelling_norm","text":"object Metabolite object. feature annotation slot `feature`, platform column provided metabolite measurement platform (eg. `PLATFORM`). values `PLATFORM` column (eg. `Neg`, `Polar`, `Pos Early`, `Pos Late`) column names sample annotation `sample` determine batches samples. method Modelling method normalization, currently support LOESS KNN. feature_platform column name feature platform metabolite measurements (eg. `PLATFORM`). QC_ID_pattern character pattern determine QC samples. Default value: \"MTRX\". span default value 0.4 degree default value 2 k Number neighbors KNN modelling (default value 3) test test function first 20 columns. verbose print log information.","code":""},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/reference/modelling_norm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"LOESS normalization — modelling_norm","text":"","code":"if (FALSE) { d <- QCmatrix_norm(object = df) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/nearestQC_norm.html","id":null,"dir":"Reference","previous_headings":"","what":"nearest QC sample normalization — nearestQC_norm","title":"nearest QC sample normalization — nearestQC_norm","text":"Normalization data median value nearest QC samples. metabolite, values (eg. raw peak area data) divided median value nearest QC samples (eg. nearest three QC samples). identify nearest QC samples, `@assayData` ordered injection order.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/nearestQC_norm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"nearest QC sample normalization — nearestQC_norm","text":"","code":"nearestQC_norm(   object,   n_nearest_QCsample = 3,   feature_platform = \"PLATFORM\",   QC_ID_pattern = \"MTRX\",   test = FALSE,   verbose = TRUE )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/nearestQC_norm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"nearest QC sample normalization — nearestQC_norm","text":"object Metabolite object. feature annotation slot `feature`, platform column provided metabolite measurement platform (eg. `PLATFORM`). values `PLATFORM` column (eg. `Neg`, `Polar`, `Pos Early`, `Pos Late`) column names sample annotation `sample` determine batches samples. n_nearest_QCsample Number nearest QC samples calculate median value. default value 3 (outlier QC sample might used n_nearest_QCsample = 1). feature_platform column name feature platform metabolite measurements (eg. `PLATFORM`). QC_ID_pattern character pattern determine QC samples. Default value: \"MTRX\". test test function first 20 columns. verbose print log information.","code":""},{"path":[]},{"path":"https://XikunHan.github.io/metabolomicsR/reference/nearestQC_norm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"nearest QC sample normalization — nearestQC_norm","text":"","code":"if (FALSE) { d <- nearestQC_norm(object = df) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/outlier_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"outlier rate — outlier_rate","title":"outlier rate — outlier_rate","text":"Calculate outlier rate.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/outlier_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"outlier rate — outlier_rate","text":"","code":"outlier_rate(object, nSD)  # S3 method for default outlier_rate(object, nSD = 5)  # S3 method for data.frame outlier_rate(object, nSD = 5)  # S3 method for Metabolite outlier_rate(object, nSD = 5)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/outlier_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"outlier rate — outlier_rate","text":"object object, vector, data.frame, data.table Metabolite. nSD N times SD outliers.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/outlier_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"outlier rate — outlier_rate","text":"Returns vector outlier rate.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/outlier_rate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"outlier rate — outlier_rate","text":"","code":"if (FALSE) { v <- outlier_rate(x) }  if (FALSE) {  # for a Metabolite object v <- outlier_rate(object)  }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/pareto_scale.html","id":null,"dir":"Reference","previous_headings":"","what":"pareto scale transformation — pareto_scale","title":"pareto scale transformation — pareto_scale","text":"pareto scale transformation","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/pareto_scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"pareto scale transformation — pareto_scale","text":"","code":"pareto_scale(x)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/pareto_scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"pareto scale transformation — pareto_scale","text":"x vector","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/pareto_scale.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"pareto scale transformation — pareto_scale","text":"","code":"if (FALSE) { v <- paretoscale(x) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_Metabolite.html","id":null,"dir":"Reference","previous_headings":"","what":"plot a Metabolite object — plot_Metabolite","title":"plot a Metabolite object — plot_Metabolite","text":"Plot Metabolite object including boxplot (add.).","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_Metabolite.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot a Metabolite object — plot_Metabolite","text":"","code":"plot_Metabolite(   object,   plot = \"boxplot\",   x = \"NEG\",   feature_name = NULL,   color = \"NEG\",   shape = \"NEG\",   fill = \"NEG\",   random_select = 16,   size = 0.6,   n_row = 1,   n_col = 1,   ylab = \"featureID\",   height = 10,   width = 10,   save_to_file = NULL )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_Metabolite.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot a Metabolite object — plot_Metabolite","text":"object Metabolite object. plot type plot, current support `boxplot` `betweenstats`. x x-axis coordinate. feature_name vector selected metabolites plot. NULL, randomly select 16 (default) metabolites plot. color column `@sampleData` show color points. shape column `@sampleData` show shape points. fill column `@sampleData` show `fill` histogram. random_select integer, number randomly selected metabolites plot. size Point size. n_row Number rows subfigures `betweenstats` n_col Number columns subfigures `betweenstats` ylab Column name annotate y-axis `betweenstats` (eg. \"BIOCHEMICAL\"), default column: \"featureID\". height Height figure. width Width figure. save_to_file Path save figure.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_Metabolite.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot a Metabolite object — plot_Metabolite","text":"","code":"if (FALSE) { p <- plot_Metabolite(df_m_PCA, plot = \"boxplot\") p }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_PCA.html","id":null,"dir":"Reference","previous_headings":"","what":"plot PCA — plot_PCA","title":"plot PCA — plot_PCA","text":"Plot first two principal components.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_PCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot PCA — plot_PCA","text":"","code":"plot_PCA(object, color = \"NEG\", shape = \"NEG\", size = 1.5)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_PCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot PCA — plot_PCA","text":"object Metabolite object. color column `@sampleData` show color points. shape column `@sampleData` show shape points. size Point size.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_ROC.html","id":null,"dir":"Reference","previous_headings":"","what":"ROC — plot_ROC","title":"ROC — plot_ROC","text":"Plot Receiver Operating Characteristic (ROC) curve metabolites without covariates","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_ROC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ROC — plot_ROC","text":"","code":"plot_ROC(   object = NULL,   y = NULL,   x = NULL,   model_a = NULL,   model_b = NULL,   lab = NULL )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_ROC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ROC — plot_ROC","text":"object Metabolite object. y column name disease (0, 1) x One variable name (x provided, model_a model_b NULL vice versa). model_a Column names model (one covariates, first model). model_b Column names model b (one covariates, second model). lab Title (eg. \"BIOCHEMICAL\"), default value x.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_UMAP.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot UMAP — plot_UMAP","title":"Plot UMAP — plot_UMAP","text":"Plot manifold approximation projection (UMAP). See details umap.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_UMAP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot UMAP — plot_UMAP","text":"","code":"plot_UMAP(object, color = \"NEG\", shape = \"NEG\", size = 1.5)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_UMAP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot UMAP — plot_UMAP","text":"object Metabolite object. color column `@sampleData` show color points. shape column `@sampleData` show shape points. size Point size.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_UMAP.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot UMAP — plot_UMAP","text":"","code":"if (FALSE) { p<- plot_UMAP(df_2017_QC_norm_PCA, color = \"NEG\", shape = \"QCSample\") p }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_injection_order.html","id":null,"dir":"Reference","previous_headings":"","what":"injection order scatterplot — plot_injection_order","title":"injection order scatterplot — plot_injection_order","text":"Injection order scatterplot. `@sampleData` sorted injection order, new column `ID` 1 N.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_injection_order.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"injection order scatterplot — plot_injection_order","text":"","code":"plot_injection_order(   object,   color = \"NEG\",   shape = \"NEG\",   size = 0.6,   ID_order = \"ID_injection_order\",   feature_name = NULL,   random_select = 16 )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_injection_order.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"injection order scatterplot — plot_injection_order","text":"object Metabolite object. color column `@sampleData` show color points. shape column `@sampleData` show shape points. size Point size. ID_order Injection ID order `@sampleData`. feature_name vector selected metabolites plot. NULL, randomly select 16 (default) metabolites plot. random_select integer, number randomly selected metabolites plot.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_injection_order.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"injection order scatterplot — plot_injection_order","text":"","code":"if (FALSE) { p <- plot_injection_order(df_m_PCA, color = \"QC_sample\") p  p <- plot_injection_order(df_m_PCA, color = \"QC_sample\", feature_name = \"X563\") p }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_tsne.html","id":null,"dir":"Reference","previous_headings":"","what":"plot tSNE — plot_tsne","title":"plot tSNE — plot_tsne","text":"Plot t-distributed stochastic neighbor embedding. See details tsne.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_tsne.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"plot tSNE — plot_tsne","text":"","code":"plot_tsne(object, color = \"NEG\", shape = \"NEG\", size = 1.5)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_tsne.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"plot tSNE — plot_tsne","text":"object Metabolite object. color column `@sampleData` show color points. shape column `@sampleData` show shape points. size Point size.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_tsne.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"plot tSNE — plot_tsne","text":"","code":"if (FALSE) { p<- plot_tsne(df_2017_QC_norm_PCA, color = \"NEG\", shape = \"QCSample\") p  }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_volcano.html","id":null,"dir":"Reference","previous_headings":"","what":"volcano plot for regression results — plot_volcano","title":"volcano plot for regression results — plot_volcano","text":"volcano plot regression results","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_volcano.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"volcano plot for regression results — plot_volcano","text":"","code":"plot_volcano(   fit,   x = \"estimate\",   y = \"p.value\",   p.value_log10 = TRUE,   color = \"outcome\",   label = \"term\",   highlight = \"significant\",   x_lab = \"Effect size\",   y_lab = \"-log10(P value)\" )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_volcano.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"volcano plot for regression results — plot_volcano","text":"fit regression summary results. x x-axis column, eg. effect size. y y-axis column, eg. p value. p.value_log10 whether transforme p.value -log10. color column fit show different point colors. Set NULL turn color argument. label column fit label points. highlight column fit show points highlight. Values 1 hightlighted. x_lab labels x-axis. y_lab labels y-axis.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/plot_volcano.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"volcano plot for regression results — plot_volcano","text":"","code":"if (FALSE) { p <- plot_volcano(fit_lm, color = NULL) p }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/regression.html","id":null,"dir":"Reference","previous_headings":"","what":"regression analysis — regression","title":"regression analysis — regression","text":"Run regression models adjusting covariates. `regression_each` used one outcome. `regression`, several outcomes can specified run together.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/regression.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"regression analysis — regression","text":"","code":"regression(   object,   phenoData = NULL,   model = NULL,   outcome = NULL,   covars = NULL,   factors = NULL,   feature_name = NULL,   time = NULL,   verbose = TRUE,   ncpus = 1,   p.adjust.method = \"bonferroni\",   ... )  regression_each(   object,   phenoData = NULL,   model = NULL,   formula = NULL,   outcome = NULL,   covars = NULL,   factors = NULL,   feature_name = NULL,   time = NULL,   verbose = TRUE,   ncpus = 1,   p.adjust.method = \"bonferroni\",   ... )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/regression.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"regression analysis — regression","text":"object Metabolite object. phenoData data.table outcome covariates. `phenoData` NULL, `@sampleData` used. model Specify regression model. See fit_lm details. 'auto' can used infer 'lm' 'logistic' (0, 1, NA). outcome Column name outcome variable. covars Column names covariates. factors Variables treated factor. feature_name vector selected metabolites run. feature_name random_select NULL, run regression features. time Column name survival time, used cox regression, see coxph details. verbose Print log information. ncpus Number CPUS parallele job. p.adjust.method Adjust P value method, see p.adjust. ... arguments passed regression model. formula character formula object fit model (used `regression_each`)","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/regression.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"regression analysis — regression","text":"term estimate std.error statistic p.value n outcome p.value.adj.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/regression.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"regression analysis — regression","text":"","code":"data(df_plasma) fit_lm <- regression(object = df_plasma, phenoData = NULL, model = \"lm\",  outcome = \"BMI\", covars = c(\"AGE\", \"GENDER\", \"ETHNICITY\"), factors = \"ETHNICITY\") #> Regression for 1 outcome(s).  #>  #> Build formula using covars and outcomes.  #>  #> Run `lm` model for 758 features:  #> BMI ~ AGE + GENDER + ETHNICITY + `feature`  #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>   #> Failed to fit model: Error in `contrasts<-`(`*tmp*`, value = contr.funs[1 + isOF[nn]]): contrasts can be applied only to factors with 2 or more levels #>"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/replace_outlier.html","id":null,"dir":"Reference","previous_headings":"","what":"change outlier values as NA or winsorize — replace_outlier","title":"change outlier values as NA or winsorize — replace_outlier","text":"change outlier values NA winsorize","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/replace_outlier.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"change outlier values as NA or winsorize — replace_outlier","text":"","code":"replace_outlier(object, method, nSD)  # S3 method for default replace_outlier(object, method = \"winsorize\", nSD = 5)  # S3 method for data.frame replace_outlier(object, method = \"winsorize\", nSD = 5)  # S3 method for Metabolite replace_outlier(object, method = \"winsorize\", nSD = 5)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/replace_outlier.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"change outlier values as NA or winsorize — replace_outlier","text":"object object, vector, data.frame, data.table Metabolite. method Replace outlier value method, default method `winsorize`: replace outlier values maximum /minimum values remaining values. `as_NA`: set NA (use method using half-min imputation). nSD Define N times SD outliers.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/replace_outlier.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"change outlier values as NA or winsorize — replace_outlier","text":"","code":"if (FALSE) { d <- replace_outlier(object, method = \"winsorize\", nSD = 5) }    if (FALSE) { d <- replace_outlier(object, method = \"winsorize\", nSD = 5) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/row_missing_rate.html","id":null,"dir":"Reference","previous_headings":"","what":"row missing rate — row_missing_rate","title":"row missing rate — row_missing_rate","text":"Calculate row missing rate -- sample missingness.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/row_missing_rate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"row missing rate — row_missing_rate","text":"","code":"row_missing_rate(object)  # S3 method for default row_missing_rate(object)  # S3 method for Metabolite row_missing_rate(object)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/row_missing_rate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"row missing rate — row_missing_rate","text":"object object, data.frame, data.table Metabolite.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/row_missing_rate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"row missing rate — row_missing_rate","text":"Returns vector missing rate row","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/row_missing_rate.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"row missing rate — row_missing_rate","text":"","code":"if (FALSE) {  # for a data.frame or data.table v <- row_missing_rate(object = df)  # to skip the first column (eg. ID) v <- row_missing_rate(object = df[, -1]) }  if (FALSE) {  # for a Metabolite object v <- row_missing_rate(object)  }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/run_PCA.html","id":null,"dir":"Reference","previous_headings":"","what":"Principal Components Analysis — run_PCA","title":"Principal Components Analysis — run_PCA","text":"Performs principal components analysis Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/run_PCA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Principal Components Analysis — run_PCA","text":"","code":"run_PCA(   object,   nPCs = 10,   impute_method = \"half-min\",   log = TRUE,   scale = TRUE,   addPC = TRUE )"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/run_PCA.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Principal Components Analysis — run_PCA","text":"object Metabolite object. nPCs Number principal components calculated. Default value 10. impute_method Imputation method, default method half minimum value (`half-min`) metabolite. Currently support 'half-min', \"median\", \"mean\", \"zero\". `NULL` without imputation. log Performs natural logarithm transformation PCA analysis. scale scale feature PCA calculation. addPC TRUE, merge PCs `@sampleData` return `object`, else return `PC`.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/run_PCA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Principal Components Analysis — run_PCA","text":"","code":"# skip the first column (eg. ID) to impute missing values if (FALSE) { d <- run_PCA(object) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/sampleData.html","id":null,"dir":"Reference","previous_headings":"","what":"get sampleData — sampleData","title":"get sampleData — sampleData","text":"Accessors Metabolite object. Get sampleData Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/sampleData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"get sampleData — sampleData","text":"","code":"sampleData(object)  # S4 method for Metabolite sampleData(object)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/sampleData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"get sampleData — sampleData","text":"object Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/sampleData_set.html","id":null,"dir":"Reference","previous_headings":"","what":"set sampleData — sampleData<-","title":"set sampleData — sampleData<-","text":"Accessors Metabolite object. `sampleData<-` update sampleData Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/sampleData_set.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"set sampleData — sampleData<-","text":"","code":"sampleData(object) <- value  # S4 method for Metabolite sampleData(object) <- value"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/sampleData_set.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"set sampleData — sampleData<-","text":"object Metabolite object. value new sampleData.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/show-Metabolite-method.html","id":null,"dir":"Reference","previous_headings":"","what":"Print a Metabolite class object — show,Metabolite-method","title":"Print a Metabolite class object — show,Metabolite-method","text":"Print Metabolite class object","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/show-Metabolite-method.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print a Metabolite class object — show,Metabolite-method","text":"","code":"# S4 method for Metabolite show(object)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/show-Metabolite-method.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print a Metabolite class object — show,Metabolite-method","text":"object Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/subset.html","id":null,"dir":"Reference","previous_headings":"","what":"subset a Metabolite object. — subset","title":"subset a Metabolite object. — subset","text":"subset Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/subset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"subset a Metabolite object. — subset","text":"","code":"subset(object, subset, select)  # S3 method for Metabolite subset(object, subset, select)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/subset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"subset a Metabolite object. — subset","text":"object object, data.frame, data.table Metabolite. subset logical expression indicating rows keep (samples). Expression evaluate `@sampleData`. select expression indicating columns select (features). See subset. Expression evaluate `@assayData`.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/transformation.html","id":null,"dir":"Reference","previous_headings":"","what":"apply transformation to a Metabolite object — transformation","title":"apply transformation to a Metabolite object — transformation","text":"Apply transformation Metabolite  object","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/transformation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"apply transformation to a Metabolite object — transformation","text":"","code":"transformation(object, method = \"log\")"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/transformation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"apply transformation to a Metabolite object — transformation","text":"object Metabolite object. method Transform method, eg. \"log\", \"pareto_scale\", \"scale\", \"inverse_rank_transform\". User defined method also supported.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/transformation.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"apply transformation to a Metabolite object — transformation","text":"","code":"if (FALSE) { d <- transformation(x) }"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/update_Metabolite.html","id":null,"dir":"Reference","previous_headings":"","what":"Update a Metabolite object — update_Metabolite","title":"Update a Metabolite object — update_Metabolite","text":"Update Metabolite object.","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/update_Metabolite.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update a Metabolite object — update_Metabolite","text":"","code":"update_Metabolite(object, dataset = NULL, action = NULL)"},{"path":"https://XikunHan.github.io/metabolomicsR/reference/update_Metabolite.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update a Metabolite object — update_Metabolite","text":"object Metabolite object dataset vector data.table used specific action mode. action Currently support: \"injection_order\": `@sampleData` updated order sampleID provided  injection order data \"keep_feature\": feature ID list keep \"remove_feature\": feature ID list remove \"keep_sample\": sample ID list keep \"remove_sample\": sample ID list remove \"add_sample_annotation\": merge data `@sampleData` \"change_featureID\": change name featureID (provide new column name `@featureData` dataset)","code":""},{"path":"https://XikunHan.github.io/metabolomicsR/reference/update_Metabolite.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update a Metabolite object — update_Metabolite","text":"","code":"# df_plasma <- update_Metabolite(df_plasma, dataset = \"COMP_IDstr\", action = \"change_featureID\")"}]
